<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create saemix models from mmkin row objects — saemix_model • mkin</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create saemix models from mmkin row objects — saemix_model" />
<meta property="og:description" content="This function sets up a nonlinear mixed effects model for an mmkin row
object for use with the saemix package. An mmkin row object is essentially a
list of mkinfit objects that have been obtained by fitting the same model to
a list of datasets." />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mkin</a>
        <span class="version label label-info" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.9.50.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Functions and data</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mkin.html">Introduction to mkin</a>
    </li>
    <li>
      <a href="../articles/FOCUS_D.html">Example evaluation of FOCUS Example Dataset D</a>
    </li>
    <li>
      <a href="../articles/FOCUS_L.html">Example evaluation of FOCUS Laboratory Data L1 to L3</a>
    </li>
    <li>
      <a href="../articles/web_only/FOCUS_Z.html">Example evaluation of FOCUS Example Dataset Z</a>
    </li>
    <li>
      <a href="../articles/web_only/compiled_models.html">Performance benefit by using compiled model definitions in mkin</a>
    </li>
    <li>
      <a href="../articles/twa.html">Calculation of time weighted average concentrations with mkin</a>
    </li>
    <li>
      <a href="../articles/web_only/NAFTA_examples.html">Example evaluation of NAFTA SOP Attachment examples</a>
    </li>
    <li>
      <a href="../articles/web_only/benchmarks.html">Some benchmark timings</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jranke/mkin/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create saemix models from mmkin row objects</h1>
    <small class="dont-index">Source: <a href='https://github.com/jranke/mkin/blob/master/R/saemix.R'><code>R/saemix.R</code></a></small>
    <div class="hidden name"><code>saemix.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function sets up a nonlinear mixed effects model for an mmkin row
object for use with the saemix package. An mmkin row object is essentially a
list of mkinfit objects that have been obtained by fitting the same model to
a list of datasets.</p>
    </div>

    <pre class="usage"><span class='fu'>saemix_model</span><span class='op'>(</span><span class='va'>object</span>, cores <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='fu'>saemix_data</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>An mmkin row object containing several fits of the same model
to different datasets</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p>The number of cores to be used for multicore processing using
<code><a href='https://rdrr.io/r/parallel/mclapply.html'>parallel::mclapply()</a></code>. Using more than 1 core is experimental and may
lead to uncontrolled forking, apparently depending on the BLAS version
used.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further parameters passed to <a href='https://rdrr.io/pkg/saemix/man/saemixData.html'>saemix::saemixData</a></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An <a href='https://rdrr.io/pkg/saemix/man/SaemixModel-class.html'>saemix::SaemixModel</a> object.</p>
<p>An <a href='https://rdrr.io/pkg/saemix/man/SaemixData-class.html'>saemix::SaemixData</a> object.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Starting values for the fixed effects (population mean parameters, argument psi0 of
<code><a href='https://rdrr.io/pkg/saemix/man/saemixModel.html'>saemix::saemixModel()</a></code> are the mean values of the parameters found using
mmkin. Starting variances of the random effects (argument omega.init) are the
variances of the deviations of the parameters from these mean values.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \dontrun{</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>saemix</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Package saemix, version 3.1.9000</span>
#&gt; <span class='message'>  please direct bugs, questions and feedback to emmanuelle.comets@inserm.fr</span></div><div class='input'><span class='va'>ds</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>experimental_data_for_UBA_2019</span><span class='op'>[</span><span class='fl'>6</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>]</span>,
 <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/pkg/saemix/man/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>data</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"name"</span>, <span class='st'>"time"</span>, <span class='st'>"value"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>ds</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Dataset"</span>, <span class='fl'>6</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span>
<span class='va'>f_mmkin_parent_p0_fixed</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mmkin.html'>mmkin</a></span><span class='op'>(</span><span class='st'>"FOMC"</span>, <span class='va'>ds</span>, cores <span class='op'>=</span> <span class='fl'>1</span>,
  state.ini <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>parent <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>, fixed_initials <span class='op'>=</span> <span class='st'>"parent"</span>, quiet <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>m_saemix_p0_fixed</span> <span class='op'>&lt;-</span> <span class='fu'>saemix_model</span><span class='op'>(</span><span class='va'>f_mmkin_parent_p0_fixed</span><span class='op'>[</span><span class='st'>"FOMC"</span>, <span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 
#&gt; The following SaemixModel object was successfully created:
#&gt; 
#&gt; Nonlinear mixed-effects model
#&gt;   Model function:  Mixed model generated from mmkin object  Model type:  structural
#&gt; function (psi, id, xidep) 
#&gt; {
#&gt;     odeini_fixed/(xidep[, "time"]/exp(psi[id, 2]) + 1)^exp(psi[id, 
#&gt;         1])
#&gt; }
#&gt; &lt;bytecode: 0x5555599945b8&gt;
#&gt; &lt;environment: 0x555559984388&gt;
#&gt;   Nb of parameters: 2 
#&gt;       parameter names:  log_alpha log_beta 
#&gt;       distribution:
#&gt;      Parameter Distribution Estimated
#&gt; [1,] log_alpha normal       Estimated
#&gt; [2,] log_beta  normal       Estimated
#&gt;   Variance-covariance matrix:
#&gt;           log_alpha log_beta
#&gt; log_alpha         1        0
#&gt; log_beta          0        1
#&gt;   Error model: constant , initial values: a.1=2.95893806804889 
#&gt;     No covariate in the model.
#&gt;     Initial values
#&gt;              log_alpha log_beta
#&gt; Pop.CondInit -0.347996  1.66788</div><div class='input'><span class='va'>d_saemix_parent</span> <span class='op'>&lt;-</span> <span class='fu'>saemix_data</span><span class='op'>(</span><span class='va'>f_mmkin_parent_p0_fixed</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 
#&gt; The following SaemixData object was successfully created:
#&gt; 
#&gt; Object of class SaemixData
#&gt;     longitudinal data for use with the SAEM algorithm
#&gt; Dataset ds_saemix 
#&gt;     Structured data: value ~ time + name | ds 
#&gt;     X variable for graphs: time () </div><div class='input'><span class='va'>saemix_options</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>seed <span class='op'>=</span> <span class='fl'>123456</span>, displayProgress <span class='op'>=</span> <span class='cn'>FALSE</span>,
  save <span class='op'>=</span> <span class='cn'>FALSE</span>, save.graphs <span class='op'>=</span> <span class='cn'>FALSE</span>, nbiter.saemix <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>200</span>, <span class='fl'>80</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>f_saemix_p0_fixed</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/saemix/man/saemix.html'>saemix</a></span><span class='op'>(</span><span class='va'>m_saemix_p0_fixed</span>, <span class='va'>d_saemix_parent</span>, <span class='va'>saemix_options</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Running main SAEM algorithm
#&gt; [1] "Thu Nov  5 23:53:29 2020"
#&gt; ..
#&gt;     Minimisation finished
#&gt; [1] "Thu Nov  5 23:53:30 2020"</div><div class='img'><img src='saemix-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; Nonlinear mixed-effects model fit by the SAEM algorithm
#&gt; -----------------------------------
#&gt; ----          Data             ----
#&gt; -----------------------------------
#&gt; Object of class SaemixData
#&gt;     longitudinal data for use with the SAEM algorithm
#&gt; Dataset ds_saemix 
#&gt;     Structured data: value ~ time + name | ds 
#&gt;     X variable for graphs: time () 
#&gt; Dataset characteristics:
#&gt;     number of subjects:     5 
#&gt;     number of observations: 90 
#&gt;     average/min/max nb obs: 18.00  /  16  /  20 
#&gt; First 10 lines of data:
#&gt;           ds time   name value mdv cens occ ytype
#&gt; 1  Dataset 6    0 parent  97.2   0    0   1     1
#&gt; 2  Dataset 6    0 parent  96.4   0    0   1     1
#&gt; 3  Dataset 6    3 parent  71.1   0    0   1     1
#&gt; 4  Dataset 6    3 parent  69.2   0    0   1     1
#&gt; 5  Dataset 6    6 parent  58.1   0    0   1     1
#&gt; 6  Dataset 6    6 parent  56.6   0    0   1     1
#&gt; 7  Dataset 6   10 parent  44.4   0    0   1     1
#&gt; 8  Dataset 6   10 parent  43.4   0    0   1     1
#&gt; 9  Dataset 6   20 parent  33.3   0    0   1     1
#&gt; 10 Dataset 6   20 parent  29.2   0    0   1     1
#&gt; -----------------------------------
#&gt; ----          Model            ----
#&gt; -----------------------------------
#&gt; Nonlinear mixed-effects model
#&gt;   Model function:  Mixed model generated from mmkin object  Model type:  structural
#&gt; function (psi, id, xidep) 
#&gt; {
#&gt;     odeini_fixed/(xidep[, "time"]/exp(psi[id, 2]) + 1)^exp(psi[id, 
#&gt;         1])
#&gt; }
#&gt; &lt;bytecode: 0x5555599945b8&gt;
#&gt; &lt;environment: 0x555559984388&gt;
#&gt;   Nb of parameters: 2 
#&gt;       parameter names:  log_alpha log_beta 
#&gt;       distribution:
#&gt;      Parameter Distribution Estimated
#&gt; [1,] log_alpha normal       Estimated
#&gt; [2,] log_beta  normal       Estimated
#&gt;   Variance-covariance matrix:
#&gt;           log_alpha log_beta
#&gt; log_alpha         1        0
#&gt; log_beta          0        1
#&gt;   Error model: constant , initial values: a.1=2.95893806804889 
#&gt;     No covariate in the model.
#&gt;     Initial values
#&gt;              log_alpha log_beta
#&gt; Pop.CondInit -0.347996  1.66788
#&gt; -----------------------------------
#&gt; ----    Key algorithm options  ----
#&gt; -----------------------------------
#&gt;     Estimation of individual parameters (MAP)
#&gt;     Estimation of standard errors and linearised log-likelihood
#&gt;     Estimation of log-likelihood by importance sampling
#&gt;     Number of iterations:  K1=200, K2=80 
#&gt;     Number of chains:  10 
#&gt;     Seed:  123456 
#&gt;     Number of MCMC iterations for IS:  5000 
#&gt;     Simulations:
#&gt;         nb of simulated datasets used for npde:  1000 
#&gt;         nb of simulated datasets used for VPC:  100 
#&gt;     Input/output
#&gt;         save the results to a file:  FALSE 
#&gt;         save the graphs to files:  FALSE 
#&gt; ----------------------------------------------------
#&gt; ----                  Results                   ----
#&gt; ----------------------------------------------------
#&gt; -----------------  Fixed effects  ------------------
#&gt; ----------------------------------------------------
#&gt;   Parameter Estimate SE   CV(%)
#&gt;   log_alpha -0.33    0.30 91.6 
#&gt;   log_beta   1.70    0.21 12.4 
#&gt; a a.1        3.15    0.25  7.9 
#&gt; ----------------------------------------------------
#&gt; -----------  Variance of random effects  -----------
#&gt; ----------------------------------------------------
#&gt;           Parameter        Estimate SE   CV(%)
#&gt; log_alpha omega2.log_alpha 0.44     0.28 65   
#&gt; log_beta  omega2.log_beta  0.18     0.14 79   
#&gt; ----------------------------------------------------
#&gt; ------  Correlation matrix of random effects  ------
#&gt; ----------------------------------------------------
#&gt;                  omega2.log_alpha omega2.log_beta
#&gt; omega2.log_alpha 1                0              
#&gt; omega2.log_beta  0                1              
#&gt; ----------------------------------------------------
#&gt; ---------------  Statistical criteria  -------------
#&gt; ----------------------------------------------------
#&gt; Likelihood computed by linearisation
#&gt;       -2LL= 501.6082 
#&gt;       AIC = 511.6082 
#&gt;       BIC = 509.6554 
#&gt; 
#&gt; Likelihood computed by importance sampling
#&gt;       -2LL= 501.7 
#&gt;       AIC = 511.7 
#&gt;       BIC = 509.7472 
#&gt; ----------------------------------------------------</div><div class='input'>
<span class='va'>f_mmkin_parent</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mmkin.html'>mmkin</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"SFO"</span>, <span class='st'>"FOMC"</span>, <span class='st'>"DFOP"</span><span class='op'>)</span>, <span class='va'>ds</span>, quiet <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>m_saemix_sfo</span> <span class='op'>&lt;-</span> <span class='fu'>saemix_model</span><span class='op'>(</span><span class='va'>f_mmkin_parent</span><span class='op'>[</span><span class='st'>"SFO"</span>, <span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 
#&gt; The following SaemixModel object was successfully created:
#&gt; 
#&gt; Nonlinear mixed-effects model
#&gt;   Model function:  Mixed model generated from mmkin object  Model type:  structural
#&gt; function (psi, id, xidep) 
#&gt; {
#&gt;     psi[id, 1] * exp(-exp(psi[id, 2]) * xidep[, "time"])
#&gt; }
#&gt; &lt;bytecode: 0x55555998d588&gt;
#&gt; &lt;environment: 0x55555c0f4ae8&gt;
#&gt;   Nb of parameters: 2 
#&gt;       parameter names:  parent_0 log_k_parent 
#&gt;       distribution:
#&gt;      Parameter    Distribution Estimated
#&gt; [1,] parent_0     normal       Estimated
#&gt; [2,] log_k_parent normal       Estimated
#&gt;   Variance-covariance matrix:
#&gt;              parent_0 log_k_parent
#&gt; parent_0            1            0
#&gt; log_k_parent        0            1
#&gt;   Error model: constant , initial values: a.1=5.76827561471585 
#&gt;     No covariate in the model.
#&gt;     Initial values
#&gt;              parent_0 log_k_parent
#&gt; Pop.CondInit 86.39406    -3.215063</div><div class='input'><span class='va'>m_saemix_fomc</span> <span class='op'>&lt;-</span> <span class='fu'>saemix_model</span><span class='op'>(</span><span class='va'>f_mmkin_parent</span><span class='op'>[</span><span class='st'>"FOMC"</span>, <span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 
#&gt; The following SaemixModel object was successfully created:
#&gt; 
#&gt; Nonlinear mixed-effects model
#&gt;   Model function:  Mixed model generated from mmkin object  Model type:  structural
#&gt; function (psi, id, xidep) 
#&gt; {
#&gt;     psi[id, 1]/(xidep[, "time"]/exp(psi[id, 3]) + 1)^exp(psi[id, 
#&gt;         2])
#&gt; }
#&gt; &lt;bytecode: 0x55555998dc50&gt;
#&gt; &lt;environment: 0x5555595d7668&gt;
#&gt;   Nb of parameters: 3 
#&gt;       parameter names:  parent_0 log_alpha log_beta 
#&gt;       distribution:
#&gt;      Parameter Distribution Estimated
#&gt; [1,] parent_0  normal       Estimated
#&gt; [2,] log_alpha normal       Estimated
#&gt; [3,] log_beta  normal       Estimated
#&gt;   Variance-covariance matrix:
#&gt;           parent_0 log_alpha log_beta
#&gt; parent_0         1         0        0
#&gt; log_alpha        0         1        0
#&gt; log_beta         0         0        1
#&gt;   Error model: constant , initial values: a.1=1.91976382242696 
#&gt;     No covariate in the model.
#&gt;     Initial values
#&gt;              parent_0  log_alpha log_beta
#&gt; Pop.CondInit 94.43884 -0.2226095 2.048192</div><div class='input'><span class='va'>m_saemix_dfop</span> <span class='op'>&lt;-</span> <span class='fu'>saemix_model</span><span class='op'>(</span><span class='va'>f_mmkin_parent</span><span class='op'>[</span><span class='st'>"DFOP"</span>, <span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 
#&gt; The following SaemixModel object was successfully created:
#&gt; 
#&gt; Nonlinear mixed-effects model
#&gt;   Model function:  Mixed model generated from mmkin object  Model type:  structural
#&gt; function (psi, id, xidep) 
#&gt; {
#&gt;     g &lt;- plogis(psi[id, 4])
#&gt;     t = xidep[, "time"]
#&gt;     psi[id, 1] * (g * exp(-exp(psi[id, 2]) * t) + (1 - g) * exp(-exp(psi[id, 
#&gt;         3]) * t))
#&gt; }
#&gt; &lt;bytecode: 0x55555998e548&gt;
#&gt; &lt;environment: 0x555558225bf0&gt;
#&gt;   Nb of parameters: 4 
#&gt;       parameter names:  parent_0 log_k1 log_k2 g_qlogis 
#&gt;       distribution:
#&gt;      Parameter Distribution Estimated
#&gt; [1,] parent_0  normal       Estimated
#&gt; [2,] log_k1    normal       Estimated
#&gt; [3,] log_k2    normal       Estimated
#&gt; [4,] g_qlogis  normal       Estimated
#&gt;   Variance-covariance matrix:
#&gt;          parent_0 log_k1 log_k2 g_qlogis
#&gt; parent_0        1      0      0        0
#&gt; log_k1          0      1      0        0
#&gt; log_k2          0      0      1        0
#&gt; g_qlogis        0      0      0        1
#&gt;   Error model: constant , initial values: a.1=1.94671278396371 
#&gt;     No covariate in the model.
#&gt;     Initial values
#&gt;              parent_0    log_k1    log_k2 g_qlogis
#&gt; Pop.CondInit 94.08322 -1.834163 -4.210797  0.11002</div><div class='input'><span class='va'>d_saemix_parent</span> <span class='op'>&lt;-</span> <span class='fu'>saemix_data</span><span class='op'>(</span><span class='va'>f_mmkin_parent</span><span class='op'>[</span><span class='st'>"SFO"</span>, <span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 
#&gt; The following SaemixData object was successfully created:
#&gt; 
#&gt; Object of class SaemixData
#&gt;     longitudinal data for use with the SAEM algorithm
#&gt; Dataset ds_saemix 
#&gt;     Structured data: value ~ time + name | ds 
#&gt;     X variable for graphs: time () </div><div class='input'><span class='va'>f_saemix_sfo</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/saemix/man/saemix.html'>saemix</a></span><span class='op'>(</span><span class='va'>m_saemix_sfo</span>, <span class='va'>d_saemix_parent</span>, <span class='va'>saemix_options</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Running main SAEM algorithm
#&gt; [1] "Thu Nov  5 23:53:31 2020"
#&gt; ..
#&gt;     Minimisation finished
#&gt; [1] "Thu Nov  5 23:53:32 2020"</div><div class='img'><img src='saemix-2.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; Nonlinear mixed-effects model fit by the SAEM algorithm
#&gt; -----------------------------------
#&gt; ----          Data             ----
#&gt; -----------------------------------
#&gt; Object of class SaemixData
#&gt;     longitudinal data for use with the SAEM algorithm
#&gt; Dataset ds_saemix 
#&gt;     Structured data: value ~ time + name | ds 
#&gt;     X variable for graphs: time () 
#&gt; Dataset characteristics:
#&gt;     number of subjects:     5 
#&gt;     number of observations: 90 
#&gt;     average/min/max nb obs: 18.00  /  16  /  20 
#&gt; First 10 lines of data:
#&gt;           ds time   name value mdv cens occ ytype
#&gt; 1  Dataset 6    0 parent  97.2   0    0   1     1
#&gt; 2  Dataset 6    0 parent  96.4   0    0   1     1
#&gt; 3  Dataset 6    3 parent  71.1   0    0   1     1
#&gt; 4  Dataset 6    3 parent  69.2   0    0   1     1
#&gt; 5  Dataset 6    6 parent  58.1   0    0   1     1
#&gt; 6  Dataset 6    6 parent  56.6   0    0   1     1
#&gt; 7  Dataset 6   10 parent  44.4   0    0   1     1
#&gt; 8  Dataset 6   10 parent  43.4   0    0   1     1
#&gt; 9  Dataset 6   20 parent  33.3   0    0   1     1
#&gt; 10 Dataset 6   20 parent  29.2   0    0   1     1
#&gt; -----------------------------------
#&gt; ----          Model            ----
#&gt; -----------------------------------
#&gt; Nonlinear mixed-effects model
#&gt;   Model function:  Mixed model generated from mmkin object  Model type:  structural
#&gt; function (psi, id, xidep) 
#&gt; {
#&gt;     psi[id, 1] * exp(-exp(psi[id, 2]) * xidep[, "time"])
#&gt; }
#&gt; &lt;bytecode: 0x55555998d588&gt;
#&gt; &lt;environment: 0x55555c0f4ae8&gt;
#&gt;   Nb of parameters: 2 
#&gt;       parameter names:  parent_0 log_k_parent 
#&gt;       distribution:
#&gt;      Parameter    Distribution Estimated
#&gt; [1,] parent_0     normal       Estimated
#&gt; [2,] log_k_parent normal       Estimated
#&gt;   Variance-covariance matrix:
#&gt;              parent_0 log_k_parent
#&gt; parent_0            1            0
#&gt; log_k_parent        0            1
#&gt;   Error model: constant , initial values: a.1=5.76827561471585 
#&gt;     No covariate in the model.
#&gt;     Initial values
#&gt;              parent_0 log_k_parent
#&gt; Pop.CondInit 86.39406    -3.215063
#&gt; -----------------------------------
#&gt; ----    Key algorithm options  ----
#&gt; -----------------------------------
#&gt;     Estimation of individual parameters (MAP)
#&gt;     Estimation of standard errors and linearised log-likelihood
#&gt;     Estimation of log-likelihood by importance sampling
#&gt;     Number of iterations:  K1=200, K2=80 
#&gt;     Number of chains:  10 
#&gt;     Seed:  123456 
#&gt;     Number of MCMC iterations for IS:  5000 
#&gt;     Simulations:
#&gt;         nb of simulated datasets used for npde:  1000 
#&gt;         nb of simulated datasets used for VPC:  100 
#&gt;     Input/output
#&gt;         save the results to a file:  FALSE 
#&gt;         save the graphs to files:  FALSE 
#&gt; ----------------------------------------------------
#&gt; ----                  Results                   ----
#&gt; ----------------------------------------------------
#&gt; -----------------  Fixed effects  ------------------
#&gt; ----------------------------------------------------
#&gt;   Parameter    Estimate SE   CV(%)
#&gt;   parent_0     85.8     1.85  2.2 
#&gt;   log_k_parent -3.2     0.59 18.3 
#&gt; a a.1           6.2     0.49  7.9 
#&gt; ----------------------------------------------------
#&gt; -----------  Variance of random effects  -----------
#&gt; ----------------------------------------------------
#&gt;              Parameter           Estimate SE   CV(%)
#&gt; parent_0     omega2.parent_0     7.8      10.7 138  
#&gt; log_k_parent omega2.log_k_parent 1.7       1.1  64  
#&gt; ----------------------------------------------------
#&gt; ------  Correlation matrix of random effects  ------
#&gt; ----------------------------------------------------
#&gt;                     omega2.parent_0 omega2.log_k_parent
#&gt; omega2.parent_0     1               0                  
#&gt; omega2.log_k_parent 0               1                  
#&gt; ----------------------------------------------------
#&gt; ---------------  Statistical criteria  -------------
#&gt; ----------------------------------------------------
#&gt; Likelihood computed by linearisation
#&gt;       -2LL= 615.4074 
#&gt;       AIC = 625.4074 
#&gt;       BIC = 623.4546 
#&gt; 
#&gt; Likelihood computed by importance sampling
#&gt;       -2LL= 614.4911 
#&gt;       AIC = 624.4911 
#&gt;       BIC = 622.5382 
#&gt; ----------------------------------------------------</div><div class='input'><span class='va'>f_saemix_fomc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/saemix/man/saemix.html'>saemix</a></span><span class='op'>(</span><span class='va'>m_saemix_fomc</span>, <span class='va'>d_saemix_parent</span>, <span class='va'>saemix_options</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Running main SAEM algorithm
#&gt; [1] "Thu Nov  5 23:53:33 2020"
#&gt; ..
#&gt;     Minimisation finished
#&gt; [1] "Thu Nov  5 23:53:34 2020"</div><div class='img'><img src='saemix-3.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; Nonlinear mixed-effects model fit by the SAEM algorithm
#&gt; -----------------------------------
#&gt; ----          Data             ----
#&gt; -----------------------------------
#&gt; Object of class SaemixData
#&gt;     longitudinal data for use with the SAEM algorithm
#&gt; Dataset ds_saemix 
#&gt;     Structured data: value ~ time + name | ds 
#&gt;     X variable for graphs: time () 
#&gt; Dataset characteristics:
#&gt;     number of subjects:     5 
#&gt;     number of observations: 90 
#&gt;     average/min/max nb obs: 18.00  /  16  /  20 
#&gt; First 10 lines of data:
#&gt;           ds time   name value mdv cens occ ytype
#&gt; 1  Dataset 6    0 parent  97.2   0    0   1     1
#&gt; 2  Dataset 6    0 parent  96.4   0    0   1     1
#&gt; 3  Dataset 6    3 parent  71.1   0    0   1     1
#&gt; 4  Dataset 6    3 parent  69.2   0    0   1     1
#&gt; 5  Dataset 6    6 parent  58.1   0    0   1     1
#&gt; 6  Dataset 6    6 parent  56.6   0    0   1     1
#&gt; 7  Dataset 6   10 parent  44.4   0    0   1     1
#&gt; 8  Dataset 6   10 parent  43.4   0    0   1     1
#&gt; 9  Dataset 6   20 parent  33.3   0    0   1     1
#&gt; 10 Dataset 6   20 parent  29.2   0    0   1     1
#&gt; -----------------------------------
#&gt; ----          Model            ----
#&gt; -----------------------------------
#&gt; Nonlinear mixed-effects model
#&gt;   Model function:  Mixed model generated from mmkin object  Model type:  structural
#&gt; function (psi, id, xidep) 
#&gt; {
#&gt;     psi[id, 1]/(xidep[, "time"]/exp(psi[id, 3]) + 1)^exp(psi[id, 
#&gt;         2])
#&gt; }
#&gt; &lt;bytecode: 0x55555998dc50&gt;
#&gt; &lt;environment: 0x5555595d7668&gt;
#&gt;   Nb of parameters: 3 
#&gt;       parameter names:  parent_0 log_alpha log_beta 
#&gt;       distribution:
#&gt;      Parameter Distribution Estimated
#&gt; [1,] parent_0  normal       Estimated
#&gt; [2,] log_alpha normal       Estimated
#&gt; [3,] log_beta  normal       Estimated
#&gt;   Variance-covariance matrix:
#&gt;           parent_0 log_alpha log_beta
#&gt; parent_0         1         0        0
#&gt; log_alpha        0         1        0
#&gt; log_beta         0         0        1
#&gt;   Error model: constant , initial values: a.1=1.91976382242696 
#&gt;     No covariate in the model.
#&gt;     Initial values
#&gt;              parent_0  log_alpha log_beta
#&gt; Pop.CondInit 94.43884 -0.2226095 2.048192
#&gt; -----------------------------------
#&gt; ----    Key algorithm options  ----
#&gt; -----------------------------------
#&gt;     Estimation of individual parameters (MAP)
#&gt;     Estimation of standard errors and linearised log-likelihood
#&gt;     Estimation of log-likelihood by importance sampling
#&gt;     Number of iterations:  K1=200, K2=80 
#&gt;     Number of chains:  10 
#&gt;     Seed:  123456 
#&gt;     Number of MCMC iterations for IS:  5000 
#&gt;     Simulations:
#&gt;         nb of simulated datasets used for npde:  1000 
#&gt;         nb of simulated datasets used for VPC:  100 
#&gt;     Input/output
#&gt;         save the results to a file:  FALSE 
#&gt;         save the graphs to files:  FALSE 
#&gt; ----------------------------------------------------
#&gt; ----                  Results                   ----
#&gt; ----------------------------------------------------
#&gt; -----------------  Fixed effects  ------------------
#&gt; ----------------------------------------------------
#&gt;   Parameter Estimate SE   CV(%)
#&gt;   parent_0  94.49    1.18   1.2
#&gt;   log_alpha -0.21    0.30 142.0
#&gt;   log_beta   2.06    0.21  10.4
#&gt; a a.1        2.28    0.19   8.2
#&gt; ----------------------------------------------------
#&gt; -----------  Variance of random effects  -----------
#&gt; ----------------------------------------------------
#&gt;           Parameter        Estimate SE   CV(%)
#&gt; parent_0  omega2.parent_0  4.66     4.34 93   
#&gt; log_alpha omega2.log_alpha 0.45     0.29 65   
#&gt; log_beta  omega2.log_beta  0.19     0.14 75   
#&gt; ----------------------------------------------------
#&gt; ------  Correlation matrix of random effects  ------
#&gt; ----------------------------------------------------
#&gt;                  omega2.parent_0 omega2.log_alpha omega2.log_beta
#&gt; omega2.parent_0  1               0                0              
#&gt; omega2.log_alpha 0               1                0              
#&gt; omega2.log_beta  0               0                1              
#&gt; ----------------------------------------------------
#&gt; ---------------  Statistical criteria  -------------
#&gt; ----------------------------------------------------
#&gt; Likelihood computed by linearisation
#&gt;       -2LL= 454.0598 
#&gt;       AIC = 468.0598 
#&gt;       BIC = 465.3259 
#&gt; 
#&gt; Likelihood computed by importance sampling
#&gt;       -2LL= 453.7499 
#&gt;       AIC = 467.7499 
#&gt;       BIC = 465.016 
#&gt; ----------------------------------------------------</div><div class='input'><span class='va'>f_saemix_dfop</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/saemix/man/saemix.html'>saemix</a></span><span class='op'>(</span><span class='va'>m_saemix_dfop</span>, <span class='va'>d_saemix_parent</span>, <span class='va'>saemix_options</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Running main SAEM algorithm
#&gt; [1] "Thu Nov  5 23:53:35 2020"
#&gt; ..
#&gt;     Minimisation finished
#&gt; [1] "Thu Nov  5 23:53:37 2020"</div><div class='img'><img src='saemix-4.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; Nonlinear mixed-effects model fit by the SAEM algorithm
#&gt; -----------------------------------
#&gt; ----          Data             ----
#&gt; -----------------------------------
#&gt; Object of class SaemixData
#&gt;     longitudinal data for use with the SAEM algorithm
#&gt; Dataset ds_saemix 
#&gt;     Structured data: value ~ time + name | ds 
#&gt;     X variable for graphs: time () 
#&gt; Dataset characteristics:
#&gt;     number of subjects:     5 
#&gt;     number of observations: 90 
#&gt;     average/min/max nb obs: 18.00  /  16  /  20 
#&gt; First 10 lines of data:
#&gt;           ds time   name value mdv cens occ ytype
#&gt; 1  Dataset 6    0 parent  97.2   0    0   1     1
#&gt; 2  Dataset 6    0 parent  96.4   0    0   1     1
#&gt; 3  Dataset 6    3 parent  71.1   0    0   1     1
#&gt; 4  Dataset 6    3 parent  69.2   0    0   1     1
#&gt; 5  Dataset 6    6 parent  58.1   0    0   1     1
#&gt; 6  Dataset 6    6 parent  56.6   0    0   1     1
#&gt; 7  Dataset 6   10 parent  44.4   0    0   1     1
#&gt; 8  Dataset 6   10 parent  43.4   0    0   1     1
#&gt; 9  Dataset 6   20 parent  33.3   0    0   1     1
#&gt; 10 Dataset 6   20 parent  29.2   0    0   1     1
#&gt; -----------------------------------
#&gt; ----          Model            ----
#&gt; -----------------------------------
#&gt; Nonlinear mixed-effects model
#&gt;   Model function:  Mixed model generated from mmkin object  Model type:  structural
#&gt; function (psi, id, xidep) 
#&gt; {
#&gt;     g &lt;- plogis(psi[id, 4])
#&gt;     t = xidep[, "time"]
#&gt;     psi[id, 1] * (g * exp(-exp(psi[id, 2]) * t) + (1 - g) * exp(-exp(psi[id, 
#&gt;         3]) * t))
#&gt; }
#&gt; &lt;bytecode: 0x55555998e548&gt;
#&gt; &lt;environment: 0x555558225bf0&gt;
#&gt;   Nb of parameters: 4 
#&gt;       parameter names:  parent_0 log_k1 log_k2 g_qlogis 
#&gt;       distribution:
#&gt;      Parameter Distribution Estimated
#&gt; [1,] parent_0  normal       Estimated
#&gt; [2,] log_k1    normal       Estimated
#&gt; [3,] log_k2    normal       Estimated
#&gt; [4,] g_qlogis  normal       Estimated
#&gt;   Variance-covariance matrix:
#&gt;          parent_0 log_k1 log_k2 g_qlogis
#&gt; parent_0        1      0      0        0
#&gt; log_k1          0      1      0        0
#&gt; log_k2          0      0      1        0
#&gt; g_qlogis        0      0      0        1
#&gt;   Error model: constant , initial values: a.1=1.94671278396371 
#&gt;     No covariate in the model.
#&gt;     Initial values
#&gt;              parent_0    log_k1    log_k2 g_qlogis
#&gt; Pop.CondInit 94.08322 -1.834163 -4.210797  0.11002
#&gt; -----------------------------------
#&gt; ----    Key algorithm options  ----
#&gt; -----------------------------------
#&gt;     Estimation of individual parameters (MAP)
#&gt;     Estimation of standard errors and linearised log-likelihood
#&gt;     Estimation of log-likelihood by importance sampling
#&gt;     Number of iterations:  K1=200, K2=80 
#&gt;     Number of chains:  10 
#&gt;     Seed:  123456 
#&gt;     Number of MCMC iterations for IS:  5000 
#&gt;     Simulations:
#&gt;         nb of simulated datasets used for npde:  1000 
#&gt;         nb of simulated datasets used for VPC:  100 
#&gt;     Input/output
#&gt;         save the results to a file:  FALSE 
#&gt;         save the graphs to files:  FALSE 
#&gt; ----------------------------------------------------
#&gt; ----                  Results                   ----
#&gt; ----------------------------------------------------
#&gt; -----------------  Fixed effects  ------------------
#&gt; ----------------------------------------------------
#&gt;   Parameter Estimate SE   CV(%)
#&gt;   parent_0  93.97    1.35   1.4
#&gt;   log_k1    -2.37    0.58  24.5
#&gt;   log_k2    -3.63    0.87  24.0
#&gt;   g_qlogis  -0.14    0.34 246.1
#&gt; a a.1        2.32    0.19   8.3
#&gt; ----------------------------------------------------
#&gt; -----------  Variance of random effects  -----------
#&gt; ----------------------------------------------------
#&gt;          Parameter       Estimate SE   CV(%)
#&gt; parent_0 omega2.parent_0 6.97     5.72  82  
#&gt; log_k1   omega2.log_k1   1.63     1.06  65  
#&gt; log_k2   omega2.log_k2   3.73     2.39  64  
#&gt; g_qlogis omega2.g_qlogis 0.16     0.27 173  
#&gt; ----------------------------------------------------
#&gt; ------  Correlation matrix of random effects  ------
#&gt; ----------------------------------------------------
#&gt;                 omega2.parent_0 omega2.log_k1 omega2.log_k2 omega2.g_qlogis
#&gt; omega2.parent_0 1               0             0             0              
#&gt; omega2.log_k1   0               1             0             0              
#&gt; omega2.log_k2   0               0             1             0              
#&gt; omega2.g_qlogis 0               0             0             1              
#&gt; ----------------------------------------------------
#&gt; ---------------  Statistical criteria  -------------
#&gt; ----------------------------------------------------
#&gt; Likelihood computed by linearisation
#&gt;       -2LL= 485.4627 
#&gt;       AIC = 503.4627 
#&gt;       BIC = 499.9477 
#&gt; 
#&gt; Likelihood computed by importance sampling
#&gt;       -2LL= 473.563 
#&gt;       AIC = 491.563 
#&gt;       BIC = 488.048 
#&gt; ----------------------------------------------------</div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/saemix/man/compare.saemix.html'>compare.saemix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>f_saemix_sfo</span>, <span class='va'>f_saemix_fomc</span>, <span class='va'>f_saemix_dfop</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Likelihoods computed by importance sampling </div><div class='output co'>#&gt;        AIC      BIC
#&gt; 1 624.4911 622.5382
#&gt; 2 467.7499 465.0160
#&gt; 3 491.5630 488.0480</div><div class='input'><span class='va'>f_mmkin_parent_tc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/update.html'>update</a></span><span class='op'>(</span><span class='va'>f_mmkin_parent</span>, error_model <span class='op'>=</span> <span class='st'>"tc"</span><span class='op'>)</span>
<span class='va'>m_saemix_fomc_tc</span> <span class='op'>&lt;-</span> <span class='fu'>saemix_model</span><span class='op'>(</span><span class='va'>f_mmkin_parent_tc</span><span class='op'>[</span><span class='st'>"FOMC"</span>, <span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 
#&gt; The following SaemixModel object was successfully created:
#&gt; 
#&gt; Nonlinear mixed-effects model
#&gt;   Model function:  Mixed model generated from mmkin object  Model type:  structural
#&gt; function (psi, id, xidep) 
#&gt; {
#&gt;     psi[id, 1]/(xidep[, "time"]/exp(psi[id, 3]) + 1)^exp(psi[id, 
#&gt;         2])
#&gt; }
#&gt; &lt;bytecode: 0x55555998dc50&gt;
#&gt; &lt;environment: 0x555559a957f8&gt;
#&gt;   Nb of parameters: 3 
#&gt;       parameter names:  parent_0 log_alpha log_beta 
#&gt;       distribution:
#&gt;      Parameter Distribution Estimated
#&gt; [1,] parent_0  normal       Estimated
#&gt; [2,] log_alpha normal       Estimated
#&gt; [3,] log_beta  normal       Estimated
#&gt;   Variance-covariance matrix:
#&gt;           parent_0 log_alpha log_beta
#&gt; parent_0         1         0        0
#&gt; log_alpha        0         1        0
#&gt; log_beta         0         0        1
#&gt;   Error model: combined , initial values: a.1=1.10728182011691 b.1=0.024889924291374 
#&gt;     No covariate in the model.
#&gt;     Initial values
#&gt;              parent_0  log_alpha log_beta
#&gt; Pop.CondInit 93.13042 -0.1215336 2.230815</div><div class='input'><span class='va'>f_saemix_fomc_tc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/saemix/man/saemix.html'>saemix</a></span><span class='op'>(</span><span class='va'>m_saemix_fomc_tc</span>, <span class='va'>d_saemix_parent</span>, <span class='va'>saemix_options</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Running main SAEM algorithm
#&gt; [1] "Thu Nov  5 23:53:38 2020"
#&gt; ..
#&gt;     Minimisation finished
#&gt; [1] "Thu Nov  5 23:53:42 2020"</div><div class='img'><img src='saemix-5.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; Nonlinear mixed-effects model fit by the SAEM algorithm
#&gt; -----------------------------------
#&gt; ----          Data             ----
#&gt; -----------------------------------
#&gt; Object of class SaemixData
#&gt;     longitudinal data for use with the SAEM algorithm
#&gt; Dataset ds_saemix 
#&gt;     Structured data: value ~ time + name | ds 
#&gt;     X variable for graphs: time () 
#&gt; Dataset characteristics:
#&gt;     number of subjects:     5 
#&gt;     number of observations: 90 
#&gt;     average/min/max nb obs: 18.00  /  16  /  20 
#&gt; First 10 lines of data:
#&gt;           ds time   name value mdv cens occ ytype
#&gt; 1  Dataset 6    0 parent  97.2   0    0   1     1
#&gt; 2  Dataset 6    0 parent  96.4   0    0   1     1
#&gt; 3  Dataset 6    3 parent  71.1   0    0   1     1
#&gt; 4  Dataset 6    3 parent  69.2   0    0   1     1
#&gt; 5  Dataset 6    6 parent  58.1   0    0   1     1
#&gt; 6  Dataset 6    6 parent  56.6   0    0   1     1
#&gt; 7  Dataset 6   10 parent  44.4   0    0   1     1
#&gt; 8  Dataset 6   10 parent  43.4   0    0   1     1
#&gt; 9  Dataset 6   20 parent  33.3   0    0   1     1
#&gt; 10 Dataset 6   20 parent  29.2   0    0   1     1
#&gt; -----------------------------------
#&gt; ----          Model            ----
#&gt; -----------------------------------
#&gt; Nonlinear mixed-effects model
#&gt;   Model function:  Mixed model generated from mmkin object  Model type:  structural
#&gt; function (psi, id, xidep) 
#&gt; {
#&gt;     psi[id, 1]/(xidep[, "time"]/exp(psi[id, 3]) + 1)^exp(psi[id, 
#&gt;         2])
#&gt; }
#&gt; &lt;bytecode: 0x55555998dc50&gt;
#&gt; &lt;environment: 0x555559a957f8&gt;
#&gt;   Nb of parameters: 3 
#&gt;       parameter names:  parent_0 log_alpha log_beta 
#&gt;       distribution:
#&gt;      Parameter Distribution Estimated
#&gt; [1,] parent_0  normal       Estimated
#&gt; [2,] log_alpha normal       Estimated
#&gt; [3,] log_beta  normal       Estimated
#&gt;   Variance-covariance matrix:
#&gt;           parent_0 log_alpha log_beta
#&gt; parent_0         1         0        0
#&gt; log_alpha        0         1        0
#&gt; log_beta         0         0        1
#&gt;   Error model: combined , initial values: a.1=1.10728182011691 b.1=0.024889924291374 
#&gt;     No covariate in the model.
#&gt;     Initial values
#&gt;              parent_0  log_alpha log_beta
#&gt; Pop.CondInit 93.13042 -0.1215336 2.230815
#&gt; -----------------------------------
#&gt; ----    Key algorithm options  ----
#&gt; -----------------------------------
#&gt;     Estimation of individual parameters (MAP)
#&gt;     Estimation of standard errors and linearised log-likelihood
#&gt;     Estimation of log-likelihood by importance sampling
#&gt;     Number of iterations:  K1=200, K2=80 
#&gt;     Number of chains:  10 
#&gt;     Seed:  123456 
#&gt;     Number of MCMC iterations for IS:  5000 
#&gt;     Simulations:
#&gt;         nb of simulated datasets used for npde:  1000 
#&gt;         nb of simulated datasets used for VPC:  100 
#&gt;     Input/output
#&gt;         save the results to a file:  FALSE 
#&gt;         save the graphs to files:  FALSE 
#&gt; ----------------------------------------------------
#&gt; ----                  Results                   ----
#&gt; ----------------------------------------------------
#&gt; -----------------  Fixed effects  ------------------
#&gt; ----------------------------------------------------
#&gt;   Parameter Estimate SE     CV(%)
#&gt;   parent_0  94.4481  1.2052   1.3
#&gt;   log_alpha -0.2088  0.3059 146.5
#&gt;   log_beta   2.0668  0.2182  10.6
#&gt; a a.1        2.4273  0.3178  13.1
#&gt; b b.1       -0.0037  0.0062 168.3
#&gt; ----------------------------------------------------
#&gt; -----------  Variance of random effects  -----------
#&gt; ----------------------------------------------------
#&gt;           Parameter        Estimate SE   CV(%)
#&gt; parent_0  omega2.parent_0  5.34     4.58 86   
#&gt; log_alpha omega2.log_alpha 0.46     0.29 65   
#&gt; log_beta  omega2.log_beta  0.20     0.15 74   
#&gt; ----------------------------------------------------
#&gt; ------  Correlation matrix of random effects  ------
#&gt; ----------------------------------------------------
#&gt;                  omega2.parent_0 omega2.log_alpha omega2.log_beta
#&gt; omega2.parent_0  1               0                0              
#&gt; omega2.log_alpha 0               1                0              
#&gt; omega2.log_beta  0               0                1              
#&gt; ----------------------------------------------------
#&gt; ---------------  Statistical criteria  -------------
#&gt; ----------------------------------------------------
#&gt; Likelihood computed by linearisation
#&gt;       -2LL= 453.7703 
#&gt;       AIC = 469.7703 
#&gt;       BIC = 466.6458 
#&gt; 
#&gt; Likelihood computed by importance sampling
#&gt;       -2LL= 453.6186 
#&gt;       AIC = 469.6186 
#&gt;       BIC = 466.4942 
#&gt; ----------------------------------------------------</div><div class='input'><span class='fu'><a href='https://rdrr.io/pkg/saemix/man/compare.saemix.html'>compare.saemix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>f_saemix_fomc</span>, <span class='va'>f_saemix_fomc_tc</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Likelihoods computed by importance sampling </div><div class='output co'>#&gt;        AIC      BIC
#&gt; 1 467.7499 465.0160
#&gt; 2 469.6186 466.4942</div><div class='input'>
<span class='va'>dfop_sfo</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mkinmod.html'>mkinmod</a></span><span class='op'>(</span>parent <span class='op'>=</span> <span class='fu'><a href='mkinsub.html'>mkinsub</a></span><span class='op'>(</span><span class='st'>"DFOP"</span>, <span class='st'>"A1"</span><span class='op'>)</span>,
  A1 <span class='op'>=</span> <span class='fu'><a href='mkinsub.html'>mkinsub</a></span><span class='op'>(</span><span class='st'>"SFO"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Successfully compiled differential equation model from auto-generated C code.</span></div><div class='input'><span class='va'>f_mmkin</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mmkin.html'>mmkin</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>"DFOP-SFO"</span> <span class='op'>=</span> <span class='va'>dfop_sfo</span><span class='op'>)</span>, <span class='va'>ds</span>, quiet <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>m_saemix</span> <span class='op'>&lt;-</span> <span class='fu'>saemix_model</span><span class='op'>(</span><span class='va'>f_mmkin</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 
#&gt; The following SaemixModel object was successfully created:
#&gt; 
#&gt; Nonlinear mixed-effects model
#&gt;   Model function:  Mixed model generated from mmkin object  Model type:  structural
#&gt; function (psi, id, xidep) 
#&gt; {
#&gt;     uid &lt;- unique(id)
#&gt;     res_list &lt;- parallel::mclapply(uid, function(i) {
#&gt;         transparms_optim &lt;- psi[i, ]
#&gt;         names(transparms_optim) &lt;- names(degparms_optim)
#&gt;         odeini_optim &lt;- transparms_optim[odeini_optim_parm_names]
#&gt;         names(odeini_optim) &lt;- gsub("_0$", "", odeini_optim_parm_names)
#&gt;         odeini &lt;- c(odeini_optim, odeini_fixed)[names(mkin_model$diffs)]
#&gt;         ode_transparms_optim_names &lt;- setdiff(names(transparms_optim), 
#&gt;             odeini_optim_parm_names)
#&gt;         odeparms_optim &lt;- backtransform_odeparms(transparms_optim[ode_transparms_optim_names], 
#&gt;             mkin_model, transform_rates = object[[1]]$transform_rates, 
#&gt;             transform_fractions = object[[1]]$transform_fractions)
#&gt;         odeparms &lt;- c(odeparms_optim, odeparms_fixed)
#&gt;         xidep_i &lt;- subset(xidep, id == i)
#&gt;         if (solution_type == "analytical") {
#&gt;             out_values &lt;- mkin_model$deg_func(xidep_i, odeini, 
#&gt;                 odeparms)
#&gt;         }
#&gt;         else {
#&gt;             i_time &lt;- xidep_i$time
#&gt;             i_name &lt;- xidep_i$name
#&gt;             out_wide &lt;- mkinpredict(mkin_model, odeparms = odeparms, 
#&gt;                 odeini = odeini, solution_type = solution_type, 
#&gt;                 outtimes = sort(unique(i_time)))
#&gt;             out_index &lt;- cbind(as.character(i_time), as.character(i_name))
#&gt;             out_values &lt;- out_wide[out_index]
#&gt;         }
#&gt;         return(out_values)
#&gt;     }, mc.cores = cores)
#&gt;     res &lt;- unlist(res_list)
#&gt;     return(res)
#&gt; }
#&gt; &lt;bytecode: 0x55555998cba0&gt;
#&gt; &lt;environment: 0x55555bd1fee8&gt;
#&gt;   Nb of parameters: 6 
#&gt;       parameter names:  parent_0 log_k_A1 f_parent_qlogis log_k1 log_k2 g_qlogis 
#&gt;       distribution:
#&gt;      Parameter       Distribution Estimated
#&gt; [1,] parent_0        normal       Estimated
#&gt; [2,] log_k_A1        normal       Estimated
#&gt; [3,] f_parent_qlogis normal       Estimated
#&gt; [4,] log_k1          normal       Estimated
#&gt; [5,] log_k2          normal       Estimated
#&gt; [6,] g_qlogis        normal       Estimated
#&gt;   Variance-covariance matrix:
#&gt;                 parent_0 log_k_A1 f_parent_qlogis log_k1 log_k2 g_qlogis
#&gt; parent_0               1        0               0      0      0        0
#&gt; log_k_A1               0        1               0      0      0        0
#&gt; f_parent_qlogis        0        0               1      0      0        0
#&gt; log_k1                 0        0               0      1      0        0
#&gt; log_k2                 0        0               0      0      1        0
#&gt; g_qlogis               0        0               0      0      0        1
#&gt;   Error model: constant , initial values: a.1=1.64723790168612 
#&gt;     No covariate in the model.
#&gt;     Initial values
#&gt;              parent_0  log_k_A1 f_parent_qlogis    log_k1    log_k2  g_qlogis
#&gt; Pop.CondInit 93.81015 -9.764746      -0.9711148 -1.879937 -4.270814 0.1356441</div><div class='input'><span class='va'>d_saemix</span> <span class='op'>&lt;-</span> <span class='fu'>saemix_data</span><span class='op'>(</span><span class='va'>f_mmkin</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 
#&gt; The following SaemixData object was successfully created:
#&gt; 
#&gt; Object of class SaemixData
#&gt;     longitudinal data for use with the SAEM algorithm
#&gt; Dataset ds_saemix 
#&gt;     Structured data: value ~ time + name | ds 
#&gt;     X variable for graphs: time () </div><div class='input'><span class='va'>f_saemix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/saemix/man/saemix.html'>saemix</a></span><span class='op'>(</span><span class='va'>m_saemix</span>, <span class='va'>d_saemix</span>, <span class='va'>saemix_options</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Running main SAEM algorithm
#&gt; [1] "Thu Nov  5 23:53:43 2020"
#&gt; ..
#&gt;     Minimisation finished
#&gt; [1] "Thu Nov  5 23:56:33 2020"</div><div class='img'><img src='saemix-6.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; Nonlinear mixed-effects model fit by the SAEM algorithm
#&gt; -----------------------------------
#&gt; ----          Data             ----
#&gt; -----------------------------------
#&gt; Object of class SaemixData
#&gt;     longitudinal data for use with the SAEM algorithm
#&gt; Dataset ds_saemix 
#&gt;     Structured data: value ~ time + name | ds 
#&gt;     X variable for graphs: time () 
#&gt; Dataset characteristics:
#&gt;     number of subjects:     5 
#&gt;     number of observations: 170 
#&gt;     average/min/max nb obs: 34.00  /  30  /  38 
#&gt; First 10 lines of data:
#&gt;           ds time   name value mdv cens occ ytype
#&gt; 1  Dataset 6    0 parent  97.2   0    0   1     1
#&gt; 2  Dataset 6    0 parent  96.4   0    0   1     1
#&gt; 3  Dataset 6    3 parent  71.1   0    0   1     1
#&gt; 4  Dataset 6    3 parent  69.2   0    0   1     1
#&gt; 5  Dataset 6    6 parent  58.1   0    0   1     1
#&gt; 6  Dataset 6    6 parent  56.6   0    0   1     1
#&gt; 7  Dataset 6   10 parent  44.4   0    0   1     1
#&gt; 8  Dataset 6   10 parent  43.4   0    0   1     1
#&gt; 9  Dataset 6   20 parent  33.3   0    0   1     1
#&gt; 10 Dataset 6   20 parent  29.2   0    0   1     1
#&gt; -----------------------------------
#&gt; ----          Model            ----
#&gt; -----------------------------------
#&gt; Nonlinear mixed-effects model
#&gt;   Model function:  Mixed model generated from mmkin object  Model type:  structural
#&gt; function (psi, id, xidep) 
#&gt; {
#&gt;     uid &lt;- unique(id)
#&gt;     res_list &lt;- parallel::mclapply(uid, function(i) {
#&gt;         transparms_optim &lt;- psi[i, ]
#&gt;         names(transparms_optim) &lt;- names(degparms_optim)
#&gt;         odeini_optim &lt;- transparms_optim[odeini_optim_parm_names]
#&gt;         names(odeini_optim) &lt;- gsub("_0$", "", odeini_optim_parm_names)
#&gt;         odeini &lt;- c(odeini_optim, odeini_fixed)[names(mkin_model$diffs)]
#&gt;         ode_transparms_optim_names &lt;- setdiff(names(transparms_optim), 
#&gt;             odeini_optim_parm_names)
#&gt;         odeparms_optim &lt;- backtransform_odeparms(transparms_optim[ode_transparms_optim_names], 
#&gt;             mkin_model, transform_rates = object[[1]]$transform_rates, 
#&gt;             transform_fractions = object[[1]]$transform_fractions)
#&gt;         odeparms &lt;- c(odeparms_optim, odeparms_fixed)
#&gt;         xidep_i &lt;- subset(xidep, id == i)
#&gt;         if (solution_type == "analytical") {
#&gt;             out_values &lt;- mkin_model$deg_func(xidep_i, odeini, 
#&gt;                 odeparms)
#&gt;         }
#&gt;         else {
#&gt;             i_time &lt;- xidep_i$time
#&gt;             i_name &lt;- xidep_i$name
#&gt;             out_wide &lt;- mkinpredict(mkin_model, odeparms = odeparms, 
#&gt;                 odeini = odeini, solution_type = solution_type, 
#&gt;                 outtimes = sort(unique(i_time)))
#&gt;             out_index &lt;- cbind(as.character(i_time), as.character(i_name))
#&gt;             out_values &lt;- out_wide[out_index]
#&gt;         }
#&gt;         return(out_values)
#&gt;     }, mc.cores = cores)
#&gt;     res &lt;- unlist(res_list)
#&gt;     return(res)
#&gt; }
#&gt; &lt;bytecode: 0x55555998cba0&gt;
#&gt; &lt;environment: 0x55555bd1fee8&gt;
#&gt;   Nb of parameters: 6 
#&gt;       parameter names:  parent_0 log_k_A1 f_parent_qlogis log_k1 log_k2 g_qlogis 
#&gt;       distribution:
#&gt;      Parameter       Distribution Estimated
#&gt; [1,] parent_0        normal       Estimated
#&gt; [2,] log_k_A1        normal       Estimated
#&gt; [3,] f_parent_qlogis normal       Estimated
#&gt; [4,] log_k1          normal       Estimated
#&gt; [5,] log_k2          normal       Estimated
#&gt; [6,] g_qlogis        normal       Estimated
#&gt;   Variance-covariance matrix:
#&gt;                 parent_0 log_k_A1 f_parent_qlogis log_k1 log_k2 g_qlogis
#&gt; parent_0               1        0               0      0      0        0
#&gt; log_k_A1               0        1               0      0      0        0
#&gt; f_parent_qlogis        0        0               1      0      0        0
#&gt; log_k1                 0        0               0      1      0        0
#&gt; log_k2                 0        0               0      0      1        0
#&gt; g_qlogis               0        0               0      0      0        1
#&gt;   Error model: constant , initial values: a.1=1.64723790168612 
#&gt;     No covariate in the model.
#&gt;     Initial values
#&gt;              parent_0  log_k_A1 f_parent_qlogis    log_k1    log_k2  g_qlogis
#&gt; Pop.CondInit 93.81015 -9.764746      -0.9711148 -1.879937 -4.270814 0.1356441
#&gt; -----------------------------------
#&gt; ----    Key algorithm options  ----
#&gt; -----------------------------------
#&gt;     Estimation of individual parameters (MAP)
#&gt;     Estimation of standard errors and linearised log-likelihood
#&gt;     Estimation of log-likelihood by importance sampling
#&gt;     Number of iterations:  K1=200, K2=80 
#&gt;     Number of chains:  10 
#&gt;     Seed:  123456 
#&gt;     Number of MCMC iterations for IS:  5000 
#&gt;     Simulations:
#&gt;         nb of simulated datasets used for npde:  1000 
#&gt;         nb of simulated datasets used for VPC:  100 
#&gt;     Input/output
#&gt;         save the results to a file:  FALSE 
#&gt;         save the graphs to files:  FALSE 
#&gt; ----------------------------------------------------
#&gt; ----                  Results                   ----
#&gt; ----------------------------------------------------
#&gt; -----------------  Fixed effects  ------------------
#&gt; ----------------------------------------------------
#&gt;   Parameter       Estimate SE   CV(%)
#&gt;   parent_0        93.78    1.35   1.4
#&gt;   log_k_A1        -6.05    1.12  18.5
#&gt;   f_parent_qlogis -0.97    0.20  21.1
#&gt;   log_k1          -2.46    0.51  20.7
#&gt;   log_k2          -3.63    0.95  26.3
#&gt;   g_qlogis        -0.08    0.36 447.7
#&gt; a a.1              1.88    0.11   5.9
#&gt; ----------------------------------------------------
#&gt; -----------  Variance of random effects  -----------
#&gt; ----------------------------------------------------
#&gt;                 Parameter              Estimate SE   CV(%)
#&gt; parent_0        omega2.parent_0        7.85     5.76  73  
#&gt; log_k_A1        omega2.log_k_A1        4.27     3.44  80  
#&gt; f_parent_qlogis omega2.f_parent_qlogis 0.20     0.13  65  
#&gt; log_k1          omega2.log_k1          1.08     0.77  72  
#&gt; log_k2          omega2.log_k2          4.24     2.83  67  
#&gt; g_qlogis        omega2.g_qlogis        0.21     0.26 123  
#&gt; ----------------------------------------------------
#&gt; ------  Correlation matrix of random effects  ------
#&gt; ----------------------------------------------------
#&gt;                        omega2.parent_0 omega2.log_k_A1 omega2.f_parent_qlogis
#&gt; omega2.parent_0        1               0               0                     
#&gt; omega2.log_k_A1        0               1               0                     
#&gt; omega2.f_parent_qlogis 0               0               1                     
#&gt; omega2.log_k1          0               0               0                     
#&gt; omega2.log_k2          0               0               0                     
#&gt; omega2.g_qlogis        0               0               0                     
#&gt;                        omega2.log_k1 omega2.log_k2 omega2.g_qlogis
#&gt; omega2.parent_0        0             0             0              
#&gt; omega2.log_k_A1        0             0             0              
#&gt; omega2.f_parent_qlogis 0             0             0              
#&gt; omega2.log_k1          1             0             0              
#&gt; omega2.log_k2          0             1             0              
#&gt; omega2.g_qlogis        0             0             1              
#&gt; ----------------------------------------------------
#&gt; ---------------  Statistical criteria  -------------
#&gt; ----------------------------------------------------
#&gt; Likelihood computed by linearisation
#&gt;       -2LL= 879.7721 
#&gt;       AIC = 905.7721 
#&gt;       BIC = 900.6948 
#&gt; 
#&gt; Likelihood computed by importance sampling
#&gt;       -2LL= 816.8276 
#&gt;       AIC = 842.8276 
#&gt;       BIC = 837.7503 
#&gt; ----------------------------------------------------</div><div class='input'>
<span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Johannes Ranke.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


