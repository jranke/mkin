<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Read datasets and relevant meta information from a spreadsheet file — read_spreadsheet • mkin</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Read datasets and relevant meta information from a spreadsheet file — read_spreadsheet"><meta name="description" content="This function imports one dataset from each sheet of a spreadsheet file.
These sheets are selected based on the contents of a sheet 'Datasets', with
a column called 'Dataset Number', containing numbers identifying the dataset
sheets to be read in. In the second column there must be a grouping
variable, which will often be named 'Soil'. Optionally, time normalization
factors can be given in columns named 'Temperature' and 'Moisture'."><meta property="og:description" content="This function imports one dataset from each sheet of a spreadsheet file.
These sheets are selected based on the contents of a sheet 'Datasets', with
a column called 'Dataset Number', containing numbers identifying the dataset
sheets to be read in. In the second column there must be a grouping
variable, which will often be named 'Soil'. Optionally, time normalization
factors can be given in columns named 'Temperature' and 'Moisture'."><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mkin</a>

    <small class="nav-text text-info me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.2.10</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/mkin.html">Introduction to mkin</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Example evaluations with (generalised) nonlinear least squares</h6></li>
    <li><a class="dropdown-item" href="../articles/FOCUS_D.html">Example evaluation of FOCUS Example Dataset D</a></li>
    <li><a class="dropdown-item" href="../articles/FOCUS_L.html">Example evaluation of FOCUS Laboratory Data L1 to L3</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/FOCUS_Z.html">Example evaluation of FOCUS Example Dataset Z</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Example evaluations with hierarchical models (nonlinear mixed-effects models)</h6></li>
    <li><a class="dropdown-item" href="../articles/prebuilt/2022_dmta_parent.html">Testing hierarchical parent degradation kinetics with residue data on dimethenamid and dimethenamid-P</a></li>
    <li><a class="dropdown-item" href="../articles/prebuilt/2022_dmta_pathway.html">Testing hierarchical pathway kinetics with residue data on dimethenamid and dimethenamid-P</a></li>
    <li><a class="dropdown-item" href="../articles/prebuilt/2023_mesotrione_parent.html">Testing covariate modelling in hierarchical parent degradation kinetics with residue data on mesotrione</a></li>
    <li><a class="dropdown-item" href="../articles/prebuilt/2022_cyan_pathway.html">Testing hierarchical pathway kinetics with residue data on cyantraniliprole</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/dimethenamid_2018.html">Comparison of saemix and nlme evaluations of dimethenamid data from 2018</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/multistart.html">Short demo of the multistart method</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Performance</h6></li>
    <li><a class="dropdown-item" href="../articles/web_only/compiled_models.html">Performance benefit by using compiled model definitions in mkin</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/benchmarks.html">Benchmark timings for mkin</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/saem_benchmarks.html">Benchmark timings for saem.mmkin</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Miscellaneous</h6></li>
    <li><a class="dropdown-item" href="../articles/twa.html">Calculation of time weighted average concentrations with mkin</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/NAFTA_examples.html">Example evaluation of NAFTA SOP Attachment examples</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../coverage/coverage.html">Test coverage</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jranke/mkin/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Read datasets and relevant meta information from a spreadsheet file</h1>
      <small class="dont-index">Source: <a href="https://github.com/jranke/mkin/blob/HEAD/R/read_spreadsheet.R" class="external-link"><code>R/read_spreadsheet.R</code></a></small>
      <div class="d-none name"><code>read_spreadsheet.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function imports one dataset from each sheet of a spreadsheet file.
These sheets are selected based on the contents of a sheet 'Datasets', with
a column called 'Dataset Number', containing numbers identifying the dataset
sheets to be read in. In the second column there must be a grouping
variable, which will often be named 'Soil'. Optionally, time normalization
factors can be given in columns named 'Temperature' and 'Moisture'.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">read_spreadsheet</span><span class="op">(</span></span>
<span>  <span class="va">path</span>,</span>
<span>  valid_datasets <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  parent_only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  normalize <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>Absolute or relative path to the spreadsheet file</p></dd>


<dt id="arg-valid-datasets">valid_datasets<a class="anchor" aria-label="anchor" href="#arg-valid-datasets"></a></dt>
<dd><p>Optional numeric index of the valid datasets, default is
to use all datasets</p></dd>


<dt id="arg-parent-only">parent_only<a class="anchor" aria-label="anchor" href="#arg-parent-only"></a></dt>
<dd><p>Should only the parent data be used?</p></dd>


<dt id="arg-normalize">normalize<a class="anchor" aria-label="anchor" href="#arg-normalize"></a></dt>
<dd><p>Should the time scale be normalized using temperature
and moisture normalisation factors in the sheet 'Datasets'?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>There must be a sheet 'Compounds', with columns 'Name' and 'Acronym'.
The first row read after the header read in from this sheet is assumed
to contain name and acronym of the parent compound.</p>
<p>The dataset sheets should be named using the dataset numbers read in from
the 'Datasets' sheet, i.e. '1', '2', ... . In each dataset sheet, the name
of the observed variable (e.g. the acronym of the parent compound or
one of its transformation products) should be in the first column,
the time values should be in the second colum, and the observed value
in the third column.</p>
<p>In case relevant covariate data are available, they should be given
in a sheet 'Covariates', containing one line for each value of the grouping
variable specified in 'Datasets'. These values should be in the first
column and the column must have the same name as the second column in
'Datasets'. Covariates will be read in from columns four and higher.
Their names should preferably not contain special characters like spaces,
so they can be easily used for specifying covariate models.</p>
<p>A similar data structure is defined as the R6 class <a href="mkindsg.html">mkindsg</a>, but
is probably more complicated to use.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johannes Ranke.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

