<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit a kinetic model to data with one or more state variables — mkinfit • mkin</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fit a kinetic model to data with one or more state variables — mkinfit" />
<meta property="og:description" content="This function maximises the likelihood of the observed data using the Port
algorithm nlminb, and the specified initial or fixed
parameters and starting values.  In each step of the optimsation, the
kinetic model is solved using the function mkinpredict. The
parameters of the selected error model are fitted simultaneously with the
degradation model parameters, as both of them are arguments of the
likelihood function." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mkin</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.49.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Functions and data</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mkin.html">Introduction to mkin</a>
    </li>
    <li>
      <a href="../articles/FOCUS_D.html">Example evaluation of FOCUS Example Dataset D</a>
    </li>
    <li>
      <a href="../articles/FOCUS_L.html">Example evaluation of FOCUS Laboratory Data L1 to L3</a>
    </li>
    <li>
      <a href="../articles/web_only/FOCUS_Z.html">Example evaluation of FOCUS Example Dataset Z</a>
    </li>
    <li>
      <a href="../articles/web_only/compiled_models.html">Performance benefit by using compiled model definitions in mkin</a>
    </li>
    <li>
      <a href="../articles/twa.html">Calculation of time weighted average concentrations with mkin</a>
    </li>
    <li>
      <a href="../articles/web_only/NAFTA_examples.html">Example evaluation of NAFTA SOP Attachment examples</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/jranke/mkin/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a kinetic model to data with one or more state variables</h1>
    <small class="dont-index">Source: <a href='http://github.com/jranke/mkin/blob/master/R/mkinfit.R'><code>R/mkinfit.R</code></a></small>
    <div class="hidden name"><code>mkinfit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function maximises the likelihood of the observed data using the Port
algorithm <code><a href='https://rdrr.io/r/stats/nlminb.html'>nlminb</a></code>, and the specified initial or fixed
parameters and starting values.  In each step of the optimsation, the
kinetic model is solved using the function <code><a href='mkinpredict.html'>mkinpredict</a></code>. The
parameters of the selected error model are fitted simultaneously with the
degradation model parameters, as both of them are arguments of the
likelihood function.</p>
    </div>

    <pre class="usage"><span class='fu'>mkinfit</span>(
  <span class='no'>mkinmod</span>,
  <span class='no'>observed</span>,
  <span class='kw'>parms.ini</span> <span class='kw'>=</span> <span class='st'>"auto"</span>,
  <span class='kw'>state.ini</span> <span class='kw'>=</span> <span class='st'>"auto"</span>,
  <span class='kw'>err.ini</span> <span class='kw'>=</span> <span class='st'>"auto"</span>,
  <span class='kw'>fixed_parms</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>fixed_initials</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>mkinmod</span>$<span class='no'>diffs</span>)[-<span class='fl'>1</span>],
  <span class='kw'>from_max_mean</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>solution_type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"auto"</span>, <span class='st'>"analytical"</span>, <span class='st'>"eigen"</span>, <span class='st'>"deSolve"</span>),
  <span class='kw'>method.ode</span> <span class='kw'>=</span> <span class='st'>"lsoda"</span>,
  <span class='kw'>use_compiled</span> <span class='kw'>=</span> <span class='st'>"auto"</span>,
  <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>eval.max</span> <span class='kw'>=</span> <span class='fl'>300</span>, <span class='kw'>iter.max</span> <span class='kw'>=</span> <span class='fl'>200</span>),
  <span class='kw'>transform_rates</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>transform_fractions</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>atol</span> <span class='kw'>=</span> <span class='fl'>1e-08</span>,
  <span class='kw'>rtol</span> <span class='kw'>=</span> <span class='fl'>1e-10</span>,
  <span class='kw'>n.outtimes</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>error_model</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"const"</span>, <span class='st'>"obs"</span>, <span class='st'>"tc"</span>),
  <span class='kw'>error_model_algorithm</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"auto"</span>, <span class='st'>"d_3"</span>, <span class='st'>"direct"</span>, <span class='st'>"twostep"</span>, <span class='st'>"threestep"</span>,
    <span class='st'>"fourstep"</span>, <span class='st'>"IRLS"</span>, <span class='st'>"OLS"</span>),
  <span class='kw'>reweight.tol</span> <span class='kw'>=</span> <span class='fl'>1e-08</span>,
  <span class='kw'>reweight.max.iter</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>trace_parms</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mkinmod</th>
      <td><p>A list of class <code><a href='mkinmod.html'>mkinmod</a></code>, containing the kinetic
model to be fitted to the data, or one of the shorthand names ("SFO",
"FOMC", "DFOP", "HS", "SFORB", "IORE"). If a shorthand name is given, a
parent only degradation model is generated for the variable with the
highest value in <code>observed</code>.</p></td>
    </tr>
    <tr>
      <th>observed</th>
      <td><p>A dataframe with the observed data.  The first column called
"name" must contain the name of the observed variable for each data point.
The second column must contain the times of observation, named "time".
The third column must be named "value" and contain the observed values.
Zero values in the "value" column will be removed, with a warning, in
order to avoid problems with fitting the two-component error model. This
is not expected to be a problem, because in general, values of zero are
not observed in degradation data, because there is a lower limit of
detection.</p></td>
    </tr>
    <tr>
      <th>parms.ini</th>
      <td><p>A named vector of initial values for the parameters,
  including parameters to be optimised and potentially also fixed parameters
  as indicated by <code>fixed_parms</code>.  If set to "auto", initial values for
  rate constants are set to default values.  Using parameter names that are
  not in the model gives an error.</p>
<p>It is possible to only specify a subset of the parameters that the model
  needs. You can use the parameter lists "bparms.ode" from a previously
  fitted model, which contains the differential equation parameters from
  this model.  This works nicely if the models are nested. An example is
  given below.</p></td>
    </tr>
    <tr>
      <th>state.ini</th>
      <td><p>A named vector of initial values for the state variables of
the model. In case the observed variables are represented by more than one
model variable, the names will differ from the names of the observed
variables (see <code>map</code> component of <code><a href='mkinmod.html'>mkinmod</a></code>). The default
is to set the initial value of the first model variable to the mean of the
time zero values for the variable with the maximum observed value, and all
others to 0.  If this variable has no time zero observations, its initial
value is set to 100.</p></td>
    </tr>
    <tr>
      <th>err.ini</th>
      <td><p>A named vector of initial values for the error model
parameters to be optimised.  If set to "auto", initial values are set to
default values.  Otherwise, inital values for all error model parameters
must be given.</p></td>
    </tr>
    <tr>
      <th>fixed_parms</th>
      <td><p>The names of parameters that should not be optimised but
rather kept at the values specified in <code>parms.ini</code>. Alternatively,
a named numeric vector of parameters to be fixed, regardless of the values
in parms.ini.</p></td>
    </tr>
    <tr>
      <th>fixed_initials</th>
      <td><p>The names of model variables for which the initial
state at time 0 should be excluded from the optimisation. Defaults to all
state variables except for the first one.</p></td>
    </tr>
    <tr>
      <th>from_max_mean</th>
      <td><p>If this is set to TRUE, and the model has only one
observed variable, then data before the time of the maximum observed value
(after averaging for each sampling time) are discarded, and this time is
subtracted from all remaining time values, so the time of the maximum
observed mean value is the new time zero.</p></td>
    </tr>
    <tr>
      <th>solution_type</th>
      <td><p>If set to "eigen", the solution of the system of
differential equations is based on the spectral decomposition of the
coefficient matrix in cases that this is possible. If set to "deSolve", a
numerical ode solver from package <code>deSolve</code> is used. If set to
"analytical", an analytical solution of the model is used. This is only
implemented for simple degradation experiments with only one state
variable, i.e. with no metabolites. The default is "auto", which uses
"analytical" if possible, otherwise "deSolve" if a compiler is present,
and "eigen" if no compiler is present and the model can be expressed using
eigenvalues and eigenvectors.  This argument is passed on to the helper
function <code><a href='mkinpredict.html'>mkinpredict</a></code>.</p></td>
    </tr>
    <tr>
      <th>method.ode</th>
      <td><p>The solution method passed via <code><a href='mkinpredict.html'>mkinpredict</a></code>
to <code>ode</code> in case the solution type is "deSolve". The default
"lsoda" is performant, but sometimes fails to converge.</p></td>
    </tr>
    <tr>
      <th>use_compiled</th>
      <td><p>If set to <code>FALSE</code>, no compiled version of the
<code><a href='mkinmod.html'>mkinmod</a></code> model is used in the calls to
<code><a href='mkinpredict.html'>mkinpredict</a></code> even if a compiled version is present.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>A list of control arguments passed to <code><a href='https://rdrr.io/r/stats/nlminb.html'>nlminb</a></code>.</p></td>
    </tr>
    <tr>
      <th>transform_rates</th>
      <td><p>Boolean specifying if kinetic rate constants should
be transformed in the model specification used in the fitting for better
compliance with the assumption of normal distribution of the estimator. If
TRUE, also alpha and beta parameters of the FOMC model are
log-transformed, as well as k1 and k2 rate constants for the DFOP and HS
models and the break point tb of the HS model.  If FALSE, zero is used as
a lower bound for the rates in the optimisation.</p></td>
    </tr>
    <tr>
      <th>transform_fractions</th>
      <td><p>Boolean specifying if formation fractions
constants should be transformed in the model specification used in the
fitting for better compliance with the assumption of normal distribution
of the estimator. The default (TRUE) is to do transformations. If TRUE,
the g parameter of the DFOP and HS models are also transformed, as they
can also be seen as compositional data. The transformation used for these
transformations is the <code><a href='ilr.html'>ilr</a></code> transformation.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>Suppress printing out the current value of the negative
log-likelihood after each improvement?</p></td>
    </tr>
    <tr>
      <th>atol</th>
      <td><p>Absolute error tolerance, passed to <code>ode</code>. Default
is 1e-8, lower than in <code>lsoda</code>.</p></td>
    </tr>
    <tr>
      <th>rtol</th>
      <td><p>Absolute error tolerance, passed to <code>ode</code>. Default
is 1e-10, much lower than in <code>lsoda</code>.</p></td>
    </tr>
    <tr>
      <th>n.outtimes</th>
      <td><p>The length of the dataseries that is produced by the model
prediction function <code><a href='mkinpredict.html'>mkinpredict</a></code>. This impacts the accuracy
of the numerical solver if that is used (see <code>solution_type</code>
argument.  The default value is 100.</p></td>
    </tr>
    <tr>
      <th>error_model</th>
      <td><p>If the error model is "const", a constant standard
  deviation is assumed.</p>
<p>If the error model is "obs", each observed variable is assumed to have its
  own variance.</p>
<p>If the error model is "tc" (two-component error model), a two component
  error model similar to the one described by Rocke and Lorenzato (1995) is
  used for setting up the likelihood function.  Note that this model
  deviates from the model by Rocke and Lorenzato, as their model implies
  that the errors follow a lognormal distribution for large values, not a
  normal distribution as assumed by this method.</p></td>
    </tr>
    <tr>
      <th>error_model_algorithm</th>
      <td><p>If "auto", the selected algorithm depends on
  the error model.  If the error model is "const", unweighted nonlinear
  least squares fitting ("OLS") is selected. If the error model is "obs", or
  "tc", the "d_3" algorithm is selected.</p>
<p>The algorithm "d_3" will directly minimize the negative log-likelihood and
  - independently - also use the three step algorithm described below. The
  fit with the higher likelihood is returned.</p>
<p>The algorithm "direct" will directly minimize the negative log-likelihood.</p>
<p>The algorithm "twostep" will minimize the negative log-likelihood after an
  initial unweighted least squares optimisation step.</p>
<p>The algorithm "threestep" starts with unweighted least squares, then
  optimizes only the error model using the degradation model parameters
  found, and then minimizes the negative log-likelihood with free
  degradation and error model parameters.</p>
<p>The algorithm "fourstep" starts with unweighted least squares, then
  optimizes only the error model using the degradation model parameters
  found, then optimizes the degradation model again with fixed error model
  parameters, and finally minimizes the negative log-likelihood with free
  degradation and error model parameters.</p>
<p>The algorithm "IRLS" (Iteratively Reweighted Least Squares) starts with
  unweighted least squares, and then iterates optimization of the error
  model parameters and subsequent optimization of the degradation model
  using those error model parameters, until the error model parameters
  converge.</p></td>
    </tr>
    <tr>
      <th>reweight.tol</th>
      <td><p>Tolerance for the convergence criterion calculated from
the error model parameters in IRLS fits.</p></td>
    </tr>
    <tr>
      <th>reweight.max.iter</th>
      <td><p>Maximum number of iterations in IRLS fits.</p></td>
    </tr>
    <tr>
      <th>trace_parms</th>
      <td><p>Should a trace of the parameter values be listed?</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments that will be passed on to
<code>deSolve</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="source"><a class="anchor" href="#source"></a>Source</h2>

    <p>Rocke, David M. und Lorenzato, Stefan (1995) A two-component model
  for measurement error in analytical chemistry. Technometrics 37(2), 176-184.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with "mkinfit" in the class attribute.  A summary can be
  obtained by <code><a href='summary.mkinfit.html'>summary.mkinfit</a></code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Per default, parameters in the kinetic models are internally transformed in
order to better satisfy the assumption of a normal distribution of their
estimators.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>When using the "IORE" submodel for metabolites, fitting with
  "transform_rates = TRUE" (the default) often leads to failures of the
  numerical ODE solver. In this situation it may help to switch off the
  internal rate transformation.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Plotting methods <code><a href='plot.mkinfit.html'>plot.mkinfit</a></code> and
  <code><a href='mkinparplot.html'>mkinparplot</a></code>.</p>
<p>Comparisons of models fitted to the same data can be made using
  <code><a href='https://rdrr.io/r/stats/AIC.html'>AIC</a></code> by virtue of the method <code><a href='logLik.mkinfit.html'>logLik.mkinfit</a></code>.</p>
<p>Fitting of several models to several datasets in a single call to
  <code><a href='mmkin.html'>mmkin</a></code>.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Use shorthand notation for parent only degradation</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='st'>"FOMC"</span>, <span class='no'>FOCUS_2006_C</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='error'>Error in (function (t, parent_0, alpha, beta) {    parent = parent_0/(t/beta + 1)^alpha})(t = c(0, 1, 1.2020202020202, 2.4040404040404, 3, 3.60606060606061, 4.80808080808081, 6.01010101010101, 7, 7.21212121212121, 8.41414141414141, 9.61616161616162, 10.8181818181818, 12.020202020202, 13.2222222222222, 14, 14.4242424242424, 15.6262626262626, 16.8282828282828, 18.030303030303, 19.2323232323232, 20.4343434343434, 21.6363636363636, 22.8383838383838, 24.040404040404, 25.2424242424242, 26.4444444444444, 27.6464646464646, 28, 28.8484848484848, 30.050505050505, 31.2525252525253, 32.4545454545455, 33.6565656565657, 34.8585858585859, 36.0606060606061, 37.2626262626263, 38.4646464646465, 39.6666666666667, 40.8686868686869, 42.0707070707071, 43.2727272727273, 44.4747474747475, 45.6767676767677, 46.8787878787879, 48.0808080808081, 49.2828282828283, 50.4848484848485, 51.6868686868687, 52.8888888888889, 54.0909090909091, 55.2929292929293, 56.4949494949495, 57.6969696969697, 58.8989898989899, 60.1010101010101, 61.3030303030303, 62.5050505050505, 63, 63.7070707070707, 64.9090909090909, 66.1111111111111, 67.3131313131313, 68.5151515151515, 69.7171717171717, 70.9191919191919, 72.1212121212121, 73.3232323232323, 74.5252525252525, 75.7272727272727, 76.9292929292929, 78.1313131313131, 79.3333333333333, 80.5353535353535, 81.7373737373737, 82.9393939393939, 84.1414141414141, 85.3434343434343, 86.5454545454545, 87.7474747474747, 88.9494949494949, 90.1515151515152, 91, 91.3535353535353, 92.5555555555556, 93.7575757575758, 94.959595959596, 96.1616161616162, 97.3636363636364, 98.5656565656566, 99.7676767676768, 100.969696969697, 102.171717171717, 103.373737373737, 104.575757575758, 105.777777777778, 106.979797979798, 108.181818181818, 109.383838383838, 110.585858585859, 111.787878787879, 112.989898989899, 114.191919191919, 115.393939393939, 116.59595959596, 117.79797979798, 119), parent.0 = c(parent = 85.1),     alpha = 1, beta = 10): unbenutztes Argument (parent.0 = 85.1)</span></div><div class='output co'>#&gt; <span class='message'>Timing stopped at: 0 0 0.001</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt; <span class='error'>Error in summary(fit): Objekt 'fit' nicht gefunden</span></div><div class='input'>
<span class='co'># One parent compound, one metabolite, both single first order.</span>
<span class='co'># Use mkinsub for convenience in model formulation. Pathway to sink included per default.</span>
<span class='no'>SFO_SFO</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mkinmod.html'>mkinmod</a></span>(
  <span class='kw'>parent</span> <span class='kw'>=</span> <span class='fu'><a href='mkinsub.html'>mkinsub</a></span>(<span class='st'>"SFO"</span>, <span class='st'>"m1"</span>),
  <span class='kw'>m1</span> <span class='kw'>=</span> <span class='fu'><a href='mkinsub.html'>mkinsub</a></span>(<span class='st'>"SFO"</span>))</div><div class='output co'>#&gt; <span class='message'>Successfully compiled differential equation model from auto-generated C code.</span></div><div class='input'><span class='co'># Fit the model to the FOCUS example dataset D using defaults</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span>(<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='no'>SFO_SFO</span>, <span class='no'>FOCUS_2006_D</span>,
                           <span class='kw'>solution_type</span> <span class='kw'>=</span> <span class='st'>"eigen"</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)))</div><div class='output co'>#&gt; <span class='warning'>Warning: Observations with value of zero were removed from the data</span></div><div class='output co'>#&gt;        User      System verstrichen 
#&gt;       1.526       0.000       1.526 </div><div class='input'><span class='fu'><a href='parms.html'>parms</a></span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt;      parent_0 k_parent_sink   k_parent_m1     k_m1_sink         sigma 
#&gt;  99.598483069   0.047920122   0.050777612   0.005260651   3.125503875 </div><div class='input'><span class='fu'><a href='endpoints.html'>endpoints</a></span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt; $ff
#&gt; parent_sink   parent_m1     m1_sink 
#&gt;    0.485524    0.514476    1.000000 
#&gt; 
#&gt; $distimes
#&gt;              DT50      DT90
#&gt; parent   7.022929  23.32967
#&gt; m1     131.760712 437.69961
#&gt; </div><div class='input'><span class='co'># \dontrun{</span>
<span class='co'># deSolve is slower when no C compiler (gcc) was available during model generation</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span>(<span class='no'>fit.deSolve</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='no'>SFO_SFO</span>, <span class='no'>FOCUS_2006_D</span>,
                           <span class='kw'>solution_type</span> <span class='kw'>=</span> <span class='st'>"deSolve"</span>)))</div><div class='output co'>#&gt; <span class='warning'>Warning: Observations with value of zero were removed from the data</span></div><div class='output co'>#&gt; <span class='message'>Ordinary least squares optimisation</span></div><div class='output co'>#&gt; Sum of squared residuals at call 1: 18915.53
#&gt; Sum of squared residuals at call 2: 18915.53
#&gt; Sum of squared residuals at call 6: 11424.02
#&gt; Sum of squared residuals at call 10: 11424
#&gt; Sum of squared residuals at call 12: 4094.396
#&gt; Sum of squared residuals at call 16: 4094.396
#&gt; Sum of squared residuals at call 19: 1340.595
#&gt; Sum of squared residuals at call 20: 1340.593
#&gt; Sum of squared residuals at call 25: 1072.239
#&gt; Sum of squared residuals at call 28: 1072.236
#&gt; Sum of squared residuals at call 30: 874.2615
#&gt; Sum of squared residuals at call 33: 874.2611
#&gt; Sum of squared residuals at call 35: 616.2375
#&gt; Sum of squared residuals at call 37: 616.237
#&gt; Sum of squared residuals at call 40: 467.4386
#&gt; Sum of squared residuals at call 42: 467.438
#&gt; Sum of squared residuals at call 46: 398.2913
#&gt; Sum of squared residuals at call 48: 398.2913
#&gt; Sum of squared residuals at call 49: 398.2912
#&gt; Sum of squared residuals at call 51: 395.0711
#&gt; Sum of squared residuals at call 54: 395.071
#&gt; Sum of squared residuals at call 56: 378.3298
#&gt; Sum of squared residuals at call 59: 378.3298
#&gt; Sum of squared residuals at call 62: 376.9812
#&gt; Sum of squared residuals at call 64: 376.9811
#&gt; Sum of squared residuals at call 67: 375.2085
#&gt; Sum of squared residuals at call 69: 375.2085
#&gt; Sum of squared residuals at call 70: 375.2085
#&gt; Sum of squared residuals at call 71: 375.2085
#&gt; Sum of squared residuals at call 72: 374.5723
#&gt; Sum of squared residuals at call 74: 374.5723
#&gt; Sum of squared residuals at call 77: 374.0075
#&gt; Sum of squared residuals at call 79: 374.0075
#&gt; Sum of squared residuals at call 80: 374.0075
#&gt; Sum of squared residuals at call 82: 373.1711
#&gt; Sum of squared residuals at call 84: 373.1711
#&gt; Sum of squared residuals at call 87: 372.6445
#&gt; Sum of squared residuals at call 88: 372.1614
#&gt; Sum of squared residuals at call 90: 372.1614
#&gt; Sum of squared residuals at call 91: 372.1614
#&gt; Sum of squared residuals at call 94: 371.6464
#&gt; Sum of squared residuals at call 99: 371.4299
#&gt; Sum of squared residuals at call 101: 371.4299
#&gt; Sum of squared residuals at call 104: 371.4071
#&gt; Sum of squared residuals at call 106: 371.4071
#&gt; Sum of squared residuals at call 107: 371.4071
#&gt; Sum of squared residuals at call 109: 371.2524
#&gt; Sum of squared residuals at call 113: 371.2524
#&gt; Sum of squared residuals at call 114: 371.2136
#&gt; Sum of squared residuals at call 115: 371.2136
#&gt; Sum of squared residuals at call 116: 371.2136
#&gt; Sum of squared residuals at call 119: 371.2134
#&gt; Sum of squared residuals at call 120: 371.2134
#&gt; Sum of squared residuals at call 122: 371.2134
#&gt; Sum of squared residuals at call 123: 371.2134
#&gt; Sum of squared residuals at call 125: 371.2134
#&gt; Sum of squared residuals at call 126: 371.2134
#&gt; Sum of squared residuals at call 135: 371.2134
#&gt; Negative log-likelihood at call 145: 97.22429</div><div class='output co'>#&gt; <span class='message'>Optimisation successfully terminated.</span></div><div class='output co'>#&gt;        User      System verstrichen 
#&gt;       1.084       0.000       1.085 </div><div class='input'><span class='fu'><a href='parms.html'>parms</a></span>(<span class='no'>fit.deSolve</span>)</div><div class='output co'>#&gt;      parent_0 k_parent_sink   k_parent_m1     k_m1_sink         sigma 
#&gt;  99.598483072   0.047920122   0.050777612   0.005260651   3.125503874 </div><div class='input'><span class='fu'><a href='endpoints.html'>endpoints</a></span>(<span class='no'>fit.deSolve</span>)</div><div class='output co'>#&gt; $ff
#&gt; parent_sink   parent_m1     m1_sink 
#&gt;    0.485524    0.514476    1.000000 
#&gt; 
#&gt; $distimes
#&gt;              DT50      DT90
#&gt; parent   7.022929  23.32967
#&gt; m1     131.760712 437.69961
#&gt; </div><div class='input'><span class='co'># }</span>

<span class='co'># Use stepwise fitting, using optimised parameters from parent only fit, FOMC</span>
<span class='co'># \dontrun{</span>
<span class='no'>FOMC_SFO</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mkinmod.html'>mkinmod</a></span>(
  <span class='kw'>parent</span> <span class='kw'>=</span> <span class='fu'><a href='mkinsub.html'>mkinsub</a></span>(<span class='st'>"FOMC"</span>, <span class='st'>"m1"</span>),
  <span class='kw'>m1</span> <span class='kw'>=</span> <span class='fu'><a href='mkinsub.html'>mkinsub</a></span>(<span class='st'>"SFO"</span>))</div><div class='output co'>#&gt; <span class='message'>Successfully compiled differential equation model from auto-generated C code.</span></div><div class='input'><span class='co'># Fit the model to the FOCUS example dataset D using defaults</span>
<span class='no'>fit.FOMC_SFO</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='no'>FOMC_SFO</span>, <span class='no'>FOCUS_2006_D</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Observations with value of zero were removed from the data</span></div><div class='input'><span class='co'># Use starting parameters from parent only FOMC fit</span>
<span class='no'>fit.FOMC</span> <span class='kw'>=</span> <span class='fu'>mkinfit</span>(<span class='st'>"FOMC"</span>, <span class='no'>FOCUS_2006_D</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='error'>Error in (function (t, parent_0, alpha, beta) {    parent = parent_0/(t/beta + 1)^alpha})(t = c(0, 0.757575757575758, 1, 1.51515151515152, 2.27272727272727, 3, 3.03030303030303, 3.78787878787879, 4.54545454545454, 5.3030303030303, 6.06060606060606, 6.81818181818182, 7, 7.57575757575758, 8.33333333333333, 9.09090909090909, 9.84848484848485, 10.6060606060606, 11.3636363636364, 12.1212121212121, 12.8787878787879, 13.6363636363636, 14, 14.3939393939394, 15.1515151515152, 15.9090909090909, 16.6666666666667, 17.4242424242424, 18.1818181818182, 18.9393939393939, 19.6969696969697, 20.4545454545455, 21, 21.2121212121212, 21.969696969697, 22.7272727272727, 23.4848484848485, 24.2424242424242, 25, 25.7575757575758, 26.5151515151515, 27.2727272727273, 28.030303030303, 28.7878787878788, 29.5454545454545, 30.3030303030303, 31.0606060606061, 31.8181818181818, 32.5757575757576, 33.3333333333333, 34.0909090909091, 34.8484848484849, 35, 35.6060606060606, 36.3636363636364, 37.1212121212121, 37.8787878787879, 38.6363636363636, 39.3939393939394, 40.1515151515151, 40.9090909090909, 41.6666666666667, 42.4242424242424, 43.1818181818182, 43.9393939393939, 44.6969696969697, 45.4545454545455, 46.2121212121212, 46.969696969697, 47.7272727272727, 48.4848484848485, 49.2424242424242, 50, 50.7575757575758, 51.5151515151515, 52.2727272727273, 53.030303030303, 53.7878787878788, 54.5454545454545, 55.3030303030303, 56.0606060606061, 56.8181818181818, 57.5757575757576, 58.3333333333333, 59.0909090909091, 59.8484848484849, 60.6060606060606, 61.3636363636364, 62.1212121212121, 62.8787878787879, 63.6363636363636, 64.3939393939394, 65.1515151515152, 65.9090909090909, 66.6666666666667, 67.4242424242424, 68.1818181818182, 68.9393939393939, 69.6969696969697, 70.4545454545455, 71.2121212121212, 71.969696969697, 72.7272727272727, 73.4848484848485, 74.2424242424242, 75), parent.0 = c(parent = 100.75), alpha = 1,     beta = 10): unbenutztes Argument (parent.0 = 100.75)</span></div><div class='output co'>#&gt; <span class='message'>Timing stopped at: 0 0 0.001</span></div><div class='input'><span class='no'>fit.FOMC_SFO</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='no'>FOMC_SFO</span>, <span class='no'>FOCUS_2006_D</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>parms.ini</span> <span class='kw'>=</span> <span class='no'>fit.FOMC</span>$<span class='no'>bparms.ode</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Observations with value of zero were removed from the data</span></div><div class='output co'>#&gt; <span class='error'>Error in mkinfit(FOMC_SFO, FOCUS_2006_D, quiet = TRUE, parms.ini = fit.FOMC$bparms.ode): Objekt 'fit.FOMC' nicht gefunden</span></div><div class='input'>
<span class='co'># Use stepwise fitting, using optimised parameters from parent only fit, SFORB</span>
<span class='no'>SFORB_SFO</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mkinmod.html'>mkinmod</a></span>(
  <span class='kw'>parent</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"SFORB"</span>, <span class='kw'>to</span> <span class='kw'>=</span> <span class='st'>"m1"</span>, <span class='kw'>sink</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>),
  <span class='kw'>m1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"SFO"</span>))</div><div class='output co'>#&gt; <span class='message'>Successfully compiled differential equation model from auto-generated C code.</span></div><div class='input'><span class='co'># Fit the model to the FOCUS example dataset D using defaults</span>
<span class='no'>fit.SFORB_SFO</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='no'>SFORB_SFO</span>, <span class='no'>FOCUS_2006_D</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Observations with value of zero were removed from the data</span></div><div class='input'><span class='no'>fit.SFORB_SFO.deSolve</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='no'>SFORB_SFO</span>, <span class='no'>FOCUS_2006_D</span>, <span class='kw'>solution_type</span> <span class='kw'>=</span> <span class='st'>"deSolve"</span>,
                                 <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Observations with value of zero were removed from the data</span></div><div class='input'><span class='co'># Use starting parameters from parent only SFORB fit (not really needed in this case)</span>
<span class='no'>fit.SFORB</span> <span class='kw'>=</span> <span class='fu'>mkinfit</span>(<span class='st'>"SFORB"</span>, <span class='no'>FOCUS_2006_D</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='error'>Error in (function (t, parent_0, k_12, k_21, k_1output) {    sqrt_exp = sqrt(1/4 * (k_12 + k_21 + k_1output)^2 + k_12 *         k_21 - (k_12 + k_1output) * k_21)    b1 = 0.5 * (k_12 + k_21 + k_1output) + sqrt_exp    b2 = 0.5 * (k_12 + k_21 + k_1output) - sqrt_exp    parent = parent_0 * (((k_12 + k_21 - b1)/(b2 - b1)) * exp(-b1 *         t) + ((k_12 + k_21 - b2)/(b1 - b2)) * exp(-b2 * t))})(t = c(0, 0.757575757575758, 1, 1.51515151515152, 2.27272727272727, 3, 3.03030303030303, 3.78787878787879, 4.54545454545454, 5.3030303030303, 6.06060606060606, 6.81818181818182, 7, 7.57575757575758, 8.33333333333333, 9.09090909090909, 9.84848484848485, 10.6060606060606, 11.3636363636364, 12.1212121212121, 12.8787878787879, 13.6363636363636, 14, 14.3939393939394, 15.1515151515152, 15.9090909090909, 16.6666666666667, 17.4242424242424, 18.1818181818182, 18.9393939393939, 19.6969696969697, 20.4545454545455, 21, 21.2121212121212, 21.969696969697, 22.7272727272727, 23.4848484848485, 24.2424242424242, 25, 25.7575757575758, 26.5151515151515, 27.2727272727273, 28.030303030303, 28.7878787878788, 29.5454545454545, 30.3030303030303, 31.0606060606061, 31.8181818181818, 32.5757575757576, 33.3333333333333, 34.0909090909091, 34.8484848484849, 35, 35.6060606060606, 36.3636363636364, 37.1212121212121, 37.8787878787879, 38.6363636363636, 39.3939393939394, 40.1515151515151, 40.9090909090909, 41.6666666666667, 42.4242424242424, 43.1818181818182, 43.9393939393939, 44.6969696969697, 45.4545454545455, 46.2121212121212, 46.969696969697, 47.7272727272727, 48.4848484848485, 49.2424242424242, 50, 50.7575757575758, 51.5151515151515, 52.2727272727273, 53.030303030303, 53.7878787878788, 54.5454545454545, 55.3030303030303, 56.0606060606061, 56.8181818181818, 57.5757575757576, 58.3333333333333, 59.0909090909091, 59.8484848484849, 60.6060606060606, 61.3636363636364, 62.1212121212121, 62.8787878787879, 63.6363636363636, 64.3939393939394, 65.1515151515152, 65.9090909090909, 66.6666666666667, 67.4242424242424, 68.1818181818182, 68.9393939393939, 69.6969696969697, 70.4545454545455, 71.2121212121212, 71.969696969697, 72.7272727272727, 73.4848484848485, 74.2424242424242, 75), parent.0 = c(parent_free = 100.75), k_1output = 0.1,     k_12 = 0.1, k_21 = 0.02): unbenutztes Argument (parent.0 = 100.75)</span></div><div class='output co'>#&gt; <span class='message'>Timing stopped at: 0.001 0 0.001</span></div><div class='input'><span class='no'>fit.SFORB_SFO</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='no'>SFORB_SFO</span>, <span class='no'>FOCUS_2006_D</span>, <span class='kw'>parms.ini</span> <span class='kw'>=</span> <span class='no'>fit.SFORB</span>$<span class='no'>bparms.ode</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Observations with value of zero were removed from the data</span></div><div class='output co'>#&gt; <span class='error'>Error in mkinfit(SFORB_SFO, FOCUS_2006_D, parms.ini = fit.SFORB$bparms.ode,     quiet = TRUE): Objekt 'fit.SFORB' nicht gefunden</span></div><div class='input'><span class='co'># }</span>

<span class='co'># \dontrun{</span>
<span class='co'># Weighted fits, including IRLS</span>
<span class='no'>SFO_SFO.ff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mkinmod.html'>mkinmod</a></span>(<span class='kw'>parent</span> <span class='kw'>=</span> <span class='fu'><a href='mkinsub.html'>mkinsub</a></span>(<span class='st'>"SFO"</span>, <span class='st'>"m1"</span>),
                      <span class='kw'>m1</span> <span class='kw'>=</span> <span class='fu'><a href='mkinsub.html'>mkinsub</a></span>(<span class='st'>"SFO"</span>), <span class='kw'>use_of_ff</span> <span class='kw'>=</span> <span class='st'>"max"</span>)</div><div class='output co'>#&gt; <span class='message'>Successfully compiled differential equation model from auto-generated C code.</span></div><div class='input'><span class='no'>f.noweight</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='no'>SFO_SFO.ff</span>, <span class='no'>FOCUS_2006_D</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Observations with value of zero were removed from the data</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>f.noweight</span>)</div><div class='output co'>#&gt; mkin version used for fitting:    0.9.49.11 
#&gt; R version used for fitting:       4.0.0 
#&gt; Date of fit:     Thu May  7 08:59:03 2020 
#&gt; Date of summary: Thu May  7 08:59:03 2020 
#&gt; 
#&gt; Equations:
#&gt; d_parent/dt = - k_parent * parent
#&gt; d_m1/dt = + f_parent_to_m1 * k_parent * parent - k_m1 * m1
#&gt; 
#&gt; Model predictions using solution type deSolve 
#&gt; 
#&gt; Fitted using 422 model solutions performed in 1.106 s
#&gt; 
#&gt; Error model: Constant variance 
#&gt; 
#&gt; Error model algorithm: OLS 
#&gt; 
#&gt; Starting values for parameters to be optimised:
#&gt;                   value   type
#&gt; parent_0       100.7500  state
#&gt; k_parent         0.1000 deparm
#&gt; k_m1             0.1001 deparm
#&gt; f_parent_to_m1   0.5000 deparm
#&gt; 
#&gt; Starting values for the transformed parameters actually optimised:
#&gt;                     value lower upper
#&gt; parent_0       100.750000  -Inf   Inf
#&gt; log_k_parent    -2.302585  -Inf   Inf
#&gt; log_k_m1        -2.301586  -Inf   Inf
#&gt; f_parent_ilr_1   0.000000  -Inf   Inf
#&gt; 
#&gt; Fixed parameter values:
#&gt;      value  type
#&gt; m1_0     0 state
#&gt; 
#&gt; Optimised, transformed parameters with symmetric confidence intervals:
#&gt;                Estimate Std. Error    Lower    Upper
#&gt; parent_0       99.60000    1.57000 96.40000 102.8000
#&gt; log_k_parent   -2.31600    0.04087 -2.39900  -2.2330
#&gt; log_k_m1       -5.24800    0.13320 -5.51800  -4.9770
#&gt; f_parent_ilr_1  0.04096    0.06312 -0.08746   0.1694
#&gt; sigma           3.12600    0.35850  2.39600   3.8550
#&gt; 
#&gt; Parameter correlation:
#&gt;                  parent_0 log_k_parent   log_k_m1 f_parent_ilr_1      sigma
#&gt; parent_0        1.000e+00    5.174e-01 -1.688e-01     -5.471e-01 -2.443e-07
#&gt; log_k_parent    5.174e-01    1.000e+00 -3.263e-01     -5.426e-01  3.181e-07
#&gt; log_k_m1       -1.688e-01   -3.263e-01  1.000e+00      7.478e-01 -1.369e-07
#&gt; f_parent_ilr_1 -5.471e-01   -5.426e-01  7.478e-01      1.000e+00 -2.287e-08
#&gt; sigma          -2.443e-07    3.181e-07 -1.369e-07     -2.287e-08  1.000e+00
#&gt; 
#&gt; Backtransformed parameters:
#&gt; Confidence intervals for internally transformed parameters are asymmetric.
#&gt; t-test (unrealistically) based on the assumption of normal distribution
#&gt; for estimators of untransformed parameters.
#&gt;                 Estimate t value    Pr(&gt;t)     Lower     Upper
#&gt; parent_0       99.600000  63.430 2.298e-36 96.400000 1.028e+02
#&gt; k_parent        0.098700  24.470 4.955e-23  0.090820 1.073e-01
#&gt; k_m1            0.005261   7.510 6.165e-09  0.004012 6.898e-03
#&gt; f_parent_to_m1  0.514500  23.070 3.104e-22  0.469100 5.596e-01
#&gt; sigma           3.126000   8.718 2.235e-10  2.396000 3.855e+00
#&gt; 
#&gt; FOCUS Chi2 error levels in percent:
#&gt;          err.min n.optim df
#&gt; All data   6.398       4 15
#&gt; parent     6.459       2  7
#&gt; m1         4.690       2  8
#&gt; 
#&gt; Resulting formation fractions:
#&gt;                 ff
#&gt; parent_m1   0.5145
#&gt; parent_sink 0.4855
#&gt; 
#&gt; Estimated disappearance times:
#&gt;           DT50   DT90
#&gt; parent   7.023  23.33
#&gt; m1     131.761 437.70
#&gt; 
#&gt; Data:
#&gt;  time variable observed predicted   residual
#&gt;     0   parent    99.46  99.59848 -1.385e-01
#&gt;     0   parent   102.04  99.59848  2.442e+00
#&gt;     1   parent    93.50  90.23787  3.262e+00
#&gt;     1   parent    92.50  90.23787  2.262e+00
#&gt;     3   parent    63.23  74.07319 -1.084e+01
#&gt;     3   parent    68.99  74.07319 -5.083e+00
#&gt;     7   parent    52.32  49.91206  2.408e+00
#&gt;     7   parent    55.13  49.91206  5.218e+00
#&gt;    14   parent    27.27  25.01257  2.257e+00
#&gt;    14   parent    26.64  25.01257  1.627e+00
#&gt;    21   parent    11.50  12.53462 -1.035e+00
#&gt;    21   parent    11.64  12.53462 -8.946e-01
#&gt;    35   parent     2.85   3.14787 -2.979e-01
#&gt;    35   parent     2.91   3.14787 -2.379e-01
#&gt;    50   parent     0.69   0.71624 -2.624e-02
#&gt;    50   parent     0.63   0.71624 -8.624e-02
#&gt;    75   parent     0.05   0.06074 -1.074e-02
#&gt;    75   parent     0.06   0.06074 -7.381e-04
#&gt;     1       m1     4.84   4.80296  3.704e-02
#&gt;     1       m1     5.64   4.80296  8.370e-01
#&gt;     3       m1    12.91  13.02400 -1.140e-01
#&gt;     3       m1    12.96  13.02400 -6.400e-02
#&gt;     7       m1    22.97  25.04476 -2.075e+00
#&gt;     7       m1    24.47  25.04476 -5.748e-01
#&gt;    14       m1    41.69  36.69002  5.000e+00
#&gt;    14       m1    33.21  36.69002 -3.480e+00
#&gt;    21       m1    44.37  41.65310  2.717e+00
#&gt;    21       m1    46.44  41.65310  4.787e+00
#&gt;    35       m1    41.22  43.31312 -2.093e+00
#&gt;    35       m1    37.95  43.31312 -5.363e+00
#&gt;    50       m1    41.19  41.21831 -2.831e-02
#&gt;    50       m1    40.01  41.21831 -1.208e+00
#&gt;    75       m1    40.09  36.44703  3.643e+00
#&gt;    75       m1    33.85  36.44703 -2.597e+00
#&gt;   100       m1    31.04  31.98163 -9.416e-01
#&gt;   100       m1    33.13  31.98163  1.148e+00
#&gt;   120       m1    25.15  28.78984 -3.640e+00
#&gt;   120       m1    33.31  28.78984  4.520e+00</div><div class='input'><span class='no'>f.obs</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='no'>SFO_SFO.ff</span>, <span class='no'>FOCUS_2006_D</span>, <span class='kw'>error_model</span> <span class='kw'>=</span> <span class='st'>"obs"</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Observations with value of zero were removed from the data</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>f.obs</span>)</div><div class='output co'>#&gt; mkin version used for fitting:    0.9.49.11 
#&gt; R version used for fitting:       4.0.0 
#&gt; Date of fit:     Thu May  7 08:59:06 2020 
#&gt; Date of summary: Thu May  7 08:59:06 2020 
#&gt; 
#&gt; Equations:
#&gt; d_parent/dt = - k_parent * parent
#&gt; d_m1/dt = + f_parent_to_m1 * k_parent * parent - k_m1 * m1
#&gt; 
#&gt; Model predictions using solution type deSolve 
#&gt; 
#&gt; Fitted using 979 model solutions performed in 2.604 s
#&gt; 
#&gt; Error model: Variance unique to each observed variable 
#&gt; 
#&gt; Error model algorithm: d_3 
#&gt; Direct fitting and three-step fitting yield approximately the same likelihood 
#&gt; 
#&gt; Starting values for parameters to be optimised:
#&gt;                   value   type
#&gt; parent_0       100.7500  state
#&gt; k_parent         0.1000 deparm
#&gt; k_m1             0.1001 deparm
#&gt; f_parent_to_m1   0.5000 deparm
#&gt; sigma_parent     3.0000  error
#&gt; sigma_m1         3.0000  error
#&gt; 
#&gt; Starting values for the transformed parameters actually optimised:
#&gt;                     value lower upper
#&gt; parent_0       100.750000  -Inf   Inf
#&gt; log_k_parent    -2.302585  -Inf   Inf
#&gt; log_k_m1        -2.301586  -Inf   Inf
#&gt; f_parent_ilr_1   0.000000  -Inf   Inf
#&gt; sigma_parent     3.000000     0   Inf
#&gt; sigma_m1         3.000000     0   Inf
#&gt; 
#&gt; Fixed parameter values:
#&gt;      value  type
#&gt; m1_0     0 state
#&gt; 
#&gt; Optimised, transformed parameters with symmetric confidence intervals:
#&gt;                Estimate Std. Error    Lower    Upper
#&gt; parent_0       99.65000    1.70200 96.19000 103.1000
#&gt; log_k_parent   -2.31300    0.04376 -2.40200  -2.2240
#&gt; log_k_m1       -5.25000    0.12430 -5.50400  -4.9970
#&gt; f_parent_ilr_1  0.03861    0.06171 -0.08708   0.1643
#&gt; sigma_parent    3.40100    0.56820  2.24400   4.5590
#&gt; sigma_m1        2.85500    0.45240  1.93400   3.7770
#&gt; 
#&gt; Parameter correlation:
#&gt;                parent_0 log_k_parent log_k_m1 f_parent_ilr_1 sigma_parent
#&gt; parent_0        1.00000      0.51078 -0.19133       -0.59997     0.035670
#&gt; log_k_parent    0.51078      1.00000 -0.37458       -0.59239     0.069833
#&gt; log_k_m1       -0.19133     -0.37458  1.00000        0.74398    -0.026158
#&gt; f_parent_ilr_1 -0.59997     -0.59239  0.74398        1.00000    -0.041369
#&gt; sigma_parent    0.03567      0.06983 -0.02616       -0.04137     1.000000
#&gt; sigma_m1       -0.03385     -0.06627  0.02482        0.03926    -0.004628
#&gt;                 sigma_m1
#&gt; parent_0       -0.033847
#&gt; log_k_parent   -0.066265
#&gt; log_k_m1        0.024823
#&gt; f_parent_ilr_1  0.039256
#&gt; sigma_parent   -0.004628
#&gt; sigma_m1        1.000000
#&gt; 
#&gt; Backtransformed parameters:
#&gt; Confidence intervals for internally transformed parameters are asymmetric.
#&gt; t-test (unrealistically) based on the assumption of normal distribution
#&gt; for estimators of untransformed parameters.
#&gt;                 Estimate t value    Pr(&gt;t)     Lower     Upper
#&gt; parent_0       99.650000  58.560 2.004e-34 96.190000 1.031e+02
#&gt; k_parent        0.098970  22.850 1.099e-21  0.090530 1.082e-01
#&gt; k_m1            0.005245   8.046 1.732e-09  0.004072 6.756e-03
#&gt; f_parent_to_m1  0.513600  23.560 4.352e-22  0.469300 5.578e-01
#&gt; sigma_parent    3.401000   5.985 5.662e-07  2.244000 4.559e+00
#&gt; sigma_m1        2.855000   6.311 2.215e-07  1.934000 3.777e+00
#&gt; 
#&gt; FOCUS Chi2 error levels in percent:
#&gt;          err.min n.optim df
#&gt; All data   6.398       4 15
#&gt; parent     6.464       2  7
#&gt; m1         4.682       2  8
#&gt; 
#&gt; Resulting formation fractions:
#&gt;                 ff
#&gt; parent_m1   0.5136
#&gt; parent_sink 0.4864
#&gt; 
#&gt; Estimated disappearance times:
#&gt;           DT50   DT90
#&gt; parent   7.003  23.26
#&gt; m1     132.154 439.01
#&gt; 
#&gt; Data:
#&gt;  time variable observed predicted   residual
#&gt;     0   parent    99.46  99.65417 -1.942e-01
#&gt;     0   parent   102.04  99.65417  2.386e+00
#&gt;     1   parent    93.50  90.26332  3.237e+00
#&gt;     1   parent    92.50  90.26332  2.237e+00
#&gt;     3   parent    63.23  74.05306 -1.082e+01
#&gt;     3   parent    68.99  74.05306 -5.063e+00
#&gt;     7   parent    52.32  49.84325  2.477e+00
#&gt;     7   parent    55.13  49.84325  5.287e+00
#&gt;    14   parent    27.27  24.92971  2.340e+00
#&gt;    14   parent    26.64  24.92971  1.710e+00
#&gt;    21   parent    11.50  12.46890 -9.689e-01
#&gt;    21   parent    11.64  12.46890 -8.289e-01
#&gt;    35   parent     2.85   3.11925 -2.692e-01
#&gt;    35   parent     2.91   3.11925 -2.092e-01
#&gt;    50   parent     0.69   0.70679 -1.679e-02
#&gt;    50   parent     0.63   0.70679 -7.679e-02
#&gt;    75   parent     0.05   0.05952 -9.523e-03
#&gt;    75   parent     0.06   0.05952  4.772e-04
#&gt;     1       m1     4.84   4.81075  2.925e-02
#&gt;     1       m1     5.64   4.81075  8.292e-01
#&gt;     3       m1    12.91  13.04196 -1.320e-01
#&gt;     3       m1    12.96  13.04196 -8.196e-02
#&gt;     7       m1    22.97  25.06847 -2.098e+00
#&gt;     7       m1    24.47  25.06847 -5.985e-01
#&gt;    14       m1    41.69  36.70308  4.987e+00
#&gt;    14       m1    33.21  36.70308 -3.493e+00
#&gt;    21       m1    44.37  41.65115  2.719e+00
#&gt;    21       m1    46.44  41.65115  4.789e+00
#&gt;    35       m1    41.22  43.29465 -2.075e+00
#&gt;    35       m1    37.95  43.29465 -5.345e+00
#&gt;    50       m1    41.19  41.19948 -9.479e-03
#&gt;    50       m1    40.01  41.19948 -1.189e+00
#&gt;    75       m1    40.09  36.44035  3.650e+00
#&gt;    75       m1    33.85  36.44035 -2.590e+00
#&gt;   100       m1    31.04  31.98773 -9.477e-01
#&gt;   100       m1    33.13  31.98773  1.142e+00
#&gt;   120       m1    25.15  28.80429 -3.654e+00
#&gt;   120       m1    33.31  28.80429  4.506e+00</div><div class='input'><span class='no'>f.tc</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='no'>SFO_SFO.ff</span>, <span class='no'>FOCUS_2006_D</span>, <span class='kw'>error_model</span> <span class='kw'>=</span> <span class='st'>"tc"</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Observations with value of zero were removed from the data</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>f.tc</span>)</div><div class='output co'>#&gt; mkin version used for fitting:    0.9.49.11 
#&gt; R version used for fitting:       4.0.0 
#&gt; Date of fit:     Thu May  7 08:59:16 2020 
#&gt; Date of summary: Thu May  7 08:59:16 2020 
#&gt; 
#&gt; Equations:
#&gt; d_parent/dt = - k_parent * parent
#&gt; d_m1/dt = + f_parent_to_m1 * k_parent * parent - k_m1 * m1
#&gt; 
#&gt; Model predictions using solution type deSolve 
#&gt; 
#&gt; Fitted using 2552 model solutions performed in 10.544 s
#&gt; 
#&gt; Error model: Two-component variance function 
#&gt; 
#&gt; Error model algorithm: d_3 
#&gt; Three-step fitting yielded a higher likelihood than direct fitting 
#&gt; 
#&gt; Starting values for parameters to be optimised:
#&gt;                   value   type
#&gt; parent_0       100.7500  state
#&gt; k_parent         0.1000 deparm
#&gt; k_m1             0.1001 deparm
#&gt; f_parent_to_m1   0.5000 deparm
#&gt; sigma_low        0.1000  error
#&gt; rsd_high         0.1000  error
#&gt; 
#&gt; Starting values for the transformed parameters actually optimised:
#&gt;                     value lower upper
#&gt; parent_0       100.750000  -Inf   Inf
#&gt; log_k_parent    -2.302585  -Inf   Inf
#&gt; log_k_m1        -2.301586  -Inf   Inf
#&gt; f_parent_ilr_1   0.000000  -Inf   Inf
#&gt; sigma_low        0.100000     0   Inf
#&gt; rsd_high         0.100000     0   Inf
#&gt; 
#&gt; Fixed parameter values:
#&gt;      value  type
#&gt; m1_0     0 state
#&gt; 
#&gt; Optimised, transformed parameters with symmetric confidence intervals:
#&gt;                 Estimate Std. Error     Lower     Upper
#&gt; parent_0       100.70000   2.621000 95.400000 106.10000
#&gt; log_k_parent    -2.29700   0.008862 -2.315000  -2.27900
#&gt; log_k_m1        -5.26600   0.091310 -5.452000  -5.08000
#&gt; f_parent_ilr_1   0.02374   0.055300 -0.088900   0.13640
#&gt; sigma_low        0.00305   0.004829 -0.006786   0.01289
#&gt; rsd_high         0.07928   0.009418  0.060100   0.09847
#&gt; 
#&gt; Parameter correlation:
#&gt;                parent_0 log_k_parent log_k_m1 f_parent_ilr_1 sigma_low rsd_high
#&gt; parent_0        1.00000      0.67644 -0.10215       -0.76822   0.14294 -0.08783
#&gt; log_k_parent    0.67644      1.00000 -0.15102       -0.59491   0.34611 -0.08125
#&gt; log_k_m1       -0.10215     -0.15102  1.00000        0.51808  -0.05236  0.01240
#&gt; f_parent_ilr_1 -0.76822     -0.59491  0.51808        1.00000  -0.13900  0.03248
#&gt; sigma_low       0.14294      0.34611 -0.05236       -0.13900   1.00000 -0.16546
#&gt; rsd_high       -0.08783     -0.08125  0.01240        0.03248  -0.16546  1.00000
#&gt; 
#&gt; Backtransformed parameters:
#&gt; Confidence intervals for internally transformed parameters are asymmetric.
#&gt; t-test (unrealistically) based on the assumption of normal distribution
#&gt; for estimators of untransformed parameters.
#&gt;                 Estimate  t value    Pr(&gt;t)     Lower     Upper
#&gt; parent_0       1.007e+02  38.4300 1.180e-28 95.400000 1.061e+02
#&gt; k_parent       1.006e-01 112.8000 1.718e-43  0.098760 1.024e-01
#&gt; k_m1           5.167e-03  10.9500 1.171e-12  0.004290 6.223e-03
#&gt; f_parent_to_m1 5.084e-01  26.0100 2.146e-23  0.468600 5.481e-01
#&gt; sigma_low      3.050e-03   0.6314 2.661e-01 -0.006786 1.289e-02
#&gt; rsd_high       7.928e-02   8.4170 6.418e-10  0.060100 9.847e-02
#&gt; 
#&gt; FOCUS Chi2 error levels in percent:
#&gt;          err.min n.optim df
#&gt; All data   6.475       4 15
#&gt; parent     6.573       2  7
#&gt; m1         4.671       2  8
#&gt; 
#&gt; Resulting formation fractions:
#&gt;                 ff
#&gt; parent_m1   0.5084
#&gt; parent_sink 0.4916
#&gt; 
#&gt; Estimated disappearance times:
#&gt;           DT50  DT90
#&gt; parent   6.893  22.9
#&gt; m1     134.156 445.7
#&gt; 
#&gt; Data:
#&gt;  time variable observed predicted   residual
#&gt;     0   parent    99.46 100.73434  -1.274339
#&gt;     0   parent   102.04 100.73434   1.305661
#&gt;     1   parent    93.50  91.09751   2.402486
#&gt;     1   parent    92.50  91.09751   1.402486
#&gt;     3   parent    63.23  74.50141 -11.271410
#&gt;     3   parent    68.99  74.50141  -5.511410
#&gt;     7   parent    52.32  49.82880   2.491201
#&gt;     7   parent    55.13  49.82880   5.301201
#&gt;    14   parent    27.27  24.64809   2.621908
#&gt;    14   parent    26.64  24.64809   1.991908
#&gt;    21   parent    11.50  12.19232  -0.692315
#&gt;    21   parent    11.64  12.19232  -0.552315
#&gt;    35   parent     2.85   2.98327  -0.133266
#&gt;    35   parent     2.91   2.98327  -0.073266
#&gt;    50   parent     0.69   0.66013   0.029874
#&gt;    50   parent     0.63   0.66013  -0.030126
#&gt;    75   parent     0.05   0.05344  -0.003438
#&gt;    75   parent     0.06   0.05344   0.006562
#&gt;     1       m1     4.84   4.88645  -0.046451
#&gt;     1       m1     5.64   4.88645   0.753549
#&gt;     3       m1    12.91  13.22867  -0.318669
#&gt;     3       m1    12.96  13.22867  -0.268669
#&gt;     7       m1    22.97  25.36417  -2.394166
#&gt;     7       m1    24.47  25.36417  -0.894166
#&gt;    14       m1    41.69  37.00974   4.680263
#&gt;    14       m1    33.21  37.00974  -3.799737
#&gt;    21       m1    44.37  41.90133   2.468669
#&gt;    21       m1    46.44  41.90133   4.538669
#&gt;    35       m1    41.22  43.45691  -2.236913
#&gt;    35       m1    37.95  43.45691  -5.506913
#&gt;    50       m1    41.19  41.34199  -0.151985
#&gt;    50       m1    40.01  41.34199  -1.331985
#&gt;    75       m1    40.09  36.61471   3.475295
#&gt;    75       m1    33.85  36.61471  -2.764705
#&gt;   100       m1    31.04  32.20082  -1.160824
#&gt;   100       m1    33.13  32.20082   0.929176
#&gt;   120       m1    25.15  29.04130  -3.891304
#&gt;   120       m1    33.31  29.04130   4.268696</div><div class='input'># }


</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Johannes Ranke.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


