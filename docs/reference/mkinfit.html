<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit a kinetic model to data with one or more state variables — mkinfit • mkin</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Fit a kinetic model to data with one or more state variables — mkinfit" />

<meta property="og:description" content="This function maximises the likelihood of the observed data using
  the Port algorithm nlminb, and the specified initial or fixed
  parameters and starting values.  In each step of the optimsation, the kinetic
  model is solved using the function mkinpredict. The parameters
  of the selected error model are fitted simultaneously with the degradation
  model parameters, as both of them are arguments of the likelihood function.
Per default, parameters in the kinetic models are internally transformed in
  order to better satisfy the assumption of a normal distribution of their
  estimators." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mkin</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.49.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Functions and data</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/mkin.html">Introduction to mkin</a>
    </li>
    <li>
      <a href="../articles/FOCUS_D.html">Example evaluation of FOCUS Example Dataset D</a>
    </li>
    <li>
      <a href="../articles/FOCUS_L.html">Example evaluation of FOCUS Laboratory Data L1 to L3</a>
    </li>
    <li>
      <a href="../articles/web_only/FOCUS_Z.html">Example evaluation of FOCUS Example Dataset Z</a>
    </li>
    <li>
      <a href="../articles/web_only/compiled_models.html">Performance benefit by using compiled model definitions in mkin</a>
    </li>
    <li>
      <a href="../articles/twa.html">Calculation of time weighted average concentrations with mkin</a>
    </li>
    <li>
      <a href="../articles/web_only/NAFTA_examples.html">Example evaluation of NAFTA SOP Attachment examples</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a kinetic model to data with one or more state variables</h1>
    
    <div class="hidden name"><code>mkinfit.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function maximises the likelihood of the observed data using
  the Port algorithm <code><a href='https://www.rdocumentation.org/packages/stats/topics/nlminb'>nlminb</a></code>, and the specified initial or fixed
  parameters and starting values.  In each step of the optimsation, the kinetic
  model is solved using the function <code><a href='mkinpredict.html'>mkinpredict</a></code>. The parameters
  of the selected error model are fitted simultaneously with the degradation
  model parameters, as both of them are arguments of the likelihood function.</p>
<p>Per default, parameters in the kinetic models are internally transformed in
  order to better satisfy the assumption of a normal distribution of their
  estimators.</p>
    
    </div>

    <pre class="usage"><span class='fu'>mkinfit</span>(<span class='no'>mkinmod</span>, <span class='no'>observed</span>,
  <span class='kw'>parms.ini</span> <span class='kw'>=</span> <span class='st'>"auto"</span>,
  <span class='kw'>state.ini</span> <span class='kw'>=</span> <span class='st'>"auto"</span>,
  <span class='kw'>err.ini</span> <span class='kw'>=</span> <span class='st'>"auto"</span>,
  <span class='kw'>fixed_parms</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>fixed_initials</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/names'>names</a></span>(<span class='no'>mkinmod</span>$<span class='no'>diffs</span>)[-<span class='fl'>1</span>],
  <span class='kw'>from_max_mean</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>solution_type</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"auto"</span>, <span class='st'>"analytical"</span>, <span class='st'>"eigen"</span>, <span class='st'>"deSolve"</span>),
  <span class='kw'>method.ode</span> <span class='kw'>=</span> <span class='st'>"lsoda"</span>,
  <span class='kw'>use_compiled</span> <span class='kw'>=</span> <span class='st'>"auto"</span>,
  <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>eval.max</span> <span class='kw'>=</span> <span class='fl'>300</span>, <span class='kw'>iter.max</span> <span class='kw'>=</span> <span class='fl'>200</span>),
  <span class='kw'>transform_rates</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>transform_fractions</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>atol</span> <span class='kw'>=</span> <span class='fl'>1e-8</span>, <span class='kw'>rtol</span> <span class='kw'>=</span> <span class='fl'>1e-10</span>, <span class='kw'>n.outtimes</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>error_model</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"const"</span>, <span class='st'>"obs"</span>, <span class='st'>"tc"</span>),
  <span class='kw'>trace_parms</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mkinmod</th>
      <td><p>A list of class <code><a href='mkinmod.html'>mkinmod</a></code>, containing the kinetic model to be
    fitted to the data, or one of the shorthand names ("SFO", "FOMC", "DFOP",
    "HS", "SFORB", "IORE"). If a shorthand name is given, a parent only degradation
    model is generated for the variable with the highest value in
    <code>observed</code>.</p></td>
    </tr>
    <tr>
      <th>observed</th>
      <td><p>A dataframe with the observed data.  The first column called "name" must
    contain the name of the observed variable for each data point. The second
    column must contain the times of observation, named "time".  The third
    column must be named "value" and contain the observed values. Zero values
    in the "value" column will be removed, with a warning, in order to
    avoid problems with fitting the two-component error model. This is not
    expected to be a problem, because in general, values of zero are not
    observed in degradation data, because there is a lower limit of detection.</p></td>
    </tr>
    <tr>
      <th>parms.ini</th>
      <td><p>A named vector of initial values for the parameters, including parameters
    to be optimised and potentially also fixed parameters as indicated by
    <code>fixed_parms</code>.  If set to "auto", initial values for rate constants
    are set to default values.  Using parameter names that are not in the model
    gives an error.</p>
<p>It is possible to only specify a subset of the parameters that the model
    needs. You can use the parameter lists "bparms.ode" from a previously
    fitted model, which contains the differential equation parameters from this
    model. This works nicely if the models are nested. An example is given
    below.</p></td>
    </tr>
    <tr>
      <th>state.ini</th>
      <td><p>A named vector of initial values for the state variables of the model. In
    case the observed variables are represented by more than one model
    variable, the names will differ from the names of the observed variables
    (see <code>map</code> component of <code><a href='mkinmod.html'>mkinmod</a></code>). The default is to set
    the initial value of the first model variable to the mean of the time zero
    values for the variable with the maximum observed value, and all others to 0.
    If this variable has no time zero observations, its initial value is set to 100.</p></td>
    </tr>
    <tr>
      <th>err.ini</th>
      <td><p>A named vector of initial values for the error model parameters to be
    optimised.  If set to "auto", initial values are set to default values.
    Otherwise, inital values for all error model parameters must be
    given.</p></td>
    </tr>
    <tr>
      <th>fixed_parms</th>
      <td><p>The names of parameters that should not be optimised but rather kept at the
    values specified in <code>parms.ini</code>.</p></td>
    </tr>
    <tr>
      <th>fixed_initials</th>
      <td><p>The names of model variables for which the initial state at time 0 should
    be excluded from the optimisation. Defaults to all state variables except
    for the first one.</p></td>
    </tr>
    <tr>
      <th>from_max_mean</th>
      <td><p>If this is set to TRUE, and the model has only one observed variable, then
    data before the time of the maximum observed value (after averaging for each
    sampling time) are discarded, and this time is subtracted from all
    remaining time values, so the time of the maximum observed mean value is
    the new time zero.</p></td>
    </tr>
    <tr>
      <th>solution_type</th>
      <td><p>If set to "eigen", the solution of the system of differential equations is
    based on the spectral decomposition of the coefficient matrix in cases that
    this is possible. If set to "deSolve", a numerical ode solver from package
    <code>deSolve</code> is used. If set to "analytical", an analytical
    solution of the model is used. This is only implemented for simple
    degradation experiments with only one state variable, i.e. with no
    metabolites. The default is "auto", which uses "analytical" if possible,
    otherwise "deSolve" if a compiler is present, and "eigen" if no
    compiler is present and the model can be expressed using eigenvalues and
    eigenvectors.  This argument is passed on to the helper function
    <code><a href='mkinpredict.html'>mkinpredict</a></code>.</p></td>
    </tr>
    <tr>
      <th>method.ode</th>
      <td><p>The solution method passed via <code><a href='mkinpredict.html'>mkinpredict</a></code> to
    <code>ode</code> in case the solution type is "deSolve". The default
    "lsoda" is performant, but sometimes fails to converge.</p></td>
    </tr>
    <tr>
      <th>use_compiled</th>
      <td><p>If set to <code>FALSE</code>, no compiled version of the <code><a href='mkinmod.html'>mkinmod</a></code>
    model is used in the calls to <code><a href='mkinpredict.html'>mkinpredict</a></code> even if a compiled
    version is present.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>A list of control arguments passed to <code><a href='https://www.rdocumentation.org/packages/stats/topics/nlminb'>nlminb</a></code>.</p></td>
    </tr>
    <tr>
      <th>transform_rates</th>
      <td><p>Boolean specifying if kinetic rate constants should be transformed in the
    model specification used in the fitting for better compliance with the
    assumption of normal distribution of the estimator. If TRUE, also
    alpha and beta parameters of the FOMC model are log-transformed, as well
    as k1 and k2 rate constants for the DFOP and HS models and the break point
    tb of the HS model.  If FALSE, zero is used as a lower bound for the rates
    in the optimisation.</p></td>
    </tr>
    <tr>
      <th>transform_fractions</th>
      <td><p>Boolean specifying if formation fractions constants should be transformed in the
    model specification used in the fitting for better compliance with the
    assumption of normal distribution of the estimator. The default (TRUE) is
    to do transformations. If TRUE, the g parameter of the DFOP and HS
    models are also transformed, as they can also be seen as compositional
    data. The transformation used for these transformations is the
    <code><a href='ilr.html'>ilr</a></code> transformation.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>Suppress printing out the current value of the negative log-likelihood
    after each improvement?</p></td>
    </tr>
    <tr>
      <th>atol</th>
      <td><p>Absolute error tolerance, passed to <code>ode</code>. Default is 1e-8,
    lower than in <code>lsoda</code>.</p></td>
    </tr>
    <tr>
      <th>rtol</th>
      <td><p>Absolute error tolerance, passed to <code>ode</code>. Default is 1e-10,
    much lower than in <code>lsoda</code>.</p></td>
    </tr>
    <tr>
      <th>n.outtimes</th>
      <td><p>The length of the dataseries that is produced by the model prediction
    function <code><a href='mkinpredict.html'>mkinpredict</a></code>. This impacts the accuracy of
    the numerical solver if that is used (see <code>solution_type</code> argument.
    The default value is 100.</p></td>
    </tr>
    <tr>
      <th>error_model</th>
      <td><p>If the error model is "const", a constant standard deviation
    is assumed.</p>
<p>If the error model is "obs", each observed variable is assumed to have its
    own variance.</p>
<p>If the error model is "tc" (two-component error model), a two component
    error model similar to the one described by Rocke and Lorenzato (1995) is
    used for setting up the likelihood function.  Note that this model deviates
    from the model by Rocke and Lorenzato, as their model implies that the
    errors follow a lognormal distribution for large values, not a normal
    distribution as assumed by this method.</p></td>
    </tr>
    <tr>
      <th>trace_parms</th>
      <td><p>Should a trace of the parameter values be listed?</p></td>
    </tr>
    <tr>
      <th>&#8230;</th>
      <td><p>Further arguments that will be passed on to <code>deSolve</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with "mkinfit" in the class attribute.  A summary can be obtained by
  <code><a href='summary.mkinfit.html'>summary.mkinfit</a></code>.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Plotting methods <code><a href='plot.mkinfit.html'>plot.mkinfit</a></code> and <code><a href='mkinparplot.html'>mkinparplot</a></code>.</p>
<p>Comparisons of models fitted to the same data can be made using <code><a href='https://www.rdocumentation.org/packages/stats/topics/AIC'>AIC</a></code>
  by virtue of the method <code><a href='logLik.mkinfit.html'>logLik.mkinfit</a></code>.</p>
<p>Fitting of several models to several datasets in a single call to
  <code><a href='mmkin.html'>mmkin</a></code>.</p></div>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>When using the "IORE" submodel for metabolites, fitting with
  "transform_rates = TRUE" (the default) often leads to failures of the
  numerical ODE solver. In this situation it may help to switch off the
  internal rate transformation.</p>
    
    <h2 class="hasAnchor" id="source"><a class="anchor" href="#source"></a>Source</h2>

    <p>Rocke, David M. und Lorenzato, Stefan (1995) A two-component model for
  measurement error in analytical chemistry. Technometrics 37(2), 176-184.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Use shorthand notation for parent only degradation</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='st'>"FOMC"</span>, <span class='no'>FOCUS_2006_C</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt; mkin version used for fitting:    0.9.49.4 
#&gt; R version used for fitting:       3.6.0 
#&gt; Date of fit:     Fri May  3 19:07:19 2019 
#&gt; Date of summary: Fri May  3 19:07:19 2019 
#&gt; 
#&gt; Equations:
#&gt; d_parent/dt = - (alpha/beta) * 1/((time/beta) + 1) * parent
#&gt; 
#&gt; Model predictions using solution type analytical 
#&gt; 
#&gt; Fitted using 222 model solutions performed in 0.463 s
#&gt; 
#&gt; Error model:
#&gt; Constant variance 
#&gt; 
#&gt; Starting values for parameters to be optimised:
#&gt;              value   type
#&gt; parent_0 85.100000  state
#&gt; alpha     1.000000 deparm
#&gt; beta     10.000000 deparm
#&gt; sigma     1.857444  error
#&gt; 
#&gt; Starting values for the transformed parameters actually optimised:
#&gt;               value lower upper
#&gt; parent_0  85.100000  -Inf   Inf
#&gt; log_alpha  0.000000  -Inf   Inf
#&gt; log_beta   2.302585  -Inf   Inf
#&gt; sigma      1.857444     0   Inf
#&gt; 
#&gt; Fixed parameter values:
#&gt; None
#&gt; 
#&gt; Optimised, transformed parameters with symmetric confidence intervals:
#&gt;           Estimate Std. Error    Lower   Upper
#&gt; parent_0  85.87000     1.8070 81.23000 90.5200
#&gt; log_alpha  0.05192     0.1353 -0.29580  0.3996
#&gt; log_beta   0.65100     0.2287  0.06315  1.2390
#&gt; sigma      1.85700     0.4378  0.73200  2.9830
#&gt; 
#&gt; Parameter correlation:
#&gt;             parent_0  log_alpha   log_beta     sigma
#&gt; parent_0   1.000e+00 -1.565e-01 -3.142e-01 4.770e-08
#&gt; log_alpha -1.565e-01  1.000e+00  9.564e-01 9.974e-08
#&gt; log_beta  -3.142e-01  9.564e-01  1.000e+00 8.468e-08
#&gt; sigma      4.770e-08  9.974e-08  8.468e-08 1.000e+00
#&gt; 
#&gt; Backtransformed parameters:
#&gt; Confidence intervals for internally transformed parameters are asymmetric.
#&gt; t-test (unrealistically) based on the assumption of normal distribution
#&gt; for estimators of untransformed parameters.
#&gt;          Estimate t value    Pr(&gt;t)   Lower  Upper
#&gt; parent_0   85.870  47.530 3.893e-08 81.2300 90.520
#&gt; alpha       1.053   7.393 3.562e-04  0.7439  1.491
#&gt; beta        1.917   4.373 3.601e-03  1.0650  3.451
#&gt; sigma       1.857   4.243 4.074e-03  0.7320  2.983
#&gt; 
#&gt; FOCUS Chi2 error levels in percent:
#&gt;          err.min n.optim df
#&gt; All data   6.657       3  6
#&gt; parent     6.657       3  6
#&gt; 
#&gt; Estimated disappearance times:
#&gt;         DT50  DT90 DT50back
#&gt; parent 1.785 15.15     4.56
#&gt; 
#&gt; Data:
#&gt;  time variable observed predicted residual
#&gt;     0   parent     85.1    85.875  -0.7749
#&gt;     1   parent     57.9    55.191   2.7091
#&gt;     3   parent     29.9    31.845  -1.9452
#&gt;     7   parent     14.6    17.012  -2.4124
#&gt;    14   parent      9.7     9.241   0.4590
#&gt;    28   parent      6.6     4.754   1.8460
#&gt;    63   parent      4.0     2.102   1.8977
#&gt;    91   parent      3.9     1.441   2.4590
#&gt;   119   parent      0.6     1.092  -0.4919</div><div class='input'>
<span class='co'># One parent compound, one metabolite, both single first order.</span>
<span class='co'># Use mkinsub for convenience in model formulation. Pathway to sink included per default.</span>
<span class='no'>SFO_SFO</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mkinmod.html'>mkinmod</a></span>(
  <span class='kw'>parent</span> <span class='kw'>=</span> <span class='fu'><a href='mkinsub.html'>mkinsub</a></span>(<span class='st'>"SFO"</span>, <span class='st'>"m1"</span>),
  <span class='kw'>m1</span> <span class='kw'>=</span> <span class='fu'><a href='mkinsub.html'>mkinsub</a></span>(<span class='st'>"SFO"</span>))</div><div class='output co'>#&gt; <span class='message'>Successfully compiled differential equation model from auto-generated C code.</span></div><div class='input'><span class='co'># Fit the model to the FOCUS example dataset D using defaults</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.time'>system.time</a></span>(<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='no'>SFO_SFO</span>, <span class='no'>FOCUS_2006_D</span>,
                           <span class='kw'>solution_type</span> <span class='kw'>=</span> <span class='st'>"eigen"</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)))</div><div class='output co'>#&gt; <span class='warning'>Warning: Observations with value of zero were removed from the data</span></div><div class='output co'>#&gt;        User      System verstrichen 
#&gt;       1.493       0.000       1.494 </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/coef'>coef</a></span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt; NULL</div><div class='input'><span class='fu'><a href='endpoints.html'>endpoints</a></span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt; $ff
#&gt; parent_sink   parent_m1     m1_sink 
#&gt;    0.485524    0.514476    1.000000 
#&gt; 
#&gt; $SFORB
#&gt; logical(0)
#&gt; 
#&gt; $distimes
#&gt;              DT50      DT90
#&gt; parent   7.022929  23.32967
#&gt; m1     131.760712 437.69961
#&gt; </div><div class='input'><span class='co'># deSolve is slower when no C compiler (gcc) was available during model generation</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/print'>print</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.time'>system.time</a></span>(<span class='no'>fit.deSolve</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='no'>SFO_SFO</span>, <span class='no'>FOCUS_2006_D</span>,
                           <span class='kw'>solution_type</span> <span class='kw'>=</span> <span class='st'>"deSolve"</span>)))</div><div class='output co'>#&gt; <span class='warning'>Warning: Observations with value of zero were removed from the data</span></div><div class='output co'>#&gt; <span class='message'>Ordinary least squares optimisation</span></div><div class='output co'>#&gt; Sum of squared residuals at call 1: 18915.53
#&gt; Sum of squared residuals at call 2: 18915.53
#&gt; Sum of squared residuals at call 6: 11424.02
#&gt; Sum of squared residuals at call 10: 11424
#&gt; Sum of squared residuals at call 12: 4094.396
#&gt; Sum of squared residuals at call 16: 4094.396
#&gt; Sum of squared residuals at call 19: 1340.595
#&gt; Sum of squared residuals at call 20: 1340.593
#&gt; Sum of squared residuals at call 25: 1072.239
#&gt; Sum of squared residuals at call 28: 1072.236
#&gt; Sum of squared residuals at call 30: 874.2615
#&gt; Sum of squared residuals at call 33: 874.2611
#&gt; Sum of squared residuals at call 35: 616.2375
#&gt; Sum of squared residuals at call 37: 616.237
#&gt; Sum of squared residuals at call 40: 467.4386
#&gt; Sum of squared residuals at call 42: 467.438
#&gt; Sum of squared residuals at call 46: 398.2913
#&gt; Sum of squared residuals at call 48: 398.2913
#&gt; Sum of squared residuals at call 49: 398.2912
#&gt; Sum of squared residuals at call 51: 395.0711
#&gt; Sum of squared residuals at call 54: 395.071
#&gt; Sum of squared residuals at call 56: 378.3298
#&gt; Sum of squared residuals at call 59: 378.3298
#&gt; Sum of squared residuals at call 62: 376.9812
#&gt; Sum of squared residuals at call 64: 376.9811
#&gt; Sum of squared residuals at call 67: 375.2085
#&gt; Sum of squared residuals at call 69: 375.2085
#&gt; Sum of squared residuals at call 70: 375.2085
#&gt; Sum of squared residuals at call 71: 375.2085
#&gt; Sum of squared residuals at call 72: 374.5723
#&gt; Sum of squared residuals at call 74: 374.5723
#&gt; Sum of squared residuals at call 77: 374.0075
#&gt; Sum of squared residuals at call 79: 374.0075
#&gt; Sum of squared residuals at call 80: 374.0075
#&gt; Sum of squared residuals at call 82: 373.1711
#&gt; Sum of squared residuals at call 84: 373.1711
#&gt; Sum of squared residuals at call 87: 372.6445
#&gt; Sum of squared residuals at call 88: 372.1615
#&gt; Sum of squared residuals at call 90: 372.1615
#&gt; Sum of squared residuals at call 91: 372.1615
#&gt; Sum of squared residuals at call 94: 371.6464
#&gt; Sum of squared residuals at call 99: 371.4299
#&gt; Sum of squared residuals at call 101: 371.4299
#&gt; Sum of squared residuals at call 104: 371.4071
#&gt; Sum of squared residuals at call 106: 371.4071
#&gt; Sum of squared residuals at call 107: 371.4071
#&gt; Sum of squared residuals at call 109: 371.2524
#&gt; Sum of squared residuals at call 113: 371.2524
#&gt; Sum of squared residuals at call 114: 371.2136
#&gt; Sum of squared residuals at call 115: 371.2136
#&gt; Sum of squared residuals at call 116: 371.2136
#&gt; Sum of squared residuals at call 119: 371.2134
#&gt; Sum of squared residuals at call 120: 371.2134
#&gt; Sum of squared residuals at call 122: 371.2134
#&gt; Sum of squared residuals at call 123: 371.2134
#&gt; Sum of squared residuals at call 125: 371.2134
#&gt; Sum of squared residuals at call 126: 371.2134
#&gt; Sum of squared residuals at call 135: 371.2134
#&gt; Negative log-likelihood at call 145: 97.22429
#&gt; Optimisation successfully terminated.
#&gt;        User      System verstrichen 
#&gt;       1.082       0.000       1.083 </div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/coef'>coef</a></span>(<span class='no'>fit.deSolve</span>)</div><div class='output co'>#&gt; NULL</div><div class='input'><span class='fu'><a href='endpoints.html'>endpoints</a></span>(<span class='no'>fit.deSolve</span>)</div><div class='output co'>#&gt; $ff
#&gt; parent_sink   parent_m1     m1_sink 
#&gt;    0.485524    0.514476    1.000000 
#&gt; 
#&gt; $SFORB
#&gt; logical(0)
#&gt; 
#&gt; $distimes
#&gt;              DT50      DT90
#&gt; parent   7.022929  23.32967
#&gt; m1     131.760712 437.69961
#&gt; </div><div class='input'>
# Use stepwise fitting, using optimised parameters from parent only fit, FOMC
</div><div class='input'><span class='no'>FOMC_SFO</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mkinmod.html'>mkinmod</a></span>(
  <span class='kw'>parent</span> <span class='kw'>=</span> <span class='fu'><a href='mkinsub.html'>mkinsub</a></span>(<span class='st'>"FOMC"</span>, <span class='st'>"m1"</span>),
  <span class='kw'>m1</span> <span class='kw'>=</span> <span class='fu'><a href='mkinsub.html'>mkinsub</a></span>(<span class='st'>"SFO"</span>))</div><div class='output co'>#&gt; <span class='message'>Successfully compiled differential equation model from auto-generated C code.</span></div><div class='input'><span class='co'># Fit the model to the FOCUS example dataset D using defaults</span>
<span class='no'>fit.FOMC_SFO</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='no'>FOMC_SFO</span>, <span class='no'>FOCUS_2006_D</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Observations with value of zero were removed from the data</span></div><div class='input'><span class='co'># Use starting parameters from parent only FOMC fit</span>
<span class='no'>fit.FOMC</span> <span class='kw'>=</span> <span class='fu'>mkinfit</span>(<span class='st'>"FOMC"</span>, <span class='no'>FOCUS_2006_D</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>fit.FOMC_SFO</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='no'>FOMC_SFO</span>, <span class='no'>FOCUS_2006_D</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>parms.ini</span> <span class='kw'>=</span> <span class='no'>fit.FOMC</span>$<span class='no'>bparms.ode</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Observations with value of zero were removed from the data</span></div><div class='input'>
<span class='co'># Use stepwise fitting, using optimised parameters from parent only fit, SFORB</span>
<span class='no'>SFORB_SFO</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mkinmod.html'>mkinmod</a></span>(
  <span class='kw'>parent</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"SFORB"</span>, <span class='kw'>to</span> <span class='kw'>=</span> <span class='st'>"m1"</span>, <span class='kw'>sink</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>),
  <span class='kw'>m1</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"SFO"</span>))</div><div class='output co'>#&gt; <span class='message'>Successfully compiled differential equation model from auto-generated C code.</span></div><div class='input'><span class='co'># Fit the model to the FOCUS example dataset D using defaults</span>
<span class='no'>fit.SFORB_SFO</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='no'>SFORB_SFO</span>, <span class='no'>FOCUS_2006_D</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Observations with value of zero were removed from the data</span></div><div class='input'><span class='no'>fit.SFORB_SFO.deSolve</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='no'>SFORB_SFO</span>, <span class='no'>FOCUS_2006_D</span>, <span class='kw'>solution_type</span> <span class='kw'>=</span> <span class='st'>"deSolve"</span>,
                                 <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Observations with value of zero were removed from the data</span></div><div class='input'><span class='co'># Use starting parameters from parent only SFORB fit (not really needed in this case)</span>
<span class='no'>fit.SFORB</span> <span class='kw'>=</span> <span class='fu'>mkinfit</span>(<span class='st'>"SFORB"</span>, <span class='no'>FOCUS_2006_D</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>fit.SFORB_SFO</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='no'>SFORB_SFO</span>, <span class='no'>FOCUS_2006_D</span>, <span class='kw'>parms.ini</span> <span class='kw'>=</span> <span class='no'>fit.SFORB</span>$<span class='no'>bparms.ode</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Observations with value of zero were removed from the data</span></div><div class='input'>
</div><div class='input'><span class='co'># Weighted fits, including IRLS</span>
<span class='no'>SFO_SFO.ff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mkinmod.html'>mkinmod</a></span>(<span class='kw'>parent</span> <span class='kw'>=</span> <span class='fu'><a href='mkinsub.html'>mkinsub</a></span>(<span class='st'>"SFO"</span>, <span class='st'>"m1"</span>),
                      <span class='kw'>m1</span> <span class='kw'>=</span> <span class='fu'><a href='mkinsub.html'>mkinsub</a></span>(<span class='st'>"SFO"</span>), <span class='kw'>use_of_ff</span> <span class='kw'>=</span> <span class='st'>"max"</span>)</div><div class='output co'>#&gt; <span class='message'>Successfully compiled differential equation model from auto-generated C code.</span></div><div class='input'><span class='no'>f.noweight</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='no'>SFO_SFO.ff</span>, <span class='no'>FOCUS_2006_D</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Observations with value of zero were removed from the data</span></div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>f.noweight</span>)</div><div class='output co'>#&gt; mkin version used for fitting:    0.9.49.4 
#&gt; R version used for fitting:       3.6.0 
#&gt; Date of fit:     Fri May  3 19:07:35 2019 
#&gt; Date of summary: Fri May  3 19:07:35 2019 
#&gt; 
#&gt; Equations:
#&gt; d_parent/dt = - k_parent * parent
#&gt; d_m1/dt = + f_parent_to_m1 * k_parent * parent - k_m1 * m1
#&gt; 
#&gt; Model predictions using solution type deSolve 
#&gt; 
#&gt; Fitted using 421 model solutions performed in 1.099 s
#&gt; 
#&gt; Error model:
#&gt; Constant variance 
#&gt; 
#&gt; Starting values for parameters to be optimised:
#&gt;                     value   type
#&gt; parent_0       100.750000  state
#&gt; k_parent         0.100000 deparm
#&gt; k_m1             0.100100 deparm
#&gt; f_parent_to_m1   0.500000 deparm
#&gt; sigma            3.125504  error
#&gt; 
#&gt; Starting values for the transformed parameters actually optimised:
#&gt;                     value lower upper
#&gt; parent_0       100.750000  -Inf   Inf
#&gt; log_k_parent    -2.302585  -Inf   Inf
#&gt; log_k_m1        -2.301586  -Inf   Inf
#&gt; f_parent_ilr_1   0.000000  -Inf   Inf
#&gt; sigma            3.125504     0   Inf
#&gt; 
#&gt; Fixed parameter values:
#&gt;      value  type
#&gt; m1_0     0 state
#&gt; 
#&gt; Optimised, transformed parameters with symmetric confidence intervals:
#&gt;                Estimate Std. Error    Lower    Upper
#&gt; parent_0       99.60000    1.57000 96.40000 102.8000
#&gt; log_k_parent   -2.31600    0.04087 -2.39900  -2.2330
#&gt; log_k_m1       -5.24800    0.13320 -5.51800  -4.9770
#&gt; f_parent_ilr_1  0.04096    0.06312 -0.08746   0.1694
#&gt; sigma           3.12600    0.35850  2.39600   3.8550
#&gt; 
#&gt; Parameter correlation:
#&gt;                  parent_0 log_k_parent   log_k_m1 f_parent_ilr_1      sigma
#&gt; parent_0        1.000e+00    5.174e-01 -1.688e-01     -5.471e-01 -2.265e-07
#&gt; log_k_parent    5.174e-01    1.000e+00 -3.263e-01     -5.426e-01  3.785e-07
#&gt; log_k_m1       -1.688e-01   -3.263e-01  1.000e+00      7.478e-01 -1.386e-07
#&gt; f_parent_ilr_1 -5.471e-01   -5.426e-01  7.478e-01      1.000e+00 -3.641e-08
#&gt; sigma          -2.265e-07    3.785e-07 -1.386e-07     -3.641e-08  1.000e+00
#&gt; 
#&gt; Backtransformed parameters:
#&gt; Confidence intervals for internally transformed parameters are asymmetric.
#&gt; t-test (unrealistically) based on the assumption of normal distribution
#&gt; for estimators of untransformed parameters.
#&gt;                 Estimate t value    Pr(&gt;t)     Lower     Upper
#&gt; parent_0       99.600000  63.430 2.298e-36 96.400000 1.028e+02
#&gt; k_parent        0.098700  24.470 4.955e-23  0.090820 1.073e-01
#&gt; k_m1            0.005261   7.510 6.165e-09  0.004012 6.898e-03
#&gt; f_parent_to_m1  0.514500  23.070 3.104e-22  0.469100 5.596e-01
#&gt; sigma           3.126000   8.718 2.235e-10  2.396000 3.855e+00
#&gt; 
#&gt; FOCUS Chi2 error levels in percent:
#&gt;          err.min n.optim df
#&gt; All data   6.398       4 15
#&gt; parent     6.459       2  7
#&gt; m1         4.690       2  8
#&gt; 
#&gt; Resulting formation fractions:
#&gt;                 ff
#&gt; parent_m1   0.5145
#&gt; parent_sink 0.4855
#&gt; 
#&gt; Estimated disappearance times:
#&gt;           DT50   DT90
#&gt; parent   7.023  23.33
#&gt; m1     131.761 437.70
#&gt; 
#&gt; Data:
#&gt;  time variable observed predicted   residual
#&gt;     0   parent    99.46  99.59848 -1.385e-01
#&gt;     0   parent   102.04  99.59848  2.442e+00
#&gt;     1   parent    93.50  90.23787  3.262e+00
#&gt;     1   parent    92.50  90.23787  2.262e+00
#&gt;     3   parent    63.23  74.07319 -1.084e+01
#&gt;     3   parent    68.99  74.07319 -5.083e+00
#&gt;     7   parent    52.32  49.91206  2.408e+00
#&gt;     7   parent    55.13  49.91206  5.218e+00
#&gt;    14   parent    27.27  25.01257  2.257e+00
#&gt;    14   parent    26.64  25.01257  1.627e+00
#&gt;    21   parent    11.50  12.53462 -1.035e+00
#&gt;    21   parent    11.64  12.53462 -8.946e-01
#&gt;    35   parent     2.85   3.14787 -2.979e-01
#&gt;    35   parent     2.91   3.14787 -2.379e-01
#&gt;    50   parent     0.69   0.71624 -2.624e-02
#&gt;    50   parent     0.63   0.71624 -8.624e-02
#&gt;    75   parent     0.05   0.06074 -1.074e-02
#&gt;    75   parent     0.06   0.06074 -7.381e-04
#&gt;     1       m1     4.84   4.80296  3.704e-02
#&gt;     1       m1     5.64   4.80296  8.370e-01
#&gt;     3       m1    12.91  13.02400 -1.140e-01
#&gt;     3       m1    12.96  13.02400 -6.400e-02
#&gt;     7       m1    22.97  25.04476 -2.075e+00
#&gt;     7       m1    24.47  25.04476 -5.748e-01
#&gt;    14       m1    41.69  36.69002  5.000e+00
#&gt;    14       m1    33.21  36.69002 -3.480e+00
#&gt;    21       m1    44.37  41.65310  2.717e+00
#&gt;    21       m1    46.44  41.65310  4.787e+00
#&gt;    35       m1    41.22  43.31312 -2.093e+00
#&gt;    35       m1    37.95  43.31312 -5.363e+00
#&gt;    50       m1    41.19  41.21831 -2.831e-02
#&gt;    50       m1    40.01  41.21831 -1.208e+00
#&gt;    75       m1    40.09  36.44703  3.643e+00
#&gt;    75       m1    33.85  36.44703 -2.597e+00
#&gt;   100       m1    31.04  31.98163 -9.416e-01
#&gt;   100       m1    33.13  31.98163  1.148e+00
#&gt;   120       m1    25.15  28.78984 -3.640e+00
#&gt;   120       m1    33.31  28.78984  4.520e+00</div><div class='input'><span class='no'>f.obs</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='no'>SFO_SFO.ff</span>, <span class='no'>FOCUS_2006_D</span>, <span class='kw'>error_model</span> <span class='kw'>=</span> <span class='st'>"obs"</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Observations with value of zero were removed from the data</span></div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>f.obs</span>)</div><div class='output co'>#&gt; mkin version used for fitting:    0.9.49.4 
#&gt; R version used for fitting:       3.6.0 
#&gt; Date of fit:     Fri May  3 19:07:37 2019 
#&gt; Date of summary: Fri May  3 19:07:37 2019 
#&gt; 
#&gt; Equations:
#&gt; d_parent/dt = - k_parent * parent
#&gt; d_m1/dt = + f_parent_to_m1 * k_parent * parent - k_m1 * m1
#&gt; 
#&gt; Model predictions using solution type deSolve 
#&gt; 
#&gt; Fitted using 756 model solutions performed in 1.973 s
#&gt; 
#&gt; Error model:
#&gt; Variance unique to each observed variable 
#&gt; 
#&gt; Starting values for parameters to be optimised:
#&gt;                   value   type
#&gt; parent_0       100.7500  state
#&gt; k_parent         0.1000 deparm
#&gt; k_m1             0.1001 deparm
#&gt; f_parent_to_m1   0.5000 deparm
#&gt; sigma_parent     3.0000  error
#&gt; sigma_m1         3.0000  error
#&gt; 
#&gt; Starting values for the transformed parameters actually optimised:
#&gt;                     value lower upper
#&gt; parent_0       100.750000  -Inf   Inf
#&gt; log_k_parent    -2.302585  -Inf   Inf
#&gt; log_k_m1        -2.301586  -Inf   Inf
#&gt; f_parent_ilr_1   0.000000  -Inf   Inf
#&gt; sigma_parent     3.000000     0   Inf
#&gt; sigma_m1         3.000000     0   Inf
#&gt; 
#&gt; Fixed parameter values:
#&gt;      value  type
#&gt; m1_0     0 state
#&gt; 
#&gt; Optimised, transformed parameters with symmetric confidence intervals:
#&gt;                Estimate Std. Error    Lower    Upper
#&gt; parent_0       99.65000    1.70200 96.19000 103.1000
#&gt; log_k_parent   -2.31300    0.04376 -2.40200  -2.2240
#&gt; log_k_m1       -5.25000    0.12430 -5.50400  -4.9970
#&gt; f_parent_ilr_1  0.03861    0.06171 -0.08708   0.1643
#&gt; sigma_parent    3.40100    0.56820  2.24400   4.5590
#&gt; sigma_m1        2.85500    0.45240  1.93400   3.7770
#&gt; 
#&gt; Parameter correlation:
#&gt;                parent_0 log_k_parent log_k_m1 f_parent_ilr_1 sigma_parent
#&gt; parent_0        1.00000      0.51078 -0.19133       -0.59997     0.035685
#&gt; log_k_parent    0.51078      1.00000 -0.37458       -0.59239     0.069840
#&gt; log_k_m1       -0.19133     -0.37458  1.00000        0.74398    -0.026160
#&gt; f_parent_ilr_1 -0.59997     -0.59239  0.74398        1.00000    -0.041377
#&gt; sigma_parent    0.03569      0.06984 -0.02616       -0.04138     1.000000
#&gt; sigma_m1       -0.03385     -0.06626  0.02482        0.03925    -0.004628
#&gt;                 sigma_m1
#&gt; parent_0       -0.033847
#&gt; log_k_parent   -0.066264
#&gt; log_k_m1        0.024822
#&gt; f_parent_ilr_1  0.039254
#&gt; sigma_parent   -0.004628
#&gt; sigma_m1        1.000000
#&gt; 
#&gt; Backtransformed parameters:
#&gt; Confidence intervals for internally transformed parameters are asymmetric.
#&gt; t-test (unrealistically) based on the assumption of normal distribution
#&gt; for estimators of untransformed parameters.
#&gt;                 Estimate t value    Pr(&gt;t)     Lower     Upper
#&gt; parent_0       99.650000  58.560 2.004e-34 96.190000 1.031e+02
#&gt; k_parent        0.098970  22.850 1.099e-21  0.090530 1.082e-01
#&gt; k_m1            0.005245   8.046 1.732e-09  0.004072 6.756e-03
#&gt; f_parent_to_m1  0.513600  23.560 4.352e-22  0.469300 5.578e-01
#&gt; sigma_parent    3.401000   5.985 5.662e-07  2.244000 4.559e+00
#&gt; sigma_m1        2.855000   6.311 2.215e-07  1.934000 3.777e+00
#&gt; 
#&gt; FOCUS Chi2 error levels in percent:
#&gt;          err.min n.optim df
#&gt; All data   6.398       4 15
#&gt; parent     6.464       2  7
#&gt; m1         4.682       2  8
#&gt; 
#&gt; Resulting formation fractions:
#&gt;                 ff
#&gt; parent_m1   0.5136
#&gt; parent_sink 0.4864
#&gt; 
#&gt; Estimated disappearance times:
#&gt;           DT50   DT90
#&gt; parent   7.003  23.26
#&gt; m1     132.154 439.01
#&gt; 
#&gt; Data:
#&gt;  time variable observed predicted   residual
#&gt;     0   parent    99.46  99.65425 -1.942e-01
#&gt;     0   parent   102.04  99.65425  2.386e+00
#&gt;     1   parent    93.50  90.26338  3.237e+00
#&gt;     1   parent    92.50  90.26338  2.237e+00
#&gt;     3   parent    63.23  74.05309 -1.082e+01
#&gt;     3   parent    68.99  74.05309 -5.063e+00
#&gt;     7   parent    52.32  49.84326  2.477e+00
#&gt;     7   parent    55.13  49.84326  5.287e+00
#&gt;    14   parent    27.27  24.92970  2.340e+00
#&gt;    14   parent    26.64  24.92970  1.710e+00
#&gt;    21   parent    11.50  12.46888 -9.689e-01
#&gt;    21   parent    11.64  12.46888 -8.289e-01
#&gt;    35   parent     2.85   3.11924 -2.692e-01
#&gt;    35   parent     2.91   3.11924 -2.092e-01
#&gt;    50   parent     0.69   0.70678 -1.678e-02
#&gt;    50   parent     0.63   0.70678 -7.678e-02
#&gt;    75   parent     0.05   0.05952 -9.522e-03
#&gt;    75   parent     0.06   0.05952  4.776e-04
#&gt;     1       m1     4.84   4.81075  2.925e-02
#&gt;     1       m1     5.64   4.81075  8.292e-01
#&gt;     3       m1    12.91  13.04197 -1.320e-01
#&gt;     3       m1    12.96  13.04197 -8.197e-02
#&gt;     7       m1    22.97  25.06848 -2.098e+00
#&gt;     7       m1    24.47  25.06848 -5.985e-01
#&gt;    14       m1    41.69  36.70308  4.987e+00
#&gt;    14       m1    33.21  36.70308 -3.493e+00
#&gt;    21       m1    44.37  41.65115  2.719e+00
#&gt;    21       m1    46.44  41.65115  4.789e+00
#&gt;    35       m1    41.22  43.29464 -2.075e+00
#&gt;    35       m1    37.95  43.29464 -5.345e+00
#&gt;    50       m1    41.19  41.19947 -9.473e-03
#&gt;    50       m1    40.01  41.19947 -1.189e+00
#&gt;    75       m1    40.09  36.44035  3.650e+00
#&gt;    75       m1    33.85  36.44035 -2.590e+00
#&gt;   100       m1    31.04  31.98773 -9.477e-01
#&gt;   100       m1    33.13  31.98773  1.142e+00
#&gt;   120       m1    25.15  28.80430 -3.654e+00
#&gt;   120       m1    33.31  28.80430  4.506e+00</div><div class='input'><span class='no'>f.tc</span> <span class='kw'>&lt;-</span> <span class='fu'>mkinfit</span>(<span class='no'>SFO_SFO.ff</span>, <span class='no'>FOCUS_2006_D</span>, <span class='kw'>error_model</span> <span class='kw'>=</span> <span class='st'>"tc"</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Observations with value of zero were removed from the data</span></div><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>f.tc</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs wurden erzeugt</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs wurden erzeugt</span></div><div class='output co'>#&gt; <span class='warning'>Warning: NaNs wurden erzeugt</span></div><div class='output co'>#&gt; <span class='warning'>Warning: diag(.) had 0 or NA entries; non-finite result is doubtful</span></div><div class='output co'>#&gt; mkin version used for fitting:    0.9.49.4 
#&gt; R version used for fitting:       3.6.0 
#&gt; Date of fit:     Fri May  3 19:07:40 2019 
#&gt; Date of summary: Fri May  3 19:07:40 2019 
#&gt; 
#&gt; Equations:
#&gt; d_parent/dt = - k_parent * parent
#&gt; d_m1/dt = + f_parent_to_m1 * k_parent * parent - k_m1 * m1
#&gt; 
#&gt; Model predictions using solution type deSolve 
#&gt; 
#&gt; Fitted using 888 model solutions performed in 3.579 s
#&gt; 
#&gt; Error model:
#&gt; Two-component variance function 
#&gt; 
#&gt; Starting values for parameters to be optimised:
#&gt;                   value   type
#&gt; parent_0       100.7500  state
#&gt; k_parent         0.1000 deparm
#&gt; k_m1             0.1001 deparm
#&gt; f_parent_to_m1   0.5000 deparm
#&gt; sigma_low        0.1000  error
#&gt; rsd_high         0.1000  error
#&gt; 
#&gt; Starting values for the transformed parameters actually optimised:
#&gt;                     value lower upper
#&gt; parent_0       100.750000  -Inf   Inf
#&gt; log_k_parent    -2.302585  -Inf   Inf
#&gt; log_k_m1        -2.301586  -Inf   Inf
#&gt; f_parent_ilr_1   0.000000  -Inf   Inf
#&gt; sigma_low        0.100000     0   Inf
#&gt; rsd_high         0.100000     0   Inf
#&gt; 
#&gt; Fixed parameter values:
#&gt;      value  type
#&gt; m1_0     0 state
#&gt; 
#&gt; Optimised, transformed parameters with symmetric confidence intervals:
#&gt;                 Estimate Std. Error    Lower     Upper
#&gt; parent_0       100.30000    3.06400 94.08000 106.60000
#&gt; log_k_parent    -2.31100    0.02913 -2.37100  -2.25200
#&gt; log_k_m1        -5.27800    0.10890 -5.49900  -5.05600
#&gt; f_parent_ilr_1   0.02128    0.07223 -0.12590   0.16840
#&gt; sigma_low        0.99650        NaN      NaN       NaN
#&gt; rsd_high         0.07560    0.01059  0.05402   0.09717
#&gt; 
#&gt; Parameter correlation:
#&gt;                parent_0 log_k_parent  log_k_m1 f_parent_ilr_1 sigma_low
#&gt; parent_0        1.00000      0.64703 -0.220160       -0.79035       NaN
#&gt; log_k_parent    0.64703      1.00000 -0.339633       -0.67982       NaN
#&gt; log_k_m1       -0.22016     -0.33963  1.000000        0.62815       NaN
#&gt; f_parent_ilr_1 -0.79035     -0.67982  0.628148        1.00000       NaN
#&gt; sigma_low           NaN          NaN       NaN            NaN         1
#&gt; rsd_high       -0.05745     -0.01123  0.003502        0.00568       NaN
#&gt;                 rsd_high
#&gt; parent_0       -0.057450
#&gt; log_k_parent   -0.011230
#&gt; log_k_m1        0.003502
#&gt; f_parent_ilr_1  0.005680
#&gt; sigma_low            NaN
#&gt; rsd_high        1.000000
#&gt; 
#&gt; Backtransformed parameters:
#&gt; Confidence intervals for internally transformed parameters are asymmetric.
#&gt; t-test (unrealistically) based on the assumption of normal distribution
#&gt; for estimators of untransformed parameters.
#&gt;                 Estimate t value    Pr(&gt;t)     Lower     Upper
#&gt; parent_0       1.003e+02  32.740 1.759e-26 94.080000 1.066e+02
#&gt; k_parent       9.914e-02  34.330 4.045e-27  0.093430 1.052e-01
#&gt; k_m1           5.105e-03   9.186 8.682e-11  0.004089 6.372e-03
#&gt; f_parent_to_m1 5.075e-01  19.880 7.143e-20  0.455600 5.593e-01
#&gt; sigma_low      9.965e-01     NaN       NaN       NaN       NaN
#&gt; rsd_high       7.560e-02   7.137 2.114e-08  0.054020 9.717e-02
#&gt; 
#&gt; FOCUS Chi2 error levels in percent:
#&gt;          err.min n.optim df
#&gt; All data   6.433       4 15
#&gt; parent     6.506       2  7
#&gt; m1         4.692       2  8
#&gt; 
#&gt; Resulting formation fractions:
#&gt;                 ff
#&gt; parent_m1   0.5075
#&gt; parent_sink 0.4925
#&gt; 
#&gt; Estimated disappearance times:
#&gt;           DT50   DT90
#&gt; parent   6.992  23.23
#&gt; m1     135.787 451.08
#&gt; 
#&gt; Data:
#&gt;  time variable observed predicted   residual
#&gt;     0   parent    99.46 100.32122  -0.861220
#&gt;     0   parent   102.04 100.32122   1.718780
#&gt;     1   parent    93.50  90.85266   2.647340
#&gt;     1   parent    92.50  90.85266   1.647340
#&gt;     3   parent    63.23  74.51219 -11.282190
#&gt;     3   parent    68.99  74.51219  -5.522190
#&gt;     7   parent    52.32  50.11950   2.200504
#&gt;     7   parent    55.13  50.11950   5.010504
#&gt;    14   parent    27.27  25.03921   2.230792
#&gt;    14   parent    26.64  25.03921   1.600792
#&gt;    21   parent    11.50  12.50934  -1.009342
#&gt;    21   parent    11.64  12.50934  -0.869342
#&gt;    35   parent     2.85   3.12221  -0.272211
#&gt;    35   parent     2.91   3.12221  -0.212211
#&gt;    50   parent     0.69   0.70572  -0.015724
#&gt;    50   parent     0.63   0.70572  -0.075724
#&gt;    75   parent     0.05   0.05919  -0.009191
#&gt;    75   parent     0.06   0.05919   0.000809
#&gt;     1       m1     4.84   4.79307   0.046928
#&gt;     1       m1     5.64   4.79307   0.846928
#&gt;     3       m1    12.91  12.99398  -0.083980
#&gt;     3       m1    12.96  12.99398  -0.033980
#&gt;     7       m1    22.97  24.97744  -2.007441
#&gt;     7       m1    24.47  24.97744  -0.507441
#&gt;    14       m1    41.69  36.57917   5.110827
#&gt;    14       m1    33.21  36.57917  -3.369173
#&gt;    21       m1    44.37  41.52931   2.840692
#&gt;    21       m1    46.44  41.52931   4.910692
#&gt;    35       m1    41.22  43.22614  -2.006138
#&gt;    35       m1    37.95  43.22614  -5.276138
#&gt;    50       m1    41.19  41.20972  -0.019717
#&gt;    50       m1    40.01  41.20972  -1.199717
#&gt;    75       m1    40.09  36.57312   3.516882
#&gt;    75       m1    33.85  36.57312  -2.723118
#&gt;   100       m1    31.04  32.21655  -1.176546
#&gt;   100       m1    33.13  32.21655   0.913454
#&gt;   120       m1    25.15  29.09181  -3.941814
#&gt;   120       m1    33.31  29.09181   4.218186</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#source">Source</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Johannes Ranke</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Johannes Ranke.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

