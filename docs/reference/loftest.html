<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Lack-of-fit test for models fitted to data with replicates — loftest • mkin</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Lack-of-fit test for models fitted to data with replicates — loftest"><meta property="og:description" content="This is a generic function with a method currently only defined for mkinfit
objects. It fits an anova model to the data contained in the object and
compares the likelihoods using the likelihood ratio test
lrtest.default from the lmtest package."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mkin</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Functions and data</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/mkin.html">Introduction to mkin</a>
    </li>
    <li>
      <a href="../articles/FOCUS_D.html">Example evaluation of FOCUS Example Dataset D</a>
    </li>
    <li>
      <a href="../articles/FOCUS_L.html">Example evaluation of FOCUS Laboratory Data L1 to L3</a>
    </li>
    <li>
      <a href="../articles/web_only/dimethenamid_2018.html">Example evaluations of dimethenamid data from 2018 with nonlinear mixed-effects models</a>
    </li>
    <li>
      <a href="../articles/web_only/FOCUS_Z.html">Example evaluation of FOCUS Example Dataset Z</a>
    </li>
    <li>
      <a href="../articles/web_only/compiled_models.html">Performance benefit by using compiled model definitions in mkin</a>
    </li>
    <li>
      <a href="../articles/twa.html">Calculation of time weighted average concentrations with mkin</a>
    </li>
    <li>
      <a href="../articles/web_only/NAFTA_examples.html">Example evaluation of NAFTA SOP Attachment examples</a>
    </li>
    <li>
      <a href="../articles/web_only/benchmarks.html">Some benchmark timings</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jranke/mkin/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Lack-of-fit test for models fitted to data with replicates</h1>
    <small class="dont-index">Source: <a href="https://github.com/jranke/mkin/blob/HEAD/R/loftest.R" class="external-link"><code>R/loftest.R</code></a></small>
    <div class="hidden name"><code>loftest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is a generic function with a method currently only defined for mkinfit
objects. It fits an anova model to the data contained in the object and
compares the likelihoods using the likelihood ratio test
<code><a href="https://rdrr.io/pkg/lmtest/man/lrtest.html" class="external-link">lrtest.default</a></code> from the lmtest package.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">loftest</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for mkinfit</span>
<span class="fu">loftest</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>A model object with a defined loftest method</p></dd>
<dt>...</dt>
<dd><p>Not used</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The anova model is interpreted as the simplest form of an mkinfit model,
assuming only a constant variance about the means, but not enforcing any
structure of the means, so we have one model parameter for every mean
of replicate samples.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>lrtest</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># \dontrun{</span></span>
<span class="r-in"><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">synthetic_data_for_UBA_2014</span><span class="op">[[</span><span class="fl">12</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">data</span>, <span class="va">name</span> <span class="op">==</span> <span class="st">"parent"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sfo_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="mkinfit.html">mkinfit</a></span><span class="op">(</span><span class="st">"SFO"</span>, <span class="va">test_data</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="plot.mkinfit.html">plot_res</a></span><span class="op">(</span><span class="va">sfo_fit</span><span class="op">)</span> <span class="co"># We see a clear pattern in the residuals</span></span>
<span class="r-plt img"><img src="loftest-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu">loftest</span><span class="op">(</span><span class="va">sfo_fit</span><span class="op">)</span>  <span class="co"># We have a clear lack of fit</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Likelihood ratio test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 1: ANOVA with error model const</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2: SFO with error model const</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   #Df  LogLik Df  Chisq Pr(&gt;Chisq)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  10 -40.710                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   3 -63.954 -7 46.487  7.027e-08 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span class="co">#</span></span>
<span class="r-in"><span class="co"># We try a different model (the one that was used to generate the data)</span></span>
<span class="r-in"><span class="va">dfop_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="mkinfit.html">mkinfit</a></span><span class="op">(</span><span class="st">"DFOP"</span>, <span class="va">test_data</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="plot.mkinfit.html">plot_res</a></span><span class="op">(</span><span class="va">dfop_fit</span><span class="op">)</span> <span class="co"># We don't see systematic deviations, but heteroscedastic residuals</span></span>
<span class="r-plt img"><img src="loftest-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="co"># therefore we should consider adapting the error model, although we have</span></span>
<span class="r-in"><span class="fu">loftest</span><span class="op">(</span><span class="va">dfop_fit</span><span class="op">)</span> <span class="co"># no lack of fit</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Likelihood ratio test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 1: ANOVA with error model const</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2: DFOP with error model const</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   #Df  LogLik Df Chisq Pr(&gt;Chisq)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  10 -40.710                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   5 -42.453 -5 3.485     0.6257</span>
<span class="r-in"><span class="co">#</span></span>
<span class="r-in"><span class="co"># This is the anova model used internally for the comparison</span></span>
<span class="r-in"><span class="va">test_data_anova</span> <span class="op">&lt;-</span> <span class="va">test_data</span></span>
<span class="r-in"><span class="va">test_data_anova</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">test_data_anova</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span>
<span class="r-in"><span class="va">anova_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">test_data_anova</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">anova_fit</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = value ~ time, data = test_data_anova)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -6.1000 -0.5625  0.0000  0.5625  6.1000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  103.150      2.323  44.409 7.44e-12 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time1        -19.950      3.285  -6.073 0.000185 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time3        -50.800      3.285 -15.465 8.65e-08 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time7        -68.500      3.285 -20.854 6.28e-09 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time14       -79.750      3.285 -24.278 1.63e-09 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time28       -86.000      3.285 -26.181 8.35e-10 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time60       -94.900      3.285 -28.891 3.48e-10 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time90       -98.500      3.285 -29.986 2.49e-10 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time120     -100.450      3.285 -30.580 2.09e-10 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 3.285 on 9 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.9953,	Adjusted R-squared:  0.9912 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 240.5 on 8 and 9 DF,  p-value: 1.417e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">anova_fit</span><span class="op">)</span> <span class="co"># We get the same likelihood and degrees of freedom</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'log Lik.' -40.71015 (df=10)</span>
<span class="r-in"><span class="co">#</span></span>
<span class="r-in"><span class="va">test_data_2</span> <span class="op">&lt;-</span> <span class="va">synthetic_data_for_UBA_2014</span><span class="op">[[</span><span class="fl">12</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">data</span></span>
<span class="r-in"><span class="va">m_synth_SFO_lin</span> <span class="op">&lt;-</span> <span class="fu"><a href="mkinmod.html">mkinmod</a></span><span class="op">(</span>parent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"SFO"</span>, to <span class="op">=</span> <span class="st">"M1"</span><span class="op">)</span>,</span>
<span class="r-in">  M1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"SFO"</span>, to <span class="op">=</span> <span class="st">"M2"</span><span class="op">)</span>,</span>
<span class="r-in">  M2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"SFO"</span><span class="op">)</span>, use_of_ff <span class="op">=</span> <span class="st">"max"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Temporary DLL for differentials generated and loaded</span>
<span class="r-in"><span class="va">sfo_lin_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="mkinfit.html">mkinfit</a></span><span class="op">(</span><span class="va">m_synth_SFO_lin</span>, <span class="va">test_data_2</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="plot.mkinfit.html">plot_res</a></span><span class="op">(</span><span class="va">sfo_lin_fit</span><span class="op">)</span> <span class="co"># not a good model, we try parallel formation</span></span>
<span class="r-plt img"><img src="loftest-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu">loftest</span><span class="op">(</span><span class="va">sfo_lin_fit</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Likelihood ratio test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 1: ANOVA with error model const</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2: m_synth_SFO_lin with error model const and fixed parameter(s) M1_0, M2_0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   #Df   LogLik  Df  Chisq Pr(&gt;Chisq)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  28  -93.606                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   7 -171.927 -21 156.64  &lt; 2.2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span class="co">#</span></span>
<span class="r-in"><span class="va">m_synth_SFO_par</span> <span class="op">&lt;-</span> <span class="fu"><a href="mkinmod.html">mkinmod</a></span><span class="op">(</span>parent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"SFO"</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"M1"</span>, <span class="st">"M2"</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">  M1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"SFO"</span><span class="op">)</span>,</span>
<span class="r-in">  M2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"SFO"</span><span class="op">)</span>, use_of_ff <span class="op">=</span> <span class="st">"max"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Temporary DLL for differentials generated and loaded</span>
<span class="r-in"><span class="va">sfo_par_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="mkinfit.html">mkinfit</a></span><span class="op">(</span><span class="va">m_synth_SFO_par</span>, <span class="va">test_data_2</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="plot.mkinfit.html">plot_res</a></span><span class="op">(</span><span class="va">sfo_par_fit</span><span class="op">)</span> <span class="co"># much better for metabolites</span></span>
<span class="r-plt img"><img src="loftest-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu">loftest</span><span class="op">(</span><span class="va">sfo_par_fit</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Likelihood ratio test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 1: ANOVA with error model const</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2: m_synth_SFO_par with error model const and fixed parameter(s) M1_0, M2_0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   #Df   LogLik  Df  Chisq Pr(&gt;Chisq)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  28  -93.606                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   7 -156.331 -21 125.45  &lt; 2.2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span class="co">#</span></span>
<span class="r-in"><span class="va">m_synth_DFOP_par</span> <span class="op">&lt;-</span> <span class="fu"><a href="mkinmod.html">mkinmod</a></span><span class="op">(</span>parent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"DFOP"</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"M1"</span>, <span class="st">"M2"</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">  M1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"SFO"</span><span class="op">)</span>,</span>
<span class="r-in">  M2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"SFO"</span><span class="op">)</span>, use_of_ff <span class="op">=</span> <span class="st">"max"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Temporary DLL for differentials generated and loaded</span>
<span class="r-in"><span class="va">dfop_par_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="mkinfit.html">mkinfit</a></span><span class="op">(</span><span class="va">m_synth_DFOP_par</span>, <span class="va">test_data_2</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="plot.mkinfit.html">plot_res</a></span><span class="op">(</span><span class="va">dfop_par_fit</span><span class="op">)</span> <span class="co"># No visual lack of fit</span></span>
<span class="r-plt img"><img src="loftest-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu">loftest</span><span class="op">(</span><span class="va">dfop_par_fit</span><span class="op">)</span>  <span class="co"># no lack of fit found by the test</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Likelihood ratio test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 1: ANOVA with error model const</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2: m_synth_DFOP_par with error model const and fixed parameter(s) M1_0, M2_0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   #Df   LogLik  Df  Chisq Pr(&gt;Chisq)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  28  -93.606                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   9 -102.763 -19 18.313     0.5016</span>
<span class="r-in"><span class="co">#</span></span>
<span class="r-in"><span class="co"># The anova model used for comparison in the case of transformation products</span></span>
<span class="r-in"><span class="va">test_data_anova_2</span> <span class="op">&lt;-</span> <span class="va">dfop_par_fit</span><span class="op">$</span><span class="va">data</span></span>
<span class="r-in"><span class="va">test_data_anova_2</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">test_data_anova_2</span><span class="op">$</span><span class="va">variable</span><span class="op">)</span></span>
<span class="r-in"><span class="va">test_data_anova_2</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">test_data_anova_2</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span>
<span class="r-in"><span class="va">anova_fit_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">observed</span> <span class="op">~</span> <span class="va">time</span><span class="op">:</span><span class="va">variable</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">test_data_anova_2</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">anova_fit_2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lm(formula = observed ~ time:variable - 1, data = test_data_anova_2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min      1Q  Median      3Q     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -6.1000 -0.5875  0.0000  0.5875  6.1000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients: (2 not defined because of singularities)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time0:variableparent    103.150      1.573  65.562  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time1:variableparent     83.200      1.573  52.882  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time3:variableparent     52.350      1.573  33.274  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time7:variableparent     34.650      1.573  22.024  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time14:variableparent    23.400      1.573  14.873 6.35e-14 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time28:variableparent    17.150      1.573  10.901 5.47e-11 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time60:variableparent     8.250      1.573   5.244 1.99e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time90:variableparent     4.650      1.573   2.956 0.006717 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time120:variableparent    2.700      1.573   1.716 0.098507 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time0:variableM1             NA         NA      NA       NA    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time1:variableM1         11.850      1.573   7.532 6.93e-08 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time3:variableM1         22.700      1.573  14.428 1.26e-13 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time7:variableM1         33.050      1.573  21.007  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time14:variableM1        31.250      1.573  19.863  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time28:variableM1        18.900      1.573  12.013 7.02e-12 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time60:variableM1         7.550      1.573   4.799 6.28e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time90:variableM1         3.850      1.573   2.447 0.021772 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time120:variableM1        2.050      1.573   1.303 0.204454    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time0:variableM2             NA         NA      NA       NA    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time1:variableM2          6.700      1.573   4.259 0.000254 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time3:variableM2         16.750      1.573  10.646 8.93e-11 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time7:variableM2         25.800      1.573  16.399 6.89e-15 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time14:variableM2        28.600      1.573  18.178 6.35e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time28:variableM2        25.400      1.573  16.144 9.85e-15 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time60:variableM2        21.600      1.573  13.729 3.81e-13 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time90:variableM2        17.800      1.573  11.314 2.51e-11 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> time120:variableM2       14.100      1.573   8.962 2.79e-09 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual standard error: 2.225 on 25 degrees of freedom</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.9979,	Adjusted R-squared:  0.9957 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 469.2 on 25 and 25 DF,  p-value: &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="co"># }</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Johannes Ranke.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

