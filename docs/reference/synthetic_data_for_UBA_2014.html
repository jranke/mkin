<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Synthetic datasets for one parent compound with two metabolites — synthetic_data_for_UBA_2014 • mkin</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Synthetic datasets for one parent compound with two metabolites — synthetic_data_for_UBA_2014"><meta property="og:description" content="The 12 datasets were generated using four different models and three different
 variance components. The four models are either the SFO or the DFOP model with either
 two sequential or two parallel metabolites.
Variance component 'a' is based on a normal distribution with standard deviation of 3,
 Variance component 'b' is also based on a normal distribution, but with a standard deviation of 7.
 Variance component 'c' is based on the error model from Rocke and Lorenzato (1995), with the
 minimum standard deviation (for small y values) of 0.5, and a proportionality constant of 0.07
 for the increase of the standard deviation with y. Note that this is a simplified version
 of the error model proposed by Rocke and Lorenzato (1995), as in their model the error of the
 measured values approximates lognormal distribution for high values, whereas we are using
 normally distributed error components all along.
Initial concentrations for metabolites and all values where adding the variance component resulted
 in a value below the assumed limit of detection of 0.1 were set to NA.
As an example, the first dataset has the title SFO_lin_a and is based on the SFO model
 with two sequential metabolites (linear pathway), with added variance component 'a'.
Compare also the code in the example section to see the degradation models."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mkin</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Functions and data</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/mkin.html">Introduction to mkin</a>
    </li>
    <li>
      <a href="../articles/FOCUS_D.html">Example evaluation of FOCUS Example Dataset D</a>
    </li>
    <li>
      <a href="../articles/FOCUS_L.html">Example evaluation of FOCUS Laboratory Data L1 to L3</a>
    </li>
    <li>
      <a href="../articles/web_only/dimethenamid_2018.html">Example evaluations of dimethenamid data from 2018 with nonlinear mixed-effects models</a>
    </li>
    <li>
      <a href="../articles/web_only/FOCUS_Z.html">Example evaluation of FOCUS Example Dataset Z</a>
    </li>
    <li>
      <a href="../articles/web_only/compiled_models.html">Performance benefit by using compiled model definitions in mkin</a>
    </li>
    <li>
      <a href="../articles/twa.html">Calculation of time weighted average concentrations with mkin</a>
    </li>
    <li>
      <a href="../articles/web_only/NAFTA_examples.html">Example evaluation of NAFTA SOP Attachment examples</a>
    </li>
    <li>
      <a href="../articles/web_only/benchmarks.html">Some benchmark timings</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jranke/mkin/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Synthetic datasets for one parent compound with two metabolites</h1>
    
    <div class="hidden name"><code>synthetic_data_for_UBA_2014.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The 12 datasets were generated using four different models and three different
 variance components. The four models are either the SFO or the DFOP model with either
 two sequential or two parallel metabolites.</p>
<p>Variance component 'a' is based on a normal distribution with standard deviation of 3,
 Variance component 'b' is also based on a normal distribution, but with a standard deviation of 7.
 Variance component 'c' is based on the error model from Rocke and Lorenzato (1995), with the
 minimum standard deviation (for small y values) of 0.5, and a proportionality constant of 0.07
 for the increase of the standard deviation with y. Note that this is a simplified version
 of the error model proposed by Rocke and Lorenzato (1995), as in their model the error of the
 measured values approximates lognormal distribution for high values, whereas we are using
 normally distributed error components all along.</p>
<p>Initial concentrations for metabolites and all values where adding the variance component resulted
 in a value below the assumed limit of detection of 0.1 were set to <code>NA</code>.</p>
<p>As an example, the first dataset has the title <code>SFO_lin_a</code> and is based on the SFO model
 with two sequential metabolites (linear pathway), with added variance component 'a'.</p>
<p>Compare also the code in the example section to see the degradation models.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="va">synthetic_data_for_UBA_2014</span></code></pre></div>
    </div>

    <div id="format">
    <h2>Format</h2>
    <p>A list containing twelve datasets as an R6 class defined by <code><a href="mkinds.html">mkinds</a></code>,
  each containing, among others, the following components</p><dl><dt><code>title</code></dt>
<dd><p>The name of the dataset, e.g. <code>SFO_lin_a</code></p></dd>

    <dt><code>data</code></dt>
<dd><p>A data frame with the data in the form expected by <code><a href="mkinfit.html">mkinfit</a></code></p></dd>

  
</dl></div>
    <div id="source">
    <h2>Source</h2>
    <p>Ranke (2014) Prüfung und Validierung von Modellierungssoftware als Alternative
  zu ModelMaker 4.0, Umweltbundesamt Projektnummer 27452</p>
<p>Rocke, David M. und Lorenzato, Stefan (1995) A two-component model for
  measurement error in analytical chemistry. Technometrics 37(2), 176-184.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># \dontrun{</span></span>
<span class="r-in"><span class="co"># The data have been generated using the following kinetic models</span></span>
<span class="r-in"><span class="va">m_synth_SFO_lin</span> <span class="op">&lt;-</span> <span class="fu"><a href="mkinmod.html">mkinmod</a></span><span class="op">(</span>parent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"SFO"</span>, to <span class="op">=</span> <span class="st">"M1"</span><span class="op">)</span>,</span>
<span class="r-in">                           M1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"SFO"</span>, to <span class="op">=</span> <span class="st">"M2"</span><span class="op">)</span>,</span>
<span class="r-in">                           M2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"SFO"</span><span class="op">)</span>, use_of_ff <span class="op">=</span> <span class="st">"max"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Temporary DLL for differentials generated and loaded</span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">m_synth_SFO_par</span> <span class="op">&lt;-</span> <span class="fu"><a href="mkinmod.html">mkinmod</a></span><span class="op">(</span>parent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"SFO"</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"M1"</span>, <span class="st">"M2"</span><span class="op">)</span>,</span>
<span class="r-in">                                         sink <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span class="r-in">                           M1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"SFO"</span><span class="op">)</span>,</span>
<span class="r-in">                           M2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"SFO"</span><span class="op">)</span>, use_of_ff <span class="op">=</span> <span class="st">"max"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Temporary DLL for differentials generated and loaded</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">m_synth_DFOP_lin</span> <span class="op">&lt;-</span> <span class="fu"><a href="mkinmod.html">mkinmod</a></span><span class="op">(</span>parent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"DFOP"</span>, to <span class="op">=</span> <span class="st">"M1"</span><span class="op">)</span>,</span>
<span class="r-in">                            M1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"SFO"</span>, to <span class="op">=</span> <span class="st">"M2"</span><span class="op">)</span>,</span>
<span class="r-in">                            M2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"SFO"</span><span class="op">)</span>, use_of_ff <span class="op">=</span> <span class="st">"max"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Temporary DLL for differentials generated and loaded</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">m_synth_DFOP_par</span> <span class="op">&lt;-</span> <span class="fu"><a href="mkinmod.html">mkinmod</a></span><span class="op">(</span>parent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"DFOP"</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"M1"</span>, <span class="st">"M2"</span><span class="op">)</span>,</span>
<span class="r-in">                                          sink <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span class="r-in">                            M1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"SFO"</span><span class="op">)</span>,</span>
<span class="r-in">                            M2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"SFO"</span><span class="op">)</span>, use_of_ff <span class="op">=</span> <span class="st">"max"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Temporary DLL for differentials generated and loaded</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># The model predictions without intentional error were generated as follows</span></span>
<span class="r-in"><span class="va">sampling_times</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">14</span>, <span class="fl">28</span>, <span class="fl">60</span>, <span class="fl">90</span>, <span class="fl">120</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">d_synth_SFO_lin</span> <span class="op">&lt;-</span> <span class="fu"><a href="mkinpredict.html">mkinpredict</a></span><span class="op">(</span><span class="va">m_synth_SFO_lin</span>,</span>
<span class="r-in">                               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>k_parent <span class="op">=</span> <span class="fl">0.7</span>, f_parent_to_M1 <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span class="r-in">                                 k_M1 <span class="op">=</span> <span class="fl">0.3</span>, f_M1_to_M2 <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span class="r-in">                                 k_M2 <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span>,</span>
<span class="r-in">                               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>parent <span class="op">=</span> <span class="fl">100</span>, M1 <span class="op">=</span> <span class="fl">0</span>, M2 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span class="r-in">                               <span class="va">sampling_times</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">d_synth_DFOP_lin</span> <span class="op">&lt;-</span> <span class="fu"><a href="mkinpredict.html">mkinpredict</a></span><span class="op">(</span><span class="va">m_synth_DFOP_lin</span>,</span>
<span class="r-in">                                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>k1 <span class="op">=</span> <span class="fl">0.2</span>, k2 <span class="op">=</span> <span class="fl">0.02</span>, g <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span class="r-in">                                  f_parent_to_M1 <span class="op">=</span> <span class="fl">0.5</span>, k_M1 <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span class="r-in">                                  f_M1_to_M2 <span class="op">=</span> <span class="fl">0.7</span>, k_M2 <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span>,</span>
<span class="r-in">                                 <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>parent <span class="op">=</span> <span class="fl">100</span>, M1 <span class="op">=</span> <span class="fl">0</span>, M2 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span class="r-in">                                 <span class="va">sampling_times</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">d_synth_SFO_par</span> <span class="op">&lt;-</span> <span class="fu"><a href="mkinpredict.html">mkinpredict</a></span><span class="op">(</span><span class="va">m_synth_SFO_par</span>,</span>
<span class="r-in">                               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>k_parent <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span class="r-in">                                 f_parent_to_M1 <span class="op">=</span> <span class="fl">0.8</span>, k_M1 <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span class="r-in">                                 f_parent_to_M2 <span class="op">=</span> <span class="fl">0.2</span>, k_M2 <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span>,</span>
<span class="r-in">                                 <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>parent <span class="op">=</span> <span class="fl">100</span>, M1 <span class="op">=</span> <span class="fl">0</span>, M2 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span class="r-in">                                 <span class="va">sampling_times</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">d_synth_DFOP_par</span> <span class="op">&lt;-</span> <span class="fu"><a href="mkinpredict.html">mkinpredict</a></span><span class="op">(</span><span class="va">m_synth_DFOP_par</span>,</span>
<span class="r-in">                               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>k1 <span class="op">=</span> <span class="fl">0.3</span>, k2 <span class="op">=</span> <span class="fl">0.02</span>, g <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span class="r-in">                                 f_parent_to_M1 <span class="op">=</span> <span class="fl">0.6</span>, k_M1 <span class="op">=</span> <span class="fl">0.04</span>,</span>
<span class="r-in">                                 f_parent_to_M2 <span class="op">=</span> <span class="fl">0.4</span>, k_M2 <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>,</span>
<span class="r-in">                                 <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>parent <span class="op">=</span> <span class="fl">100</span>, M1 <span class="op">=</span> <span class="fl">0</span>, M2 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span class="r-in">                                 <span class="va">sampling_times</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Construct names for datasets with errors</span></span>
<span class="r-in"><span class="va">d_synth_names</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"d_synth_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SFO_lin"</span>, <span class="st">"SFO_par"</span>,</span>
<span class="r-in">                                     <span class="st">"DFOP_lin"</span>, <span class="st">"DFOP_par"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Original function used or adding errors. The add_err function now published</span></span>
<span class="r-in"><span class="co"># with this package is a slightly generalised version where the names of</span></span>
<span class="r-in"><span class="co"># secondary compartments that should have an initial value of zero (M1 and M2</span></span>
<span class="r-in"><span class="co"># in this case) are not hardcoded any more.</span></span>
<span class="r-in"><span class="co"># add_err = function(d, sdfunc, LOD = 0.1, reps = 2, seed = 123456789)</span></span>
<span class="r-in"><span class="co"># {</span></span>
<span class="r-in"><span class="co">#   set.seed(seed)</span></span>
<span class="r-in"><span class="co">#   d_long = mkin_wide_to_long(d, time = "time")</span></span>
<span class="r-in"><span class="co">#   d_rep = data.frame(lapply(d_long, rep, each = 2))</span></span>
<span class="r-in"><span class="co">#   d_rep$value = rnorm(length(d_rep$value), d_rep$value, sdfunc(d_rep$value))</span></span>
<span class="r-in"><span class="co">#</span></span>
<span class="r-in"><span class="co">#   d_rep[d_rep$time == 0 &amp; d_rep$name %in% c("M1", "M2"), "value"] &lt;- 0</span></span>
<span class="r-in"><span class="co">#   d_NA &lt;- transform(d_rep, value = ifelse(value &lt; LOD, NA, value))</span></span>
<span class="r-in"><span class="co">#   d_NA$value &lt;- round(d_NA$value, 1)</span></span>
<span class="r-in"><span class="co">#   return(d_NA)</span></span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># The following is the simplified version of the two-component model of Rocke</span></span>
<span class="r-in"><span class="co"># and Lorenzato (1995)</span></span>
<span class="r-in"><span class="va">sdfunc_twocomp</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">value</span>, <span class="va">sd_low</span>, <span class="va">rsd_high</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sd_low</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">value</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">rsd_high</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Add the errors.</span></span>
<span class="r-in"><span class="kw">for</span> <span class="op">(</span><span class="va">d_synth_name</span> <span class="kw">in</span> <span class="va">d_synth_names</span><span class="op">)</span></span>
<span class="r-in"><span class="op">{</span></span>
<span class="r-in">  <span class="va">d_synth</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">d_synth_name</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/assign.html" class="external-link">assign</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">d_synth_name</span>, <span class="st">"_a"</span><span class="op">)</span>, <span class="fu"><a href="add_err.html">add_err</a></span><span class="op">(</span><span class="va">d_synth</span>, <span class="kw">function</span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/assign.html" class="external-link">assign</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">d_synth_name</span>, <span class="st">"_b"</span><span class="op">)</span>, <span class="fu"><a href="add_err.html">add_err</a></span><span class="op">(</span><span class="va">d_synth</span>, <span class="kw">function</span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/assign.html" class="external-link">assign</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">d_synth_name</span>, <span class="st">"_c"</span><span class="op">)</span>, <span class="fu"><a href="add_err.html">add_err</a></span><span class="op">(</span><span class="va">d_synth</span>,</span>
<span class="r-in">                           <span class="kw">function</span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="fu">sdfunc_twocomp</span><span class="op">(</span><span class="va">value</span>, <span class="fl">0.5</span>, <span class="fl">0.07</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">d_synth_err_names</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">d_synth_names</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># This is just one example of an evaluation using the kinetic model used for</span></span>
<span class="r-in"><span class="co"># the generation of the data</span></span>
<span class="r-in">  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="mkinfit.html">mkinfit</a></span><span class="op">(</span><span class="va">m_synth_SFO_lin</span>, <span class="va">synthetic_data_for_UBA_2014</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">data</span>,</span>
<span class="r-in">                 quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in">  <span class="fu"><a href="plot.mkinfit.html">plot_sep</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span class="r-plt img"><img src="synthetic_data_for_UBA_2014-1.png" alt="" width="700" height="433"></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/pkg/saemix/man/summary-methods.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mkin version used for fitting:    1.1.0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> R version used for fitting:       4.1.2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Date of fit:     Wed Mar  2 13:44:06 2022 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Date of summary: Wed Mar  2 13:44:06 2022 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Equations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d_parent/dt = - k_parent * parent</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d_M1/dt = + f_parent_to_M1 * k_parent * parent - k_M1 * M1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d_M2/dt = + f_M1_to_M2 * k_M1 * M1 - k_M2 * M2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model predictions using solution type deSolve </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted using 833 model solutions performed in 0.756 s</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error model: Constant variance </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error model algorithm: OLS </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting values for parameters to be optimised:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   value   type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> parent_0       101.3500  state</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k_parent         0.1000 deparm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k_M1             0.1001 deparm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k_M2             0.1002 deparm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f_parent_to_M1   0.5000 deparm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f_M1_to_M2       0.5000 deparm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting values for the transformed parameters actually optimised:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      value lower upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> parent_0        101.350000  -Inf   Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_k_parent     -2.302585  -Inf   Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_k_M1         -2.301586  -Inf   Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_k_M2         -2.300587  -Inf   Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f_parent_qlogis   0.000000  -Inf   Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f_M1_qlogis       0.000000  -Inf   Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fixed parameter values:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      value  type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M1_0     0 state</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M2_0     0 state</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        AIC      BIC    logLik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   188.7274 200.3723 -87.36368</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimised, transformed parameters with symmetric confidence intervals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Estimate Std. Error   Lower    Upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> parent_0        102.1000    1.57000 98.8600 105.3000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_k_parent     -0.3020    0.03885 -0.3812  -0.2229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_k_M1         -1.2070    0.07123 -1.3520  -1.0620</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_k_M2         -3.9010    0.06571 -4.0350  -3.7670</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f_parent_qlogis   1.2010    0.23530  0.7216   1.6800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f_M1_qlogis       0.9589    0.24890  0.4520   1.4660</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma             2.2730    0.25740  1.7490   2.7970</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameter correlation:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   parent_0 log_k_parent   log_k_M1   log_k_M2 f_parent_qlogis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> parent_0         1.000e+00    3.933e-01 -1.605e-01  2.819e-02      -4.624e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_k_parent     3.933e-01    1.000e+00 -4.082e-01  7.166e-02      -5.682e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_k_M1        -1.605e-01   -4.082e-01  1.000e+00 -3.929e-01       7.478e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_k_M2         2.819e-02    7.166e-02 -3.929e-01  1.000e+00      -2.658e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f_parent_qlogis -4.624e-01   -5.682e-01  7.478e-01 -2.658e-01       1.000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f_M1_qlogis      1.614e-01    4.102e-01 -8.109e-01  5.419e-01      -8.605e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma           -2.900e-08   -8.030e-09 -2.741e-08  3.938e-08      -2.681e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 f_M1_qlogis      sigma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> parent_0          1.614e-01 -2.900e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_k_parent      4.102e-01 -8.030e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_k_M1         -8.109e-01 -2.741e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log_k_M2          5.419e-01  3.938e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f_parent_qlogis  -8.605e-01 -2.681e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f_M1_qlogis       1.000e+00  4.971e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma             4.971e-08  1.000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Backtransformed parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence intervals for internally transformed parameters are asymmetric.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t-test (unrealistically) based on the assumption of normal distribution</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> for estimators of untransformed parameters.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Estimate t value    Pr(&gt;t)    Lower     Upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> parent_0       102.10000  65.000 7.281e-36 98.86000 105.30000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k_parent         0.73930  25.740 2.948e-23  0.68310   0.80020</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k_M1             0.29920  14.040 1.577e-15  0.25880   0.34590</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> k_M2             0.02023  15.220 1.653e-16  0.01769   0.02312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f_parent_to_M1   0.76870  18.370 7.295e-19  0.67300   0.84290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f_M1_to_M2       0.72290  14.500 6.418e-16  0.61110   0.81240</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sigma            2.27300   8.832 2.161e-10  1.74900   2.79700</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FOCUS Chi2 error levels in percent:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          err.min n.optim df</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All data   8.454       6 17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> parent     8.660       2  6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M1        10.583       2  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M2         3.586       2  6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Resulting formation fractions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 ff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> parent_M1   0.7687</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> parent_sink 0.2313</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M1_M2       0.7229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M1_sink     0.2771</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated disappearance times:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           DT50    DT90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> parent  0.9376   3.114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M1      2.3170   7.697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M2     34.2689 113.839</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  time variable observed  predicted residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0   parent    101.5  1.021e+02 -0.56248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0   parent    101.2  1.021e+02 -0.86248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1   parent     53.9  4.873e+01  5.17118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1   parent     47.5  4.873e+01 -1.22882</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3   parent     10.4  1.111e+01 -0.70773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3   parent      7.6  1.111e+01 -3.50773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     7   parent      1.1  5.772e-01  0.52283</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     7   parent      0.3  5.772e-01 -0.27717</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    14   parent      3.5  3.264e-03  3.49674</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    28   parent      3.2  1.045e-07  3.20000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    90   parent      0.6  9.530e-10  0.60000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   120   parent      3.5 -5.940e-10  3.50000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1       M1     36.4  3.479e+01  1.61088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1       M1     37.4  3.479e+01  2.61088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3       M1     34.3  3.937e+01 -5.07027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3       M1     39.8  3.937e+01  0.42973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     7       M1     15.1  1.549e+01 -0.38715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     7       M1     17.8  1.549e+01  2.31285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    14       M1      5.8  1.995e+00  3.80469</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    14       M1      1.2  1.995e+00 -0.79531</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    60       M1      0.5  2.111e-06  0.50000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    90       M1      3.2 -9.670e-10  3.20000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   120       M1      1.5  7.670e-10  1.50000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   120       M1      0.6  7.670e-10  0.60000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1       M2      4.8  4.455e+00  0.34517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3       M2     20.9  2.153e+01 -0.62527</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3       M2     19.3  2.153e+01 -2.22527</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     7       M2     42.0  4.192e+01  0.07941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     7       M2     43.1  4.192e+01  1.17941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    14       M2     49.4  4.557e+01  3.83353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    14       M2     44.3  4.557e+01 -1.26647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    28       M2     34.6  3.547e+01 -0.87275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    28       M2     33.0  3.547e+01 -2.47275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    60       M2     18.8  1.858e+01  0.21837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    60       M2     17.6  1.858e+01 -0.98163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    90       M2     10.6  1.013e+01  0.47130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    90       M2     10.8  1.013e+01  0.67130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   120       M2      9.8  5.521e+00  4.27893</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   120       M2      3.3  5.521e+00 -2.22107</span>
<span class="r-in"><span class="co"># }</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Johannes Ranke.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

